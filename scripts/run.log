nohup: ignoring input
[2024-10-20 14:41:53,333] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.2
[93m [WARNING] [0m using untested triton version (2.2.0), only 1.0.0 is known to be compatible
[2024-10-20 14:42:09,424] [WARNING] [runner.py:202:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2024-10-20 14:42:09,424] [INFO] [runner.py:568:main] cmd = /home/lixz23/miniconda3/envs/ragsft/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgMywgNCwgNSwgNiwgN119 --master_addr=127.0.0.1 --master_port=2346 --enable_each_rank_log=None /home/lixz23/ragsft/RAG-DDR/src/generator/train.py --model_name_or_path /home/lixz23/pretrain-model/Llama3-8b-instruct --train_data_path /home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/train.jsonl --eval_data_path /home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/dev.jsonl --max_length 2000 --max_prompt_length 1900 --output_dir /home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check --save_steps 100 --eval_steps 100 --per_device_train_batch_size 1 --per_device_eval_batch_size 2 --learning_rate 5e-5 --evaluation_strategy steps --logging_strategy steps --logging_steps 10 --logging_dir /home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/log --bf16 True --use_lora True --num_train_epochs 1 --top_n 5 --llama_style True --deepspeed /home/lixz23/ragsft/RAG-DDR/scripts/ds_config_zero2.json
[2024-10-20 14:42:13,116] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.2
[93m [WARNING] [0m using untested triton version (2.2.0), only 1.0.0 is known to be compatible
[2024-10-20 14:42:14,709] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]}
[2024-10-20 14:42:14,709] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=8, node_rank=0
[2024-10-20 14:42:14,709] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]})
[2024-10-20 14:42:14,709] [INFO] [launch.py:164:main] dist_world_size=8
[2024-10-20 14:42:14,709] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7
[2024-10-20 14:42:14,710] [INFO] [launch.py:256:main] process 2050901 spawned with command: ['/home/lixz23/miniconda3/envs/ragsft/bin/python', '-u', '/home/lixz23/ragsft/RAG-DDR/src/generator/train.py', '--local_rank=0', '--model_name_or_path', '/home/lixz23/pretrain-model/Llama3-8b-instruct', '--train_data_path', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/train.jsonl', '--eval_data_path', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/dev.jsonl', '--max_length', '2000', '--max_prompt_length', '1900', '--output_dir', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check', '--save_steps', '100', '--eval_steps', '100', '--per_device_train_batch_size', '1', '--per_device_eval_batch_size', '2', '--learning_rate', '5e-5', '--evaluation_strategy', 'steps', '--logging_strategy', 'steps', '--logging_steps', '10', '--logging_dir', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/log', '--bf16', 'True', '--use_lora', 'True', '--num_train_epochs', '1', '--top_n', '5', '--llama_style', 'True', '--deepspeed', '/home/lixz23/ragsft/RAG-DDR/scripts/ds_config_zero2.json']
[2024-10-20 14:42:14,712] [INFO] [launch.py:256:main] process 2050902 spawned with command: ['/home/lixz23/miniconda3/envs/ragsft/bin/python', '-u', '/home/lixz23/ragsft/RAG-DDR/src/generator/train.py', '--local_rank=1', '--model_name_or_path', '/home/lixz23/pretrain-model/Llama3-8b-instruct', '--train_data_path', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/train.jsonl', '--eval_data_path', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/dev.jsonl', '--max_length', '2000', '--max_prompt_length', '1900', '--output_dir', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check', '--save_steps', '100', '--eval_steps', '100', '--per_device_train_batch_size', '1', '--per_device_eval_batch_size', '2', '--learning_rate', '5e-5', '--evaluation_strategy', 'steps', '--logging_strategy', 'steps', '--logging_steps', '10', '--logging_dir', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/log', '--bf16', 'True', '--use_lora', 'True', '--num_train_epochs', '1', '--top_n', '5', '--llama_style', 'True', '--deepspeed', '/home/lixz23/ragsft/RAG-DDR/scripts/ds_config_zero2.json']
[2024-10-20 14:42:14,719] [INFO] [launch.py:256:main] process 2050903 spawned with command: ['/home/lixz23/miniconda3/envs/ragsft/bin/python', '-u', '/home/lixz23/ragsft/RAG-DDR/src/generator/train.py', '--local_rank=2', '--model_name_or_path', '/home/lixz23/pretrain-model/Llama3-8b-instruct', '--train_data_path', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/train.jsonl', '--eval_data_path', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/dev.jsonl', '--max_length', '2000', '--max_prompt_length', '1900', '--output_dir', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check', '--save_steps', '100', '--eval_steps', '100', '--per_device_train_batch_size', '1', '--per_device_eval_batch_size', '2', '--learning_rate', '5e-5', '--evaluation_strategy', 'steps', '--logging_strategy', 'steps', '--logging_steps', '10', '--logging_dir', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/log', '--bf16', 'True', '--use_lora', 'True', '--num_train_epochs', '1', '--top_n', '5', '--llama_style', 'True', '--deepspeed', '/home/lixz23/ragsft/RAG-DDR/scripts/ds_config_zero2.json']
[2024-10-20 14:42:14,723] [INFO] [launch.py:256:main] process 2050904 spawned with command: ['/home/lixz23/miniconda3/envs/ragsft/bin/python', '-u', '/home/lixz23/ragsft/RAG-DDR/src/generator/train.py', '--local_rank=3', '--model_name_or_path', '/home/lixz23/pretrain-model/Llama3-8b-instruct', '--train_data_path', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/train.jsonl', '--eval_data_path', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/dev.jsonl', '--max_length', '2000', '--max_prompt_length', '1900', '--output_dir', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check', '--save_steps', '100', '--eval_steps', '100', '--per_device_train_batch_size', '1', '--per_device_eval_batch_size', '2', '--learning_rate', '5e-5', '--evaluation_strategy', 'steps', '--logging_strategy', 'steps', '--logging_steps', '10', '--logging_dir', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/log', '--bf16', 'True', '--use_lora', 'True', '--num_train_epochs', '1', '--top_n', '5', '--llama_style', 'True', '--deepspeed', '/home/lixz23/ragsft/RAG-DDR/scripts/ds_config_zero2.json']
[2024-10-20 14:42:14,724] [INFO] [launch.py:256:main] process 2050905 spawned with command: ['/home/lixz23/miniconda3/envs/ragsft/bin/python', '-u', '/home/lixz23/ragsft/RAG-DDR/src/generator/train.py', '--local_rank=4', '--model_name_or_path', '/home/lixz23/pretrain-model/Llama3-8b-instruct', '--train_data_path', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/train.jsonl', '--eval_data_path', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/dev.jsonl', '--max_length', '2000', '--max_prompt_length', '1900', '--output_dir', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check', '--save_steps', '100', '--eval_steps', '100', '--per_device_train_batch_size', '1', '--per_device_eval_batch_size', '2', '--learning_rate', '5e-5', '--evaluation_strategy', 'steps', '--logging_strategy', 'steps', '--logging_steps', '10', '--logging_dir', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/log', '--bf16', 'True', '--use_lora', 'True', '--num_train_epochs', '1', '--top_n', '5', '--llama_style', 'True', '--deepspeed', '/home/lixz23/ragsft/RAG-DDR/scripts/ds_config_zero2.json']
[2024-10-20 14:42:14,733] [INFO] [launch.py:256:main] process 2050906 spawned with command: ['/home/lixz23/miniconda3/envs/ragsft/bin/python', '-u', '/home/lixz23/ragsft/RAG-DDR/src/generator/train.py', '--local_rank=5', '--model_name_or_path', '/home/lixz23/pretrain-model/Llama3-8b-instruct', '--train_data_path', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/train.jsonl', '--eval_data_path', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/dev.jsonl', '--max_length', '2000', '--max_prompt_length', '1900', '--output_dir', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check', '--save_steps', '100', '--eval_steps', '100', '--per_device_train_batch_size', '1', '--per_device_eval_batch_size', '2', '--learning_rate', '5e-5', '--evaluation_strategy', 'steps', '--logging_strategy', 'steps', '--logging_steps', '10', '--logging_dir', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/log', '--bf16', 'True', '--use_lora', 'True', '--num_train_epochs', '1', '--top_n', '5', '--llama_style', 'True', '--deepspeed', '/home/lixz23/ragsft/RAG-DDR/scripts/ds_config_zero2.json']
[2024-10-20 14:42:14,742] [INFO] [launch.py:256:main] process 2050907 spawned with command: ['/home/lixz23/miniconda3/envs/ragsft/bin/python', '-u', '/home/lixz23/ragsft/RAG-DDR/src/generator/train.py', '--local_rank=6', '--model_name_or_path', '/home/lixz23/pretrain-model/Llama3-8b-instruct', '--train_data_path', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/train.jsonl', '--eval_data_path', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/dev.jsonl', '--max_length', '2000', '--max_prompt_length', '1900', '--output_dir', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check', '--save_steps', '100', '--eval_steps', '100', '--per_device_train_batch_size', '1', '--per_device_eval_batch_size', '2', '--learning_rate', '5e-5', '--evaluation_strategy', 'steps', '--logging_strategy', 'steps', '--logging_steps', '10', '--logging_dir', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/log', '--bf16', 'True', '--use_lora', 'True', '--num_train_epochs', '1', '--top_n', '5', '--llama_style', 'True', '--deepspeed', '/home/lixz23/ragsft/RAG-DDR/scripts/ds_config_zero2.json']
[2024-10-20 14:42:14,752] [INFO] [launch.py:256:main] process 2050908 spawned with command: ['/home/lixz23/miniconda3/envs/ragsft/bin/python', '-u', '/home/lixz23/ragsft/RAG-DDR/src/generator/train.py', '--local_rank=7', '--model_name_or_path', '/home/lixz23/pretrain-model/Llama3-8b-instruct', '--train_data_path', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/train.jsonl', '--eval_data_path', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/dev.jsonl', '--max_length', '2000', '--max_prompt_length', '1900', '--output_dir', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check', '--save_steps', '100', '--eval_steps', '100', '--per_device_train_batch_size', '1', '--per_device_eval_batch_size', '2', '--learning_rate', '5e-5', '--evaluation_strategy', 'steps', '--logging_strategy', 'steps', '--logging_steps', '10', '--logging_dir', '/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/log', '--bf16', 'True', '--use_lora', 'True', '--num_train_epochs', '1', '--top_n', '5', '--llama_style', 'True', '--deepspeed', '/home/lixz23/ragsft/RAG-DDR/scripts/ds_config_zero2.json']
[2024-10-20 14:43:08,187] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-10-20 14:43:08,350] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-10-20 14:43:08,416] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[2024-10-20 14:43:08,610] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-10-20 14:43:08,645] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-10-20 14:43:08,666] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[2024-10-20 14:43:08,691] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-10-20 14:43:08,704] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.2
[93m [WARNING] [0m using untested triton version (2.2.0), only 1.0.0 is known to be compatible
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.2
[93m [WARNING] [0m using untested triton version (2.2.0), only 1.0.0 is known to be compatible
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.2
[93m [WARNING] [0m using untested triton version (2.2.0), only 1.0.0 is known to be compatible
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.2
[93m [WARNING] [0m using untested triton version (2.2.0), only 1.0.0 is known to be compatible
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.2
[93m [WARNING] [0m using untested triton version (2.2.0), only 1.0.0 is known to be compatible
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.2
[93m [WARNING] [0m using untested triton version (2.2.0), only 1.0.0 is known to be compatible
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.2
[93m [WARNING] [0m using untested triton version (2.2.0), only 1.0.0 is known to be compatible
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.2
[93m [WARNING] [0m using untested triton version (2.2.0), only 1.0.0 is known to be compatible
[2024-10-20 14:43:11,792] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-10-20 14:43:11,792] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-10-20 14:43:12,144] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-10-20 14:43:12,446] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-10-20 14:43:12,534] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-10-20 14:43:12,558] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-10-20 14:43:12,561] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-10-20 14:43:12,704] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-10-20 14:43:12,715] [INFO] [comm.py:637:init_distributed] cdb=None
10/20/2024 14:43:13 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(
_n_gpu=1,
accelerator_config={'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'gradient_accumulation_kwargs': None},
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
bf16=True,
bf16_full_eval=False,
cache_dir=None,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_persistent_workers=False,
dataloader_pin_memory=True,
dataloader_prefetch_factor=None,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=/home/lixz23/ragsft/RAG-DDR/scripts/ds_config_zero2.json,
disable_tqdm=False,
dispatch_batches=None,
do_eval=True,
do_predict=False,
do_train=False,
eval_accumulation_steps=None,
eval_delay=0,
eval_do_concat_batches=True,
eval_steps=100,
evaluation_strategy=steps,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
include_num_input_tokens_seen=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=0,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/log,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=10,
logging_strategy=steps,
lr_scheduler_kwargs={},
lr_scheduler_type=linear,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_train_epochs=1.0,
optim=adamw_torch,
optim_args=None,
optim_target_modules=None,
output_dir=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check,
overwrite_output_dir=False,
past_index=-1,
per_device_eval_batch_size=2,
per_device_train_batch_size=1,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=['tensorboard'],
resume_from_checkpoint=None,
run_name=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check,
save_on_each_node=False,
save_only_model=False,
save_safetensors=True,
save_steps=100,
save_strategy=steps,
save_total_limit=None,
seed=42,
skip_memory_metrics=True,
split_batches=None,
tf32=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_lora=True,
use_mps_device=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)
10/20/2024 14:43:13 - INFO - __main__ -   MODEL parameters ModelArguments(model_name_or_path='/home/lixz23/pretrain-model/Llama3-8b-instruct', llama_style=True, use_template=True)
10/20/2024 14:43:13 - INFO - __main__ -   DATA parameters DataArguments(train_data_path='/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/train.jsonl', eval_data_path='/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/dev.jsonl', max_length=2000, max_prompt_length=1900, top_n=5)
10/20/2024 14:43:13 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(
_n_gpu=1,
accelerator_config={'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'gradient_accumulation_kwargs': None},
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
bf16=True,
bf16_full_eval=False,
cache_dir=None,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_persistent_workers=False,
dataloader_pin_memory=True,
dataloader_prefetch_factor=None,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=/home/lixz23/ragsft/RAG-DDR/scripts/ds_config_zero2.json,
disable_tqdm=False,
dispatch_batches=None,
do_eval=True,
do_predict=False,
do_train=False,
eval_accumulation_steps=None,
eval_delay=0,
eval_do_concat_batches=True,
eval_steps=100,
evaluation_strategy=steps,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
include_num_input_tokens_seen=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=7,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/log,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=10,
logging_strategy=steps,
lr_scheduler_kwargs={},
lr_scheduler_type=linear,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_train_epochs=1.0,
optim=adamw_torch,
optim_args=None,
optim_target_modules=None,
output_dir=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check,
overwrite_output_dir=False,
past_index=-1,
per_device_eval_batch_size=2,
per_device_train_batch_size=1,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=['tensorboard'],
resume_from_checkpoint=None,
run_name=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check,
save_on_each_node=False,
save_only_model=False,
save_safetensors=True,
save_steps=100,
save_strategy=steps,
save_total_limit=None,
seed=42,
skip_memory_metrics=True,
split_batches=None,
tf32=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_lora=True,
use_mps_device=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)
10/20/2024 14:43:13 - INFO - __main__ -   MODEL parameters ModelArguments(model_name_or_path='/home/lixz23/pretrain-model/Llama3-8b-instruct', llama_style=True, use_template=True)
10/20/2024 14:43:13 - INFO - __main__ -   DATA parameters DataArguments(train_data_path='/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/train.jsonl', eval_data_path='/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/dev.jsonl', max_length=2000, max_prompt_length=1900, top_n=5)
10/20/2024 14:43:13 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(
_n_gpu=1,
accelerator_config={'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'gradient_accumulation_kwargs': None},
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
bf16=True,
bf16_full_eval=False,
cache_dir=None,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_persistent_workers=False,
dataloader_pin_memory=True,
dataloader_prefetch_factor=None,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=/home/lixz23/ragsft/RAG-DDR/scripts/ds_config_zero2.json,
disable_tqdm=False,
dispatch_batches=None,
do_eval=True,
do_predict=False,
do_train=False,
eval_accumulation_steps=None,
eval_delay=0,
eval_do_concat_batches=True,
eval_steps=100,
evaluation_strategy=steps,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
include_num_input_tokens_seen=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=5,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/log,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=10,
logging_strategy=steps,
lr_scheduler_kwargs={},
lr_scheduler_type=linear,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_train_epochs=1.0,
optim=adamw_torch,
optim_args=None,
optim_target_modules=None,
output_dir=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check,
overwrite_output_dir=False,
past_index=-1,
per_device_eval_batch_size=2,
per_device_train_batch_size=1,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=['tensorboard'],
resume_from_checkpoint=None,
run_name=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check,
save_on_each_node=False,
save_only_model=False,
save_safetensors=True,
save_steps=100,
save_strategy=steps,
save_total_limit=None,
seed=42,
skip_memory_metrics=True,
split_batches=None,
tf32=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_lora=True,
use_mps_device=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)
10/20/2024 14:43:13 - INFO - __main__ -   MODEL parameters ModelArguments(model_name_or_path='/home/lixz23/pretrain-model/Llama3-8b-instruct', llama_style=True, use_template=True)
10/20/2024 14:43:13 - INFO - __main__ -   DATA parameters DataArguments(train_data_path='/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/train.jsonl', eval_data_path='/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/dev.jsonl', max_length=2000, max_prompt_length=1900, top_n=5)
10/20/2024 14:43:13 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(
_n_gpu=1,
accelerator_config={'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'gradient_accumulation_kwargs': None},
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
bf16=True,
bf16_full_eval=False,
cache_dir=None,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_persistent_workers=False,
dataloader_pin_memory=True,
dataloader_prefetch_factor=None,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=/home/lixz23/ragsft/RAG-DDR/scripts/ds_config_zero2.json,
disable_tqdm=False,
dispatch_batches=None,
do_eval=True,
do_predict=False,
do_train=False,
eval_accumulation_steps=None,
eval_delay=0,
eval_do_concat_batches=True,
eval_steps=100,
evaluation_strategy=steps,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
include_num_input_tokens_seen=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=2,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/log,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=10,
logging_strategy=steps,
lr_scheduler_kwargs={},
lr_scheduler_type=linear,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_train_epochs=1.0,
optim=adamw_torch,
optim_args=None,
optim_target_modules=None,
output_dir=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check,
overwrite_output_dir=False,
past_index=-1,
per_device_eval_batch_size=2,
per_device_train_batch_size=1,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=['tensorboard'],
resume_from_checkpoint=None,
run_name=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check,
save_on_each_node=False,
save_only_model=False,
save_safetensors=True,
save_steps=100,
save_strategy=steps,
save_total_limit=None,
seed=42,
skip_memory_metrics=True,
split_batches=None,
tf32=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_lora=True,
use_mps_device=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)
10/20/2024 14:43:13 - INFO - __main__ -   MODEL parameters ModelArguments(model_name_or_path='/home/lixz23/pretrain-model/Llama3-8b-instruct', llama_style=True, use_template=True)
10/20/2024 14:43:13 - INFO - __main__ -   DATA parameters DataArguments(train_data_path='/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/train.jsonl', eval_data_path='/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/dev.jsonl', max_length=2000, max_prompt_length=1900, top_n=5)
10/20/2024 14:43:13 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(
_n_gpu=1,
accelerator_config={'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'gradient_accumulation_kwargs': None},
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
bf16=True,
bf16_full_eval=False,
cache_dir=None,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_persistent_workers=False,
dataloader_pin_memory=True,
dataloader_prefetch_factor=None,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=/home/lixz23/ragsft/RAG-DDR/scripts/ds_config_zero2.json,
disable_tqdm=False,
dispatch_batches=None,
do_eval=True,
do_predict=False,
do_train=False,
eval_accumulation_steps=None,
eval_delay=0,
eval_do_concat_batches=True,
eval_steps=100,
evaluation_strategy=steps,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
include_num_input_tokens_seen=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=4,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/log,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=10,
logging_strategy=steps,
lr_scheduler_kwargs={},
lr_scheduler_type=linear,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_train_epochs=1.0,
optim=adamw_torch,
optim_args=None,
optim_target_modules=None,
output_dir=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check,
overwrite_output_dir=False,
past_index=-1,
per_device_eval_batch_size=2,
per_device_train_batch_size=1,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=['tensorboard'],
resume_from_checkpoint=None,
run_name=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check,
save_on_each_node=False,
save_only_model=False,
save_safetensors=True,
save_steps=100,
save_strategy=steps,
save_total_limit=None,
seed=42,
skip_memory_metrics=True,
split_batches=None,
tf32=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_lora=True,
use_mps_device=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)
10/20/2024 14:43:13 - INFO - __main__ -   MODEL parameters ModelArguments(model_name_or_path='/home/lixz23/pretrain-model/Llama3-8b-instruct', llama_style=True, use_template=True)
10/20/2024 14:43:13 - INFO - __main__ -   DATA parameters DataArguments(train_data_path='/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/train.jsonl', eval_data_path='/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/dev.jsonl', max_length=2000, max_prompt_length=1900, top_n=5)
10/20/2024 14:43:13 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(
_n_gpu=1,
accelerator_config={'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'gradient_accumulation_kwargs': None},
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
bf16=True,
bf16_full_eval=False,
cache_dir=None,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_persistent_workers=False,
dataloader_pin_memory=True,
dataloader_prefetch_factor=None,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=/home/lixz23/ragsft/RAG-DDR/scripts/ds_config_zero2.json,
disable_tqdm=False,
dispatch_batches=None,
do_eval=True,
do_predict=False,
do_train=False,
eval_accumulation_steps=None,
eval_delay=0,
eval_do_concat_batches=True,
eval_steps=100,
evaluation_strategy=steps,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
include_num_input_tokens_seen=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=3,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/log,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=10,
logging_strategy=steps,
lr_scheduler_kwargs={},
lr_scheduler_type=linear,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_train_epochs=1.0,
optim=adamw_torch,
optim_args=None,
optim_target_modules=None,
output_dir=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check,
overwrite_output_dir=False,
past_index=-1,
per_device_eval_batch_size=2,
per_device_train_batch_size=1,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=['tensorboard'],
resume_from_checkpoint=None,
run_name=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check,
save_on_each_node=False,
save_only_model=False,
save_safetensors=True,
save_steps=100,
save_strategy=steps,
save_total_limit=None,
seed=42,
skip_memory_metrics=True,
split_batches=None,
tf32=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_lora=True,
use_mps_device=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)
10/20/2024 14:43:13 - INFO - __main__ -   MODEL parameters ModelArguments(model_name_or_path='/home/lixz23/pretrain-model/Llama3-8b-instruct', llama_style=True, use_template=True)
10/20/2024 14:43:13 - INFO - __main__ -   DATA parameters DataArguments(train_data_path='/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/train.jsonl', eval_data_path='/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/dev.jsonl', max_length=2000, max_prompt_length=1900, top_n=5)
10/20/2024 14:43:13 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(
_n_gpu=1,
accelerator_config={'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'gradient_accumulation_kwargs': None},
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
bf16=True,
bf16_full_eval=False,
cache_dir=None,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_persistent_workers=False,
dataloader_pin_memory=True,
dataloader_prefetch_factor=None,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=/home/lixz23/ragsft/RAG-DDR/scripts/ds_config_zero2.json,
disable_tqdm=False,
dispatch_batches=None,
do_eval=True,
do_predict=False,
do_train=False,
eval_accumulation_steps=None,
eval_delay=0,
eval_do_concat_batches=True,
eval_steps=100,
evaluation_strategy=steps,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
include_num_input_tokens_seen=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=1,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/log,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=10,
logging_strategy=steps,
lr_scheduler_kwargs={},
lr_scheduler_type=linear,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_train_epochs=1.0,
optim=adamw_torch,
optim_args=None,
optim_target_modules=None,
output_dir=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check,
overwrite_output_dir=False,
past_index=-1,
per_device_eval_batch_size=2,
per_device_train_batch_size=1,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=['tensorboard'],
resume_from_checkpoint=None,
run_name=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check,
save_on_each_node=False,
save_only_model=False,
save_safetensors=True,
save_steps=100,
save_strategy=steps,
save_total_limit=None,
seed=42,
skip_memory_metrics=True,
split_batches=None,
tf32=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_lora=True,
use_mps_device=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)
10/20/2024 14:43:13 - INFO - __main__ -   MODEL parameters ModelArguments(model_name_or_path='/home/lixz23/pretrain-model/Llama3-8b-instruct', llama_style=True, use_template=True)
10/20/2024 14:43:13 - INFO - __main__ -   DATA parameters DataArguments(train_data_path='/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/train.jsonl', eval_data_path='/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/dev.jsonl', max_length=2000, max_prompt_length=1900, top_n=5)
10/20/2024 14:43:13 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(
_n_gpu=1,
accelerator_config={'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'gradient_accumulation_kwargs': None},
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
bf16=True,
bf16_full_eval=False,
cache_dir=None,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_persistent_workers=False,
dataloader_pin_memory=True,
dataloader_prefetch_factor=None,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=/home/lixz23/ragsft/RAG-DDR/scripts/ds_config_zero2.json,
disable_tqdm=False,
dispatch_batches=None,
do_eval=True,
do_predict=False,
do_train=False,
eval_accumulation_steps=None,
eval_delay=0,
eval_do_concat_batches=True,
eval_steps=100,
evaluation_strategy=steps,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
include_num_input_tokens_seen=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=6,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/log,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=10,
logging_strategy=steps,
lr_scheduler_kwargs={},
lr_scheduler_type=linear,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_train_epochs=1.0,
optim=adamw_torch,
optim_args=None,
optim_target_modules=None,
output_dir=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check,
overwrite_output_dir=False,
past_index=-1,
per_device_eval_batch_size=2,
per_device_train_batch_size=1,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=['tensorboard'],
resume_from_checkpoint=None,
run_name=/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/check/check,
save_on_each_node=False,
save_only_model=False,
save_safetensors=True,
save_steps=100,
save_strategy=steps,
save_total_limit=None,
seed=42,
skip_memory_metrics=True,
split_batches=None,
tf32=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_lora=True,
use_mps_device=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)
10/20/2024 14:43:13 - INFO - __main__ -   MODEL parameters ModelArguments(model_name_or_path='/home/lixz23/pretrain-model/Llama3-8b-instruct', llama_style=True, use_template=True)
10/20/2024 14:43:13 - INFO - __main__ -   DATA parameters DataArguments(train_data_path='/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/train.jsonl', eval_data_path='/home/lixz23/ragsft/RAG-DDR/data/test_data/train_llama/dev.jsonl', max_length=2000, max_prompt_length=1900, top_n=5)
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [01:01<03:05, 61.84s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [01:02<03:06, 62.14s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [01:01<03:05, 61.82s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [01:01<03:05, 61.97s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [01:01<03:05, 61.92s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [01:01<03:05, 61.82s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [01:02<03:06, 62.17s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [01:01<03:05, 61.86s/it]Loading checkpoint shards:  50%|█████     | 2/4 [02:03<02:03, 61.68s/it]Loading checkpoint shards:  50%|█████     | 2/4 [02:03<02:03, 61.75s/it]Loading checkpoint shards:  50%|█████     | 2/4 [02:03<02:03, 61.74s/it]Loading checkpoint shards:  50%|█████     | 2/4 [02:03<02:03, 61.78s/it]Loading checkpoint shards:  50%|█████     | 2/4 [02:03<02:03, 61.88s/it]Loading checkpoint shards:  50%|█████     | 2/4 [02:03<02:03, 61.79s/it]Loading checkpoint shards:  50%|█████     | 2/4 [02:03<02:03, 61.88s/it]Loading checkpoint shards:  50%|█████     | 2/4 [02:03<02:03, 61.81s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [03:24<01:10, 70.59s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [03:24<01:10, 70.63s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [03:24<01:10, 70.68s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [03:24<01:10, 70.63s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [03:24<01:10, 70.62s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [03:24<01:10, 70.65s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [03:25<01:10, 70.69s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [03:24<01:10, 70.63s/it]Loading checkpoint shards: 100%|██████████| 4/4 [03:31<00:00, 45.29s/it]Loading checkpoint shards: 100%|██████████| 4/4 [03:31<00:00, 52.78s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [03:31<00:00, 45.29s/it]Loading checkpoint shards: 100%|██████████| 4/4 [03:31<00:00, 52.79s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [03:31<00:00, 45.31s/it]Loading checkpoint shards: 100%|██████████| 4/4 [03:31<00:00, 52.82s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [03:31<00:00, 45.33s/it]Loading checkpoint shards: 100%|██████████| 4/4 [03:31<00:00, 52.87s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [03:31<00:00, 45.30s/it]Loading checkpoint shards: 100%|██████████| 4/4 [03:31<00:00, 52.79s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [03:31<00:00, 45.31s/it]Loading checkpoint shards: 100%|██████████| 4/4 [03:31<00:00, 52.81s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [03:31<00:00, 45.31s/it]Loading checkpoint shards: 100%|██████████| 4/4 [03:31<00:00, 52.81s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [03:31<00:00, 45.34s/it]Loading checkpoint shards: 100%|██████████| 4/4 [03:31<00:00, 52.87s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
trainable params: 3,407,872 || all params: 8,033,669,120 || trainable%: 0.04241987003816259
trainable params: 3,407,872 || all params: 8,033,669,120 || trainable%: 0.04241987003816259
trainable params: 3,407,872 || all params: 8,033,669,120 || trainable%: 0.04241987003816259
trainable params: 3,407,872 || all params: 8,033,669,120 || trainable%: 0.04241987003816259
trainable params: 3,407,872 || all params: 8,033,669,120 || trainable%: 0.04241987003816259
trainable params: 3,407,872 || all params: 8,033,669,120 || trainable%: 0.04241987003816259
trainable params: 3,407,872 || all params: 8,033,669,120 || trainable%: 0.04241987003816259
trainable params: 3,407,872 || all params: 8,033,669,120 || trainable%: 0.04241987003816259
/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/trl/trainer/dpo_trainer.py:332: UserWarning: When using DPODataCollatorWithPadding, you should set `remove_unused_columns=False` in your TrainingArguments we have set it for you, but you should do it yourself in the future.
  warnings.warn(
/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/trl/trainer/dpo_trainer.py:332: UserWarning: When using DPODataCollatorWithPadding, you should set `remove_unused_columns=False` in your TrainingArguments we have set it for you, but you should do it yourself in the future.
  warnings.warn(
/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/trl/trainer/dpo_trainer.py:332: UserWarning: When using DPODataCollatorWithPadding, you should set `remove_unused_columns=False` in your TrainingArguments we have set it for you, but you should do it yourself in the future.
  warnings.warn(
/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/trl/trainer/dpo_trainer.py:332: UserWarning: When using DPODataCollatorWithPadding, you should set `remove_unused_columns=False` in your TrainingArguments we have set it for you, but you should do it yourself in the future.
  warnings.warn(
/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/trl/trainer/dpo_trainer.py:332: UserWarning: When using DPODataCollatorWithPadding, you should set `remove_unused_columns=False` in your TrainingArguments we have set it for you, but you should do it yourself in the future.
  warnings.warn(
/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/trl/trainer/dpo_trainer.py:332: UserWarning: When using DPODataCollatorWithPadding, you should set `remove_unused_columns=False` in your TrainingArguments we have set it for you, but you should do it yourself in the future.
  warnings.warn(
/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/trl/trainer/dpo_trainer.py:332: UserWarning: When using DPODataCollatorWithPadding, you should set `remove_unused_columns=False` in your TrainingArguments we have set it for you, but you should do it yourself in the future.
  warnings.warn(
/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/trl/trainer/dpo_trainer.py:332: UserWarning: When using DPODataCollatorWithPadding, you should set `remove_unused_columns=False` in your TrainingArguments we have set it for you, but you should do it yourself in the future.
  warnings.warn(
10/20/2024 14:47:35 - WARNING - accelerate.utils.other -   Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  0%|          | 0/2552 [00:00<?, ?it/s]Could not estimate the number of tokens of the input, floating-point operations will not be computed
Could not estimate the number of tokens of the input, floating-point operations will not be computed
Could not estimate the number of tokens of the input, floating-point operations will not be computed
Could not estimate the number of tokens of the input, floating-point operations will not be computed
Could not estimate the number of tokens of the input, floating-point operations will not be computed
Could not estimate the number of tokens of the input, floating-point operations will not be computed
Could not estimate the number of tokens of the input, floating-point operations will not be computed
Could not estimate the number of tokens of the input, floating-point operations will not be computed
  0%|          | 1/2552 [00:10<7:24:47, 10.46s/it]  0%|          | 2/2552 [00:12<3:52:23,  5.47s/it]  0%|          | 3/2552 [00:14<2:47:19,  3.94s/it]  0%|          | 4/2552 [00:16<2:13:20,  3.14s/it]  0%|          | 5/2552 [00:18<2:00:19,  2.83s/it]  0%|          | 6/2552 [00:20<1:44:47,  2.47s/it]  0%|          | 7/2552 [00:22<1:33:29,  2.20s/it]  0%|          | 8/2552 [00:23<1:25:58,  2.03s/it]  0%|          | 9/2552 [00:25<1:20:49,  1.91s/it]  0%|          | 10/2552 [00:27<1:17:58,  1.84s/it]                                                   {'loss': 0.6845, 'grad_norm': 9.968000411987305, 'learning_rate': 4.980407523510972e-05, 'rewards/chosen': -0.02743091620504856, 'rewards/rejected': -0.043943099677562714, 'rewards/accuracies': 0.4000000059604645, 'rewards/margins': 0.0165121890604496, 'logps/rejected': -40.211326599121094, 'logps/chosen': -31.391864776611328, 'logits/rejected': -0.42496633529663086, 'logits/chosen': -0.4264577031135559, 'epoch': 0.0}
  0%|          | 10/2552 [00:27<1:17:58,  1.84s/it]  0%|          | 11/2552 [00:29<1:18:46,  1.86s/it]  0%|          | 12/2552 [00:30<1:16:28,  1.81s/it]  1%|          | 13/2552 [00:32<1:18:06,  1.85s/it]  1%|          | 14/2552 [00:34<1:16:26,  1.81s/it]  1%|          | 15/2552 [00:36<1:14:02,  1.75s/it]  1%|          | 16/2552 [00:37<1:14:57,  1.77s/it]  1%|          | 17/2552 [00:39<1:14:45,  1.77s/it]  1%|          | 18/2552 [00:41<1:14:25,  1.76s/it]  1%|          | 19/2552 [00:42<1:10:55,  1.68s/it]  1%|          | 20/2552 [00:44<1:07:48,  1.61s/it]                                                   {'loss': 0.6179, 'grad_norm': 5.659595012664795, 'learning_rate': 4.960815047021944e-05, 'rewards/chosen': -0.057963497936725616, 'rewards/rejected': -0.29002663493156433, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.2320631742477417, 'logps/rejected': -58.73326873779297, 'logps/chosen': -61.40769577026367, 'logits/rejected': -0.44907045364379883, 'logits/chosen': -0.44863662123680115, 'epoch': 0.01}
  1%|          | 20/2552 [00:44<1:07:48,  1.61s/it]  1%|          | 21/2552 [00:45<1:08:06,  1.61s/it]  1%|          | 22/2552 [00:47<1:07:48,  1.61s/it]  1%|          | 23/2552 [00:48<1:04:07,  1.52s/it]  1%|          | 24/2552 [00:50<1:02:15,  1.48s/it]  1%|          | 25/2552 [00:51<1:04:14,  1.53s/it]  1%|          | 26/2552 [00:53<1:01:42,  1.47s/it]  1%|          | 27/2552 [00:54<1:02:06,  1.48s/it]  1%|          | 28/2552 [00:56<1:04:12,  1.53s/it]  1%|          | 29/2552 [00:57<1:04:50,  1.54s/it]  1%|          | 30/2552 [00:59<1:07:32,  1.61s/it]                                                   {'loss': 0.561, 'grad_norm': 6.94508171081543, 'learning_rate': 4.9412225705329156e-05, 'rewards/chosen': 0.04170149192214012, 'rewards/rejected': -0.6443837881088257, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 0.6860853433609009, 'logps/rejected': -54.545188903808594, 'logps/chosen': -21.254350662231445, 'logits/rejected': -0.5058687925338745, 'logits/chosen': -0.47684550285339355, 'epoch': 0.01}
  1%|          | 30/2552 [00:59<1:07:32,  1.61s/it]  1%|          | 31/2552 [01:01<1:07:16,  1.60s/it]  1%|▏         | 32/2552 [01:02<1:07:53,  1.62s/it]  1%|▏         | 33/2552 [01:04<1:07:15,  1.60s/it]  1%|▏         | 34/2552 [01:06<1:07:54,  1.62s/it]  1%|▏         | 35/2552 [01:07<1:09:56,  1.67s/it]  1%|▏         | 36/2552 [01:10<1:16:09,  1.82s/it]  1%|▏         | 37/2552 [01:12<1:18:51,  1.88s/it]  1%|▏         | 38/2552 [01:13<1:16:27,  1.82s/it]  2%|▏         | 39/2552 [01:15<1:13:08,  1.75s/it]  2%|▏         | 40/2552 [01:17<1:13:44,  1.76s/it]                                                   {'loss': 0.7257, 'grad_norm': 10.897540092468262, 'learning_rate': 4.9216300940438874e-05, 'rewards/chosen': 0.09157278388738632, 'rewards/rejected': -0.7274305820465088, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 0.8190032839775085, 'logps/rejected': -60.233116149902344, 'logps/chosen': -36.5688362121582, 'logits/rejected': -0.6039948463439941, 'logits/chosen': -0.5838920474052429, 'epoch': 0.02}
  2%|▏         | 40/2552 [01:17<1:13:44,  1.76s/it]  2%|▏         | 41/2552 [01:18<1:12:17,  1.73s/it]  2%|▏         | 42/2552 [01:20<1:11:24,  1.71s/it]  2%|▏         | 43/2552 [01:22<1:14:51,  1.79s/it]  2%|▏         | 44/2552 [01:24<1:13:45,  1.76s/it]  2%|▏         | 45/2552 [01:25<1:11:55,  1.72s/it]  2%|▏         | 46/2552 [01:27<1:17:35,  1.86s/it]  2%|▏         | 47/2552 [01:29<1:18:34,  1.88s/it]  2%|▏         | 48/2552 [01:31<1:14:55,  1.80s/it]  2%|▏         | 49/2552 [01:32<1:11:17,  1.71s/it]  2%|▏         | 50/2552 [01:34<1:10:19,  1.69s/it]                                                   {'loss': 0.8094, 'grad_norm': 8.71071720123291, 'learning_rate': 4.902037617554859e-05, 'rewards/chosen': -0.524579644203186, 'rewards/rejected': -0.8550891876220703, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.3305094838142395, 'logps/rejected': -60.4315071105957, 'logps/chosen': -55.75371170043945, 'logits/rejected': -0.43667155504226685, 'logits/chosen': -0.41614192724227905, 'epoch': 0.02}
  2%|▏         | 50/2552 [01:34<1:10:19,  1.69s/it]  2%|▏         | 51/2552 [01:36<1:11:11,  1.71s/it]  2%|▏         | 52/2552 [01:38<1:11:24,  1.71s/it]  2%|▏         | 53/2552 [01:39<1:12:28,  1.74s/it]  2%|▏         | 54/2552 [01:41<1:15:55,  1.82s/it]  2%|▏         | 55/2552 [01:43<1:12:01,  1.73s/it]  2%|▏         | 56/2552 [01:45<1:15:10,  1.81s/it]  2%|▏         | 57/2552 [01:47<1:24:13,  2.03s/it]  2%|▏         | 58/2552 [01:49<1:24:27,  2.03s/it]  2%|▏         | 59/2552 [01:51<1:23:27,  2.01s/it]  2%|▏         | 60/2552 [01:53<1:17:05,  1.86s/it]                                                   {'loss': 0.6427, 'grad_norm': 7.880488395690918, 'learning_rate': 4.882445141065831e-05, 'rewards/chosen': -0.08545398712158203, 'rewards/rejected': -0.030990179628133774, 'rewards/accuracies': 0.5, 'rewards/margins': -0.054463792592287064, 'logps/rejected': -22.754304885864258, 'logps/chosen': -23.315471649169922, 'logits/rejected': -0.4027787744998932, 'logits/chosen': -0.39002200961112976, 'epoch': 0.02}
  2%|▏         | 60/2552 [01:53<1:17:05,  1.86s/it]  2%|▏         | 61/2552 [01:55<1:15:52,  1.83s/it]  2%|▏         | 62/2552 [01:56<1:11:04,  1.71s/it]  2%|▏         | 63/2552 [01:58<1:07:13,  1.62s/it]  3%|▎         | 64/2552 [01:59<1:10:20,  1.70s/it]  3%|▎         | 65/2552 [02:02<1:21:02,  1.95s/it]  3%|▎         | 66/2552 [02:04<1:16:17,  1.84s/it]  3%|▎         | 67/2552 [02:05<1:13:51,  1.78s/it]  3%|▎         | 68/2552 [02:07<1:12:18,  1.75s/it]  3%|▎         | 69/2552 [02:09<1:10:57,  1.71s/it]  3%|▎         | 70/2552 [02:10<1:11:15,  1.72s/it]                                                   {'loss': 0.6952, 'grad_norm': 3.601088047027588, 'learning_rate': 4.862852664576803e-05, 'rewards/chosen': -0.09211736917495728, 'rewards/rejected': -0.3523842692375183, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.26026687026023865, 'logps/rejected': -53.57952880859375, 'logps/chosen': -47.56477737426758, 'logits/rejected': -0.4266718327999115, 'logits/chosen': -0.41411876678466797, 'epoch': 0.03}
  3%|▎         | 70/2552 [02:10<1:11:15,  1.72s/it]  3%|▎         | 71/2552 [02:12<1:12:08,  1.74s/it]  3%|▎         | 72/2552 [02:14<1:09:52,  1.69s/it]  3%|▎         | 73/2552 [02:16<1:15:23,  1.82s/it]  3%|▎         | 74/2552 [02:17<1:11:07,  1.72s/it]  3%|▎         | 75/2552 [02:19<1:09:09,  1.68s/it]  3%|▎         | 76/2552 [02:20<1:08:10,  1.65s/it]  3%|▎         | 77/2552 [02:22<1:05:19,  1.58s/it]  3%|▎         | 78/2552 [02:23<1:03:59,  1.55s/it]  3%|▎         | 79/2552 [02:25<1:03:49,  1.55s/it]  3%|▎         | 80/2552 [02:27<1:06:13,  1.61s/it]                                                   {'loss': 0.6307, 'grad_norm': 7.2442498207092285, 'learning_rate': 4.8432601880877745e-05, 'rewards/chosen': 0.33744412660598755, 'rewards/rejected': -0.2951025366783142, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.6325467824935913, 'logps/rejected': -63.26176834106445, 'logps/chosen': -50.052574157714844, 'logits/rejected': -0.568816065788269, 'logits/chosen': -0.5560364723205566, 'epoch': 0.03}
  3%|▎         | 80/2552 [02:27<1:06:13,  1.61s/it]  3%|▎         | 81/2552 [02:28<1:06:55,  1.62s/it]  3%|▎         | 82/2552 [02:30<1:06:20,  1.61s/it]  3%|▎         | 83/2552 [02:31<1:06:54,  1.63s/it]  3%|▎         | 84/2552 [02:33<1:06:42,  1.62s/it]  3%|▎         | 85/2552 [02:35<1:05:20,  1.59s/it]  3%|▎         | 86/2552 [02:36<1:08:46,  1.67s/it]  3%|▎         | 87/2552 [02:38<1:11:24,  1.74s/it]  3%|▎         | 88/2552 [02:40<1:09:50,  1.70s/it]  3%|▎         | 89/2552 [02:42<1:09:42,  1.70s/it]  4%|▎         | 90/2552 [02:43<1:07:29,  1.64s/it]                                                   {'loss': 0.541, 'grad_norm': 3.769541025161743, 'learning_rate': 4.823667711598746e-05, 'rewards/chosen': 0.17573514580726624, 'rewards/rejected': -0.44613581895828247, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 0.6218709945678711, 'logps/rejected': -58.38287353515625, 'logps/chosen': -41.66937255859375, 'logits/rejected': -0.6755998730659485, 'logits/chosen': -0.634459376335144, 'epoch': 0.04}
  4%|▎         | 90/2552 [02:43<1:07:29,  1.64s/it]  4%|▎         | 91/2552 [02:45<1:05:35,  1.60s/it]  4%|▎         | 92/2552 [02:46<1:05:17,  1.59s/it]  4%|▎         | 93/2552 [02:48<1:01:49,  1.51s/it]  4%|▎         | 94/2552 [02:49<1:04:07,  1.57s/it]  4%|▎         | 95/2552 [02:51<1:07:25,  1.65s/it]  4%|▍         | 96/2552 [02:53<1:08:40,  1.68s/it]  4%|▍         | 97/2552 [02:54<1:06:33,  1.63s/it]  4%|▍         | 98/2552 [02:56<1:04:50,  1.59s/it]  4%|▍         | 99/2552 [02:57<1:03:05,  1.54s/it]  4%|▍         | 100/2552 [02:59<1:03:10,  1.55s/it]                                                    {'loss': 0.6455, 'grad_norm': 4.523331165313721, 'learning_rate': 4.804075235109718e-05, 'rewards/chosen': 0.18265125155448914, 'rewards/rejected': -0.8988698720932007, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.0815211534500122, 'logps/rejected': -30.566171646118164, 'logps/chosen': -14.927200317382812, 'logits/rejected': -0.4489913880825043, 'logits/chosen': -0.43530282378196716, 'epoch': 0.04}
  4%|▍         | 100/2552 [02:59<1:03:10,  1.55s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:03<01:55,  1.54s/it][A
  4%|▍         | 3/77 [00:04<01:56,  1.57s/it][A
  5%|▌         | 4/77 [00:06<01:48,  1.49s/it][A
  6%|▋         | 5/77 [00:09<02:26,  2.03s/it][A
  8%|▊         | 6/77 [00:10<02:05,  1.77s/it][A
  9%|▉         | 7/77 [00:12<02:11,  1.88s/it][A
 10%|█         | 8/77 [00:14<02:11,  1.91s/it][A
 12%|█▏        | 9/77 [00:16<02:09,  1.91s/it][A
 13%|█▎        | 10/77 [00:17<01:49,  1.64s/it][A
 14%|█▍        | 11/77 [00:18<01:40,  1.53s/it][A
 16%|█▌        | 12/77 [00:20<01:52,  1.74s/it][A
 17%|█▋        | 13/77 [00:21<01:39,  1.56s/it][A
 18%|█▊        | 14/77 [00:23<01:33,  1.48s/it][A
 19%|█▉        | 15/77 [00:24<01:35,  1.54s/it][A
 21%|██        | 16/77 [00:25<01:22,  1.36s/it][A
 22%|██▏       | 17/77 [00:27<01:24,  1.42s/it][A
 23%|██▎       | 18/77 [00:28<01:22,  1.40s/it][A
 25%|██▍       | 19/77 [00:30<01:31,  1.58s/it][A
 26%|██▌       | 20/77 [00:31<01:17,  1.36s/it][A
 27%|██▋       | 21/77 [00:32<01:10,  1.25s/it][A
 29%|██▊       | 22/77 [00:34<01:14,  1.36s/it][A
 30%|██▉       | 23/77 [00:36<01:23,  1.54s/it][A
 31%|███       | 24/77 [00:37<01:20,  1.51s/it][A
 32%|███▏      | 25/77 [00:39<01:17,  1.49s/it][A
 34%|███▍      | 26/77 [00:40<01:09,  1.36s/it][A
 35%|███▌      | 27/77 [00:41<01:11,  1.42s/it][A
 36%|███▋      | 28/77 [00:42<01:05,  1.34s/it][A
 38%|███▊      | 29/77 [00:44<01:11,  1.49s/it][A
 39%|███▉      | 30/77 [00:46<01:16,  1.62s/it][A
 40%|████      | 31/77 [00:49<01:34,  2.05s/it][A
 42%|████▏     | 32/77 [00:51<01:30,  2.02s/it][A
 43%|████▎     | 33/77 [00:53<01:23,  1.90s/it][A
 44%|████▍     | 34/77 [00:55<01:19,  1.86s/it][A
 45%|████▌     | 35/77 [00:56<01:14,  1.78s/it][A
 47%|████▋     | 36/77 [00:58<01:11,  1.75s/it][A
 48%|████▊     | 37/77 [00:59<01:02,  1.56s/it][A
 49%|████▉     | 38/77 [01:00<00:59,  1.52s/it][A
 51%|█████     | 39/77 [01:02<01:02,  1.63s/it][A
 52%|█████▏    | 40/77 [01:04<01:00,  1.64s/it][A
 53%|█████▎    | 41/77 [01:05<00:54,  1.52s/it][A
 55%|█████▍    | 42/77 [01:07<00:51,  1.48s/it][A
 56%|█████▌    | 43/77 [01:09<00:55,  1.63s/it][A
 57%|█████▋    | 44/77 [01:10<00:48,  1.46s/it][A
 58%|█████▊    | 45/77 [01:11<00:41,  1.31s/it][A
 60%|█████▉    | 46/77 [01:12<00:41,  1.34s/it][A
 61%|██████    | 47/77 [01:13<00:39,  1.32s/it][A
 62%|██████▏   | 48/77 [01:15<00:41,  1.42s/it][A
 64%|██████▎   | 49/77 [01:17<00:41,  1.50s/it][A
 65%|██████▍   | 50/77 [01:18<00:40,  1.50s/it][A
 66%|██████▌   | 51/77 [01:20<00:42,  1.64s/it][A
 68%|██████▊   | 52/77 [01:22<00:40,  1.61s/it][A
 69%|██████▉   | 53/77 [01:24<00:41,  1.74s/it][A
 70%|███████   | 54/77 [01:25<00:37,  1.65s/it][A
 71%|███████▏  | 55/77 [01:27<00:35,  1.64s/it][A
 73%|███████▎  | 56/77 [01:29<00:39,  1.90s/it][A
 74%|███████▍  | 57/77 [01:31<00:34,  1.74s/it][A
 75%|███████▌  | 58/77 [01:32<00:34,  1.80s/it][A
 77%|███████▋  | 59/77 [01:34<00:31,  1.74s/it][A
 78%|███████▊  | 60/77 [01:35<00:26,  1.58s/it][A
 79%|███████▉  | 61/77 [01:37<00:25,  1.62s/it][A
 81%|████████  | 62/77 [01:38<00:23,  1.55s/it][A
 82%|████████▏ | 63/77 [01:40<00:23,  1.65s/it][A
 83%|████████▎ | 64/77 [01:41<00:19,  1.51s/it][A
 84%|████████▍ | 65/77 [01:43<00:17,  1.48s/it][A
 86%|████████▌ | 66/77 [01:45<00:17,  1.61s/it][A
 87%|████████▋ | 67/77 [01:45<00:13,  1.34s/it][A
 88%|████████▊ | 68/77 [01:48<00:13,  1.54s/it][A
 90%|████████▉ | 69/77 [01:49<00:11,  1.48s/it][A
 91%|█████████ | 70/77 [01:50<00:09,  1.43s/it][A
 92%|█████████▏| 71/77 [01:51<00:08,  1.38s/it][A
 94%|█████████▎| 72/77 [01:53<00:07,  1.42s/it][A
 95%|█████████▍| 73/77 [01:55<00:05,  1.50s/it][A
 96%|█████████▌| 74/77 [01:57<00:04,  1.64s/it][A
 97%|█████████▋| 75/77 [01:58<00:03,  1.64s/it][A
 99%|█████████▊| 76/77 [02:00<00:01,  1.55s/it][A
100%|██████████| 77/77 [02:01<00:00,  1.57s/it][A                                                    
                                               [A{'eval_loss': 0.6305131912231445, 'eval_runtime': 123.8196, 'eval_samples_per_second': 9.869, 'eval_steps_per_second': 0.622, 'eval_rewards/chosen': -0.08304330706596375, 'eval_rewards/rejected': -0.46457216143608093, 'eval_rewards/accuracies': 0.6558441519737244, 'eval_rewards/margins': 0.3815288543701172, 'eval_logps/rejected': -43.89886474609375, 'eval_logps/chosen': -39.339290618896484, 'eval_logits/rejected': -0.4194541573524475, 'eval_logits/chosen': -0.4186020791530609, 'epoch': 0.04}
  4%|▍         | 100/2552 [05:03<1:03:10,  1.55s/it]
100%|██████████| 77/77 [02:02<00:00,  1.57s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
  4%|▍         | 101/2552 [05:33<32:07:48, 47.19s/it]  4%|▍         | 102/2552 [05:34<22:50:37, 33.57s/it]  4%|▍         | 103/2552 [05:36<16:19:04, 23.99s/it]  4%|▍         | 104/2552 [05:38<11:46:54, 17.33s/it]  4%|▍         | 105/2552 [05:40<8:36:21, 12.66s/it]   4%|▍         | 106/2552 [05:41<6:20:45,  9.34s/it]  4%|▍         | 107/2552 [05:43<4:46:09,  7.02s/it]  4%|▍         | 108/2552 [05:44<3:40:43,  5.42s/it]  4%|▍         | 109/2552 [05:46<2:57:49,  4.37s/it]  4%|▍         | 110/2552 [05:48<2:30:21,  3.69s/it]                                                    {'loss': 0.5988, 'grad_norm': 12.908050537109375, 'learning_rate': 4.78448275862069e-05, 'rewards/chosen': -0.3415184020996094, 'rewards/rejected': -0.4848216474056244, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.1433033049106598, 'logps/rejected': -51.6080436706543, 'logps/chosen': -41.61977005004883, 'logits/rejected': -0.43864959478378296, 'logits/chosen': -0.42293721437454224, 'epoch': 0.04}
  4%|▍         | 110/2552 [05:49<2:30:21,  3.69s/it]  4%|▍         | 111/2552 [05:51<2:10:32,  3.21s/it]  4%|▍         | 112/2552 [05:52<1:52:34,  2.77s/it]  4%|▍         | 113/2552 [05:54<1:39:22,  2.44s/it]  4%|▍         | 114/2552 [05:56<1:32:04,  2.27s/it]  5%|▍         | 115/2552 [05:57<1:24:42,  2.09s/it]  5%|▍         | 116/2552 [05:59<1:18:27,  1.93s/it]  5%|▍         | 117/2552 [06:00<1:11:11,  1.75s/it]  5%|▍         | 118/2552 [06:02<1:07:50,  1.67s/it]  5%|▍         | 119/2552 [06:04<1:09:28,  1.71s/it]  5%|▍         | 120/2552 [06:05<1:06:55,  1.65s/it]                                                    {'loss': 0.6143, 'grad_norm': 7.749879837036133, 'learning_rate': 4.7648902821316616e-05, 'rewards/chosen': -0.23887129127979279, 'rewards/rejected': -0.4987521171569824, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.25988084077835083, 'logps/rejected': -48.49997329711914, 'logps/chosen': -38.98919677734375, 'logits/rejected': -0.5658878087997437, 'logits/chosen': -0.5532243847846985, 'epoch': 0.05}
  5%|▍         | 120/2552 [06:05<1:06:55,  1.65s/it]  5%|▍         | 121/2552 [06:07<1:05:42,  1.62s/it]  5%|▍         | 122/2552 [06:08<1:04:52,  1.60s/it]  5%|▍         | 123/2552 [06:10<1:03:41,  1.57s/it]  5%|▍         | 124/2552 [06:11<1:04:04,  1.58s/it]  5%|▍         | 125/2552 [06:13<1:07:01,  1.66s/it]  5%|▍         | 126/2552 [06:15<1:05:01,  1.61s/it]  5%|▍         | 127/2552 [06:16<1:05:26,  1.62s/it]  5%|▌         | 128/2552 [06:18<1:07:45,  1.68s/it]  5%|▌         | 129/2552 [06:20<1:06:02,  1.64s/it]  5%|▌         | 130/2552 [06:21<1:05:47,  1.63s/it]                                                    {'loss': 0.5654, 'grad_norm': 9.21461009979248, 'learning_rate': 4.7452978056426334e-05, 'rewards/chosen': -0.030342847108840942, 'rewards/rejected': -0.48349514603614807, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.45315226912498474, 'logps/rejected': -40.91281509399414, 'logps/chosen': -45.31513977050781, 'logits/rejected': -0.6158223152160645, 'logits/chosen': -0.6174295544624329, 'epoch': 0.05}
  5%|▌         | 130/2552 [06:21<1:05:47,  1.63s/it]  5%|▌         | 131/2552 [06:23<1:04:06,  1.59s/it]  5%|▌         | 132/2552 [06:24<1:01:28,  1.52s/it]  5%|▌         | 133/2552 [06:26<1:00:25,  1.50s/it]  5%|▌         | 134/2552 [06:27<1:00:01,  1.49s/it]  5%|▌         | 135/2552 [06:29<59:23,  1.47s/it]    5%|▌         | 136/2552 [06:30<1:03:18,  1.57s/it]  5%|▌         | 137/2552 [06:32<1:06:18,  1.65s/it]  5%|▌         | 138/2552 [06:34<1:03:45,  1.58s/it]  5%|▌         | 139/2552 [06:36<1:07:56,  1.69s/it]  5%|▌         | 140/2552 [06:37<1:06:39,  1.66s/it]                                                    {'loss': 0.5794, 'grad_norm': 6.165186882019043, 'learning_rate': 4.725705329153605e-05, 'rewards/chosen': -0.043990302830934525, 'rewards/rejected': -0.3263363540172577, 'rewards/accuracies': 0.4000000059604645, 'rewards/margins': 0.2823460102081299, 'logps/rejected': -60.647071838378906, 'logps/chosen': -55.80393600463867, 'logits/rejected': -0.5492503643035889, 'logits/chosen': -0.5320320725440979, 'epoch': 0.05}
  5%|▌         | 140/2552 [06:37<1:06:39,  1.66s/it]  6%|▌         | 141/2552 [06:39<1:10:26,  1.75s/it]  6%|▌         | 142/2552 [06:41<1:10:38,  1.76s/it]  6%|▌         | 143/2552 [06:43<1:09:45,  1.74s/it]  6%|▌         | 144/2552 [06:44<1:09:14,  1.73s/it]  6%|▌         | 145/2552 [06:46<1:06:33,  1.66s/it]  6%|▌         | 146/2552 [06:47<1:06:37,  1.66s/it]  6%|▌         | 147/2552 [06:49<1:11:00,  1.77s/it]  6%|▌         | 148/2552 [06:51<1:08:52,  1.72s/it]  6%|▌         | 149/2552 [06:53<1:05:41,  1.64s/it]  6%|▌         | 150/2552 [06:54<1:05:12,  1.63s/it]                                                    {'loss': 0.6237, 'grad_norm': 4.834322929382324, 'learning_rate': 4.706112852664577e-05, 'rewards/chosen': 0.38893622159957886, 'rewards/rejected': -0.9630587697029114, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.3519951105117798, 'logps/rejected': -68.58660125732422, 'logps/chosen': -24.82174301147461, 'logits/rejected': -0.6291958689689636, 'logits/chosen': -0.5817833542823792, 'epoch': 0.06}
  6%|▌         | 150/2552 [06:54<1:05:12,  1.63s/it]  6%|▌         | 151/2552 [06:56<1:05:54,  1.65s/it]  6%|▌         | 152/2552 [06:58<1:07:39,  1.69s/it]  6%|▌         | 153/2552 [06:59<1:08:01,  1.70s/it]  6%|▌         | 154/2552 [07:01<1:08:34,  1.72s/it]  6%|▌         | 155/2552 [07:03<1:06:56,  1.68s/it]  6%|▌         | 156/2552 [07:04<1:05:15,  1.63s/it]  6%|▌         | 157/2552 [07:06<1:04:57,  1.63s/it]  6%|▌         | 158/2552 [07:07<1:02:40,  1.57s/it]  6%|▌         | 159/2552 [07:09<1:03:41,  1.60s/it]  6%|▋         | 160/2552 [07:10<1:02:34,  1.57s/it]                                                    {'loss': 0.5567, 'grad_norm': 4.633083343505859, 'learning_rate': 4.686520376175549e-05, 'rewards/chosen': -0.32373249530792236, 'rewards/rejected': -1.2301018238067627, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.9063690900802612, 'logps/rejected': -54.9049186706543, 'logps/chosen': -39.46514129638672, 'logits/rejected': -0.44612422585487366, 'logits/chosen': -0.4231444001197815, 'epoch': 0.06}
  6%|▋         | 160/2552 [07:10<1:02:34,  1.57s/it]  6%|▋         | 161/2552 [07:12<1:04:10,  1.61s/it]  6%|▋         | 162/2552 [07:14<1:04:21,  1.62s/it]  6%|▋         | 163/2552 [07:16<1:09:18,  1.74s/it]  6%|▋         | 164/2552 [07:18<1:09:03,  1.74s/it]  6%|▋         | 165/2552 [07:19<1:07:49,  1.70s/it]  7%|▋         | 166/2552 [07:21<1:08:16,  1.72s/it]  7%|▋         | 167/2552 [07:22<1:05:45,  1.65s/it]  7%|▋         | 168/2552 [07:24<1:06:59,  1.69s/it]  7%|▋         | 169/2552 [07:26<1:03:46,  1.61s/it]  7%|▋         | 170/2552 [07:27<1:01:45,  1.56s/it]                                                    {'loss': 0.5689, 'grad_norm': 6.89391565322876, 'learning_rate': 4.6669278996865205e-05, 'rewards/chosen': 0.18521283566951752, 'rewards/rejected': -1.121053695678711, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.3062666654586792, 'logps/rejected': -60.80138397216797, 'logps/chosen': -44.59058380126953, 'logits/rejected': -0.4779229760169983, 'logits/chosen': -0.46183285117149353, 'epoch': 0.07}
  7%|▋         | 170/2552 [07:27<1:01:45,  1.56s/it]  7%|▋         | 171/2552 [07:29<1:04:03,  1.61s/it]  7%|▋         | 172/2552 [07:30<1:03:14,  1.59s/it]  7%|▋         | 173/2552 [07:32<1:06:05,  1.67s/it]  7%|▋         | 174/2552 [07:34<1:05:13,  1.65s/it]  7%|▋         | 175/2552 [07:35<1:04:04,  1.62s/it]  7%|▋         | 176/2552 [07:37<1:03:53,  1.61s/it]  7%|▋         | 177/2552 [07:39<1:05:46,  1.66s/it]  7%|▋         | 178/2552 [07:41<1:07:59,  1.72s/it]  7%|▋         | 179/2552 [07:42<1:11:01,  1.80s/it]  7%|▋         | 180/2552 [07:44<1:08:15,  1.73s/it]                                                    {'loss': 0.5207, 'grad_norm': 4.761425018310547, 'learning_rate': 4.647335423197492e-05, 'rewards/chosen': -0.1615011990070343, 'rewards/rejected': -0.7443745732307434, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.5828733444213867, 'logps/rejected': -61.65301513671875, 'logps/chosen': -31.357152938842773, 'logits/rejected': -0.594214141368866, 'logits/chosen': -0.5556886792182922, 'epoch': 0.07}
  7%|▋         | 180/2552 [07:44<1:08:15,  1.73s/it]  7%|▋         | 181/2552 [07:46<1:11:27,  1.81s/it]  7%|▋         | 182/2552 [07:48<1:07:19,  1.70s/it]  7%|▋         | 183/2552 [07:49<1:05:05,  1.65s/it]  7%|▋         | 184/2552 [07:50<1:02:39,  1.59s/it]  7%|▋         | 185/2552 [07:52<1:01:59,  1.57s/it]  7%|▋         | 186/2552 [07:53<1:00:25,  1.53s/it]  7%|▋         | 187/2552 [07:55<1:05:47,  1.67s/it]  7%|▋         | 188/2552 [07:57<1:02:04,  1.58s/it]  7%|▋         | 189/2552 [07:58<1:01:52,  1.57s/it]  7%|▋         | 190/2552 [08:00<1:03:40,  1.62s/it]                                                    {'loss': 0.5291, 'grad_norm': 6.982179164886475, 'learning_rate': 4.627742946708464e-05, 'rewards/chosen': -0.30341100692749023, 'rewards/rejected': -1.1976556777954102, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 0.8942447900772095, 'logps/rejected': -58.61482620239258, 'logps/chosen': -32.151145935058594, 'logits/rejected': -0.5453093647956848, 'logits/chosen': -0.5069035887718201, 'epoch': 0.07}
  7%|▋         | 190/2552 [08:00<1:03:40,  1.62s/it]  7%|▋         | 191/2552 [08:02<1:04:04,  1.63s/it]  8%|▊         | 192/2552 [08:03<1:03:21,  1.61s/it]  8%|▊         | 193/2552 [08:05<1:01:19,  1.56s/it]  8%|▊         | 194/2552 [08:07<1:03:57,  1.63s/it]  8%|▊         | 195/2552 [08:08<1:02:57,  1.60s/it]  8%|▊         | 196/2552 [08:10<1:03:23,  1.61s/it]  8%|▊         | 197/2552 [08:11<59:34,  1.52s/it]    8%|▊         | 198/2552 [08:13<1:00:05,  1.53s/it]  8%|▊         | 199/2552 [08:14<1:03:14,  1.61s/it]  8%|▊         | 200/2552 [08:16<1:04:22,  1.64s/it]                                                    {'loss': 0.5481, 'grad_norm': 7.514936923980713, 'learning_rate': 4.608150470219436e-05, 'rewards/chosen': -0.0011868715519085526, 'rewards/rejected': -0.7384995222091675, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.7373127341270447, 'logps/rejected': -66.46955871582031, 'logps/chosen': -46.129905700683594, 'logits/rejected': -0.6762446165084839, 'logits/chosen': -0.6717394590377808, 'epoch': 0.08}
  8%|▊         | 200/2552 [08:16<1:04:22,  1.64s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:02,  1.20it/s][A
  4%|▍         | 3/77 [00:02<01:16,  1.03s/it][A
  5%|▌         | 4/77 [00:04<01:21,  1.11s/it][A
  6%|▋         | 5/77 [00:06<01:41,  1.41s/it][A
  8%|▊         | 6/77 [00:07<01:32,  1.31s/it][A
  9%|▉         | 7/77 [00:08<01:31,  1.31s/it][A
 10%|█         | 8/77 [00:10<01:34,  1.37s/it][A
 12%|█▏        | 9/77 [00:11<01:36,  1.42s/it][A
 13%|█▎        | 10/77 [00:12<01:28,  1.32s/it][A
 14%|█▍        | 11/77 [00:13<01:21,  1.23s/it][A
 16%|█▌        | 12/77 [00:15<01:34,  1.46s/it][A
 17%|█▋        | 13/77 [00:16<01:28,  1.38s/it][A
 18%|█▊        | 14/77 [00:18<01:22,  1.31s/it][A
 19%|█▉        | 15/77 [00:19<01:27,  1.41s/it][A
 21%|██        | 16/77 [00:20<01:15,  1.24s/it][A
 22%|██▏       | 17/77 [00:21<01:15,  1.25s/it][A
 23%|██▎       | 18/77 [00:23<01:17,  1.31s/it][A
 25%|██▍       | 19/77 [00:25<01:24,  1.46s/it][A
 26%|██▌       | 20/77 [00:25<01:11,  1.26s/it][A
 27%|██▋       | 21/77 [00:26<01:05,  1.18s/it][A
 29%|██▊       | 22/77 [00:28<01:10,  1.29s/it][A
 30%|██▉       | 23/77 [00:30<01:19,  1.47s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.43s/it][A
 32%|███▏      | 25/77 [00:32<01:12,  1.40s/it][A
 34%|███▍      | 26/77 [00:34<01:05,  1.29s/it][A
 35%|███▌      | 27/77 [00:35<01:07,  1.35s/it][A
 36%|███▋      | 28/77 [00:36<01:02,  1.27s/it][A
 38%|███▊      | 29/77 [00:38<01:08,  1.42s/it][A
 39%|███▉      | 30/77 [00:40<01:11,  1.52s/it][A
 40%|████      | 31/77 [00:41<01:11,  1.55s/it][A
 42%|████▏     | 32/77 [00:43<01:09,  1.55s/it][A
 43%|████▎     | 33/77 [00:44<01:07,  1.52s/it][A
 44%|████▍     | 34/77 [00:46<01:06,  1.54s/it][A
 45%|████▌     | 35/77 [00:47<01:03,  1.50s/it][A
 47%|████▋     | 36/77 [00:49<01:04,  1.56s/it][A
 48%|████▊     | 37/77 [00:50<00:57,  1.44s/it][A
 49%|████▉     | 38/77 [00:51<00:52,  1.35s/it][A
 51%|█████     | 39/77 [00:53<00:57,  1.52s/it][A
 52%|█████▏    | 40/77 [00:55<00:57,  1.55s/it][A
 53%|█████▎    | 41/77 [00:56<00:50,  1.40s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.42s/it][A
 56%|█████▌    | 43/77 [00:59<00:52,  1.55s/it][A
 57%|█████▋    | 44/77 [01:00<00:46,  1.41s/it][A
 58%|█████▊    | 45/77 [01:01<00:41,  1.29s/it][A
 60%|█████▉    | 46/77 [01:03<00:40,  1.30s/it][A
 61%|██████    | 47/77 [01:04<00:38,  1.27s/it][A
 62%|██████▏   | 48/77 [01:05<00:39,  1.38s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.42s/it][A
 65%|██████▍   | 50/77 [01:08<00:38,  1.43s/it][A
 66%|██████▌   | 51/77 [01:10<00:40,  1.54s/it][A
 68%|██████▊   | 52/77 [01:12<00:38,  1.53s/it][A
 69%|██████▉   | 53/77 [01:14<00:39,  1.64s/it][A
 70%|███████   | 54/77 [01:15<00:35,  1.53s/it][A
 71%|███████▏  | 55/77 [01:16<00:31,  1.44s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.68s/it][A
 74%|███████▍  | 57/77 [01:20<00:31,  1.58s/it][A
 75%|███████▌  | 58/77 [01:21<00:30,  1.60s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.59s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.42s/it][A
 79%|███████▉  | 61/77 [01:26<00:23,  1.49s/it][A
 81%|████████  | 62/77 [01:27<00:22,  1.48s/it][A
 82%|████████▏ | 63/77 [01:29<00:21,  1.54s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.42s/it][A
 84%|████████▍ | 65/77 [01:31<00:16,  1.41s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.56s/it][A
 87%|████████▋ | 67/77 [01:34<00:12,  1.30s/it][A
 88%|████████▊ | 68/77 [01:36<00:13,  1.45s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.46s/it][A
 91%|█████████ | 70/77 [01:38<00:09,  1.38s/it][A
 92%|█████████▏| 71/77 [01:39<00:07,  1.30s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.33s/it][A
 95%|█████████▍| 73/77 [01:42<00:05,  1.43s/it][A
 96%|█████████▌| 74/77 [01:44<00:04,  1.59s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.55s/it][A
 99%|█████████▊| 76/77 [01:47<00:01,  1.49s/it][A
100%|██████████| 77/77 [01:49<00:00,  1.54s/it][A                                                    
                                               [A{'eval_loss': 0.6129547953605652, 'eval_runtime': 110.7677, 'eval_samples_per_second': 11.032, 'eval_steps_per_second': 0.695, 'eval_rewards/chosen': -0.37732797861099243, 'eval_rewards/rejected': -1.0147032737731934, 'eval_rewards/accuracies': 0.7272727489471436, 'eval_rewards/margins': 0.6373753547668457, 'eval_logps/rejected': -49.40017318725586, 'eval_logps/chosen': -42.28213882446289, 'eval_logits/rejected': -0.5217078328132629, 'eval_logits/chosen': -0.522171139717102, 'epoch': 0.08}
  8%|▊         | 200/2552 [10:07<1:04:22,  1.64s/it]
100%|██████████| 77/77 [01:49<00:00,  1.54s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
  8%|▊         | 201/2552 [10:35<28:01:46, 42.92s/it]  8%|▊         | 202/2552 [10:37<19:54:43, 30.50s/it]  8%|▊         | 203/2552 [10:39<14:17:32, 21.90s/it]  8%|▊         | 204/2552 [10:40<10:18:10, 15.80s/it]  8%|▊         | 205/2552 [10:42<7:32:04, 11.56s/it]   8%|▊         | 206/2552 [10:43<5:33:09,  8.52s/it]  8%|▊         | 207/2552 [10:45<4:09:26,  6.38s/it]  8%|▊         | 208/2552 [10:46<3:12:04,  4.92s/it]  8%|▊         | 209/2552 [10:48<2:33:25,  3.93s/it]  8%|▊         | 210/2552 [10:50<2:07:15,  3.26s/it]                                                    {'loss': 0.6451, 'grad_norm': 5.0685343742370605, 'learning_rate': 4.588557993730408e-05, 'rewards/chosen': -1.1492857933044434, 'rewards/rejected': -1.2760703563690186, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.1267845332622528, 'logps/rejected': -61.8379020690918, 'logps/chosen': -54.93060302734375, 'logits/rejected': -0.5302689075469971, 'logits/chosen': -0.5233431458473206, 'epoch': 0.08}
  8%|▊         | 210/2552 [10:50<2:07:15,  3.26s/it]  8%|▊         | 211/2552 [10:51<1:47:07,  2.75s/it]  8%|▊         | 212/2552 [10:53<1:34:30,  2.42s/it]  8%|▊         | 213/2552 [10:55<1:28:19,  2.27s/it]  8%|▊         | 214/2552 [10:56<1:21:21,  2.09s/it]  8%|▊         | 215/2552 [10:58<1:16:40,  1.97s/it]  8%|▊         | 216/2552 [11:00<1:12:46,  1.87s/it]  9%|▊         | 217/2552 [11:01<1:08:36,  1.76s/it]  9%|▊         | 218/2552 [11:03<1:03:15,  1.63s/it]  9%|▊         | 219/2552 [11:04<1:04:12,  1.65s/it]  9%|▊         | 220/2552 [11:06<1:02:10,  1.60s/it]                                                    {'loss': 0.6005, 'grad_norm': 6.673942565917969, 'learning_rate': 4.5689655172413794e-05, 'rewards/chosen': -0.5600466728210449, 'rewards/rejected': -0.7096897959709167, 'rewards/accuracies': 0.5, 'rewards/margins': 0.14964312314987183, 'logps/rejected': -67.84965515136719, 'logps/chosen': -61.168739318847656, 'logits/rejected': -0.6307119727134705, 'logits/chosen': -0.6217125654220581, 'epoch': 0.09}
  9%|▊         | 220/2552 [11:06<1:02:10,  1.60s/it]  9%|▊         | 221/2552 [11:07<1:02:39,  1.61s/it]  9%|▊         | 222/2552 [11:09<1:01:10,  1.58s/it]  9%|▊         | 223/2552 [11:10<59:30,  1.53s/it]    9%|▉         | 224/2552 [11:12<1:02:00,  1.60s/it]  9%|▉         | 225/2552 [11:14<1:01:37,  1.59s/it]  9%|▉         | 226/2552 [11:15<1:04:18,  1.66s/it]  9%|▉         | 227/2552 [11:17<1:04:17,  1.66s/it]  9%|▉         | 228/2552 [11:19<1:04:29,  1.67s/it]  9%|▉         | 229/2552 [11:20<1:01:47,  1.60s/it]  9%|▉         | 230/2552 [11:22<59:18,  1.53s/it]                                                    {'loss': 0.5765, 'grad_norm': 8.156693458557129, 'learning_rate': 4.549373040752351e-05, 'rewards/chosen': 0.3698022961616516, 'rewards/rejected': -1.1529948711395264, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.5227973461151123, 'logps/rejected': -42.04917526245117, 'logps/chosen': -17.548839569091797, 'logits/rejected': -0.639539361000061, 'logits/chosen': -0.616726279258728, 'epoch': 0.09}
  9%|▉         | 230/2552 [11:22<59:18,  1.53s/it]  9%|▉         | 231/2552 [11:23<1:00:33,  1.57s/it]  9%|▉         | 232/2552 [11:25<59:43,  1.54s/it]    9%|▉         | 233/2552 [11:26<59:50,  1.55s/it]  9%|▉         | 234/2552 [11:28<58:39,  1.52s/it]  9%|▉         | 235/2552 [11:29<58:47,  1.52s/it]  9%|▉         | 236/2552 [11:31<1:01:30,  1.59s/it]  9%|▉         | 237/2552 [11:32<59:08,  1.53s/it]    9%|▉         | 238/2552 [11:34<56:36,  1.47s/it]  9%|▉         | 239/2552 [11:35<1:00:16,  1.56s/it]  9%|▉         | 240/2552 [11:37<57:43,  1.50s/it]                                                    {'loss': 0.7152, 'grad_norm': 9.09497356414795, 'learning_rate': 4.529780564263323e-05, 'rewards/chosen': -0.2498755007982254, 'rewards/rejected': -0.3244243562221527, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.07454885542392731, 'logps/rejected': -40.398990631103516, 'logps/chosen': -39.14018630981445, 'logits/rejected': -0.5622420310974121, 'logits/chosen': -0.5574698448181152, 'epoch': 0.09}
  9%|▉         | 240/2552 [11:37<57:43,  1.50s/it]  9%|▉         | 241/2552 [11:39<1:00:14,  1.56s/it]  9%|▉         | 242/2552 [11:40<58:30,  1.52s/it]   10%|▉         | 243/2552 [11:41<57:42,  1.50s/it] 10%|▉         | 244/2552 [11:43<56:42,  1.47s/it] 10%|▉         | 245/2552 [11:44<57:12,  1.49s/it] 10%|▉         | 246/2552 [11:46<57:51,  1.51s/it] 10%|▉         | 247/2552 [11:47<57:26,  1.50s/it] 10%|▉         | 248/2552 [11:49<59:59,  1.56s/it] 10%|▉         | 249/2552 [11:51<1:00:09,  1.57s/it] 10%|▉         | 250/2552 [11:52<1:01:29,  1.60s/it]                                                    {'loss': 0.5894, 'grad_norm': 6.276381015777588, 'learning_rate': 4.510188087774295e-05, 'rewards/chosen': 0.05837731808423996, 'rewards/rejected': -0.6222594976425171, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.6806368231773376, 'logps/rejected': -50.89448928833008, 'logps/chosen': -44.83466339111328, 'logits/rejected': -0.6143274903297424, 'logits/chosen': -0.6012542247772217, 'epoch': 0.1}
 10%|▉         | 250/2552 [11:52<1:01:29,  1.60s/it] 10%|▉         | 251/2552 [11:54<59:19,  1.55s/it]   10%|▉         | 252/2552 [11:55<57:54,  1.51s/it] 10%|▉         | 253/2552 [11:57<56:06,  1.46s/it] 10%|▉         | 254/2552 [11:58<58:28,  1.53s/it] 10%|▉         | 255/2552 [12:00<56:35,  1.48s/it] 10%|█         | 256/2552 [12:01<59:11,  1.55s/it] 10%|█         | 257/2552 [12:03<58:07,  1.52s/it] 10%|█         | 258/2552 [12:04<59:54,  1.57s/it] 10%|█         | 259/2552 [12:06<56:12,  1.47s/it] 10%|█         | 260/2552 [12:07<59:07,  1.55s/it]                                                  {'loss': 0.5545, 'grad_norm': 9.806349754333496, 'learning_rate': 4.4905956112852666e-05, 'rewards/chosen': -0.09721006453037262, 'rewards/rejected': -0.6348251104354858, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.5376150608062744, 'logps/rejected': -58.9412956237793, 'logps/chosen': -43.82821273803711, 'logits/rejected': -0.6024869680404663, 'logits/chosen': -0.5816507935523987, 'epoch': 0.1}
 10%|█         | 260/2552 [12:07<59:07,  1.55s/it] 10%|█         | 261/2552 [12:09<58:14,  1.53s/it] 10%|█         | 262/2552 [12:11<1:00:22,  1.58s/it] 10%|█         | 263/2552 [12:12<57:48,  1.52s/it]   10%|█         | 264/2552 [12:13<56:32,  1.48s/it] 10%|█         | 265/2552 [12:15<55:26,  1.45s/it] 10%|█         | 266/2552 [12:16<56:07,  1.47s/it] 10%|█         | 267/2552 [12:18<57:08,  1.50s/it] 11%|█         | 268/2552 [12:19<57:29,  1.51s/it] 11%|█         | 269/2552 [12:21<57:51,  1.52s/it] 11%|█         | 270/2552 [12:23<1:00:04,  1.58s/it]                                                    {'loss': 0.5975, 'grad_norm': 12.990022659301758, 'learning_rate': 4.4710031347962384e-05, 'rewards/chosen': -0.0023571313358843327, 'rewards/rejected': -0.6644934415817261, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.6621363759040833, 'logps/rejected': -52.6806755065918, 'logps/chosen': -29.8734130859375, 'logits/rejected': -0.60945063829422, 'logits/chosen': -0.5819233655929565, 'epoch': 0.11}
 11%|█         | 270/2552 [12:23<1:00:04,  1.58s/it] 11%|█         | 271/2552 [12:24<1:02:50,  1.65s/it] 11%|█         | 272/2552 [12:26<1:01:17,  1.61s/it] 11%|█         | 273/2552 [12:28<1:03:16,  1.67s/it] 11%|█         | 274/2552 [12:30<1:05:06,  1.71s/it] 11%|█         | 275/2552 [12:31<1:00:50,  1.60s/it] 11%|█         | 276/2552 [12:32<58:55,  1.55s/it]   11%|█         | 277/2552 [12:34<58:40,  1.55s/it] 11%|█         | 278/2552 [12:36<59:30,  1.57s/it] 11%|█         | 279/2552 [12:37<56:02,  1.48s/it] 11%|█         | 280/2552 [12:38<54:40,  1.44s/it]                                                  {'loss': 0.6592, 'grad_norm': 11.509461402893066, 'learning_rate': 4.45141065830721e-05, 'rewards/chosen': -0.6340862512588501, 'rewards/rejected': -0.8754379153251648, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.2413516342639923, 'logps/rejected': -80.8100357055664, 'logps/chosen': -49.032432556152344, 'logits/rejected': -0.5224780440330505, 'logits/chosen': -0.49935421347618103, 'epoch': 0.11}
 11%|█         | 280/2552 [12:38<54:40,  1.44s/it] 11%|█         | 281/2552 [12:40<54:21,  1.44s/it] 11%|█         | 282/2552 [12:41<55:46,  1.47s/it] 11%|█         | 283/2552 [12:43<58:41,  1.55s/it] 11%|█         | 284/2552 [12:44<58:17,  1.54s/it] 11%|█         | 285/2552 [12:46<59:14,  1.57s/it] 11%|█         | 286/2552 [12:47<57:33,  1.52s/it] 11%|█         | 287/2552 [12:49<55:44,  1.48s/it] 11%|█▏        | 288/2552 [12:50<56:51,  1.51s/it] 11%|█▏        | 289/2552 [12:52<55:28,  1.47s/it] 11%|█▏        | 290/2552 [12:53<54:17,  1.44s/it]                                                  {'loss': 0.5106, 'grad_norm': 7.173242568969727, 'learning_rate': 4.431818181818182e-05, 'rewards/chosen': -0.16240118443965912, 'rewards/rejected': -1.7498600482940674, 'rewards/accuracies': 1.0, 'rewards/margins': 1.5874587297439575, 'logps/rejected': -71.31515502929688, 'logps/chosen': -55.79069900512695, 'logits/rejected': -0.5807923674583435, 'logits/chosen': -0.5702134370803833, 'epoch': 0.11}
 11%|█▏        | 290/2552 [12:53<54:17,  1.44s/it] 11%|█▏        | 291/2552 [12:55<57:43,  1.53s/it] 11%|█▏        | 292/2552 [12:56<56:33,  1.50s/it] 11%|█▏        | 293/2552 [12:58<55:35,  1.48s/it] 12%|█▏        | 294/2552 [12:59<56:54,  1.51s/it] 12%|█▏        | 295/2552 [13:01<55:13,  1.47s/it] 12%|█▏        | 296/2552 [13:03<59:15,  1.58s/it] 12%|█▏        | 297/2552 [13:04<59:02,  1.57s/it] 12%|█▏        | 298/2552 [13:06<57:44,  1.54s/it] 12%|█▏        | 299/2552 [13:07<1:00:08,  1.60s/it] 12%|█▏        | 300/2552 [13:09<58:39,  1.56s/it]                                                    {'loss': 0.5243, 'grad_norm': 8.926619529724121, 'learning_rate': 4.412225705329154e-05, 'rewards/chosen': -0.05289123207330704, 'rewards/rejected': -1.2129874229431152, 'rewards/accuracies': 1.0, 'rewards/margins': 1.1600961685180664, 'logps/rejected': -68.47199249267578, 'logps/chosen': -47.99776077270508, 'logits/rejected': -0.5587151050567627, 'logits/chosen': -0.5446923971176147, 'epoch': 0.12}
 12%|█▏        | 300/2552 [13:09<58:39,  1.56s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:01,  1.22it/s][A
  4%|▍         | 3/77 [00:02<01:14,  1.01s/it][A
  5%|▌         | 4/77 [00:04<01:20,  1.10s/it][A
  6%|▋         | 5/77 [00:06<01:40,  1.40s/it][A
  8%|▊         | 6/77 [00:07<01:32,  1.30s/it][A
  9%|▉         | 7/77 [00:08<01:32,  1.32s/it][A
 10%|█         | 8/77 [00:10<01:34,  1.37s/it][A
 12%|█▏        | 9/77 [00:11<01:37,  1.43s/it][A
 13%|█▎        | 10/77 [00:12<01:28,  1.32s/it][A
 14%|█▍        | 11/77 [00:13<01:21,  1.23s/it][A
 16%|█▌        | 12/77 [00:15<01:34,  1.45s/it][A
 17%|█▋        | 13/77 [00:16<01:27,  1.37s/it][A
 18%|█▊        | 14/77 [00:17<01:21,  1.29s/it][A
 19%|█▉        | 15/77 [00:19<01:27,  1.42s/it][A
 21%|██        | 16/77 [00:20<01:15,  1.24s/it][A
 22%|██▏       | 17/77 [00:21<01:15,  1.25s/it][A
 23%|██▎       | 18/77 [00:23<01:16,  1.30s/it][A
 25%|██▍       | 19/77 [00:25<01:24,  1.45s/it][A
 26%|██▌       | 20/77 [00:25<01:11,  1.26s/it][A
 27%|██▋       | 21/77 [00:26<01:05,  1.17s/it][A
 29%|██▊       | 22/77 [00:28<01:10,  1.28s/it][A
 30%|██▉       | 23/77 [00:30<01:19,  1.46s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.42s/it][A
 32%|███▏      | 25/77 [00:32<01:12,  1.39s/it][A
 34%|███▍      | 26/77 [00:33<01:05,  1.27s/it][A
 35%|███▌      | 27/77 [00:35<01:06,  1.32s/it][A
 36%|███▋      | 28/77 [00:36<01:02,  1.27s/it][A
 38%|███▊      | 29/77 [00:38<01:07,  1.41s/it][A
 39%|███▉      | 30/77 [00:39<01:11,  1.51s/it][A
 40%|████      | 31/77 [00:41<01:11,  1.55s/it][A
 42%|████▏     | 32/77 [00:43<01:09,  1.55s/it][A
 43%|████▎     | 33/77 [00:44<01:06,  1.52s/it][A
 44%|████▍     | 34/77 [00:46<01:05,  1.52s/it][A
 45%|████▌     | 35/77 [00:47<01:02,  1.48s/it][A
 47%|████▋     | 36/77 [00:49<01:03,  1.55s/it][A
 48%|████▊     | 37/77 [00:50<00:57,  1.43s/it][A
 49%|████▉     | 38/77 [00:51<00:52,  1.35s/it][A
 51%|█████     | 39/77 [00:53<00:57,  1.51s/it][A
 52%|█████▏    | 40/77 [00:55<00:57,  1.54s/it][A
 53%|█████▎    | 41/77 [00:56<00:50,  1.39s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.41s/it][A
 56%|█████▌    | 43/77 [00:59<00:52,  1.54s/it][A
 57%|█████▋    | 44/77 [01:00<00:46,  1.41s/it][A
 58%|█████▊    | 45/77 [01:01<00:40,  1.28s/it][A
 60%|█████▉    | 46/77 [01:02<00:40,  1.31s/it][A
 61%|██████    | 47/77 [01:03<00:38,  1.27s/it][A
 62%|██████▏   | 48/77 [01:05<00:39,  1.37s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.41s/it][A
 65%|██████▍   | 50/77 [01:08<00:38,  1.43s/it][A
 66%|██████▌   | 51/77 [01:10<00:39,  1.54s/it][A
 68%|██████▊   | 52/77 [01:11<00:38,  1.53s/it][A
 69%|██████▉   | 53/77 [01:13<00:39,  1.63s/it][A
 70%|███████   | 54/77 [01:15<00:35,  1.53s/it][A
 71%|███████▏  | 55/77 [01:16<00:31,  1.44s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.68s/it][A
 74%|███████▍  | 57/77 [01:19<00:31,  1.56s/it][A
 75%|███████▌  | 58/77 [01:21<00:30,  1.60s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.58s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.42s/it][A
 79%|███████▉  | 61/77 [01:25<00:23,  1.49s/it][A
 81%|████████  | 62/77 [01:27<00:21,  1.47s/it][A
 82%|████████▏ | 63/77 [01:28<00:21,  1.53s/it][A
 83%|████████▎ | 64/77 [01:29<00:18,  1.41s/it][A
 84%|████████▍ | 65/77 [01:31<00:16,  1.41s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.55s/it][A
 87%|████████▋ | 67/77 [01:33<00:12,  1.29s/it][A
 88%|████████▊ | 68/77 [01:35<00:13,  1.45s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.45s/it][A
 91%|█████████ | 70/77 [01:38<00:09,  1.39s/it][A
 92%|█████████▏| 71/77 [01:39<00:07,  1.30s/it][A
 94%|█████████▎| 72/77 [01:40<00:06,  1.33s/it][A
 95%|█████████▍| 73/77 [01:42<00:05,  1.44s/it][A
 96%|█████████▌| 74/77 [01:44<00:04,  1.59s/it][A
 97%|█████████▋| 75/77 [01:45<00:03,  1.54s/it][A
 99%|█████████▊| 76/77 [01:47<00:01,  1.49s/it][A
100%|██████████| 77/77 [01:48<00:00,  1.53s/it][A                                                  
                                               [A{'eval_loss': 0.5699177980422974, 'eval_runtime': 110.3214, 'eval_samples_per_second': 11.077, 'eval_steps_per_second': 0.698, 'eval_rewards/chosen': -0.26526376605033875, 'eval_rewards/rejected': -0.8912822008132935, 'eval_rewards/accuracies': 0.7467532753944397, 'eval_rewards/margins': 0.6260184049606323, 'eval_logps/rejected': -48.16596603393555, 'eval_logps/chosen': -41.16149139404297, 'eval_logits/rejected': -0.48713675141334534, 'eval_logits/chosen': -0.4876733124256134, 'epoch': 0.12}
 12%|█▏        | 300/2552 [14:59<58:39,  1.56s/it]
100%|██████████| 77/77 [01:49<00:00,  1.53s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 12%|█▏        | 301/2552 [15:27<26:40:01, 42.65s/it] 12%|█▏        | 302/2552 [15:29<18:55:37, 30.28s/it] 12%|█▏        | 303/2552 [15:31<13:34:56, 21.74s/it] 12%|█▏        | 304/2552 [15:32<9:48:53, 15.72s/it]  12%|█▏        | 305/2552 [15:34<7:07:48, 11.42s/it] 12%|█▏        | 306/2552 [15:35<5:18:11,  8.50s/it] 12%|█▏        | 307/2552 [15:37<3:58:43,  6.38s/it] 12%|█▏        | 308/2552 [15:38<3:03:52,  4.92s/it] 12%|█▏        | 309/2552 [15:40<2:24:56,  3.88s/it] 12%|█▏        | 310/2552 [15:41<1:59:12,  3.19s/it]                                                    {'loss': 0.5742, 'grad_norm': 11.905658721923828, 'learning_rate': 4.3926332288401255e-05, 'rewards/chosen': 0.10563401877880096, 'rewards/rejected': -1.1332701444625854, 'rewards/accuracies': 1.0, 'rewards/margins': 1.2389042377471924, 'logps/rejected': -44.544010162353516, 'logps/chosen': -28.33370590209961, 'logits/rejected': -0.6827166080474854, 'logits/chosen': -0.6653091907501221, 'epoch': 0.12}
 12%|█▏        | 310/2552 [15:41<1:59:12,  3.19s/it] 12%|█▏        | 311/2552 [15:43<1:42:56,  2.76s/it] 12%|█▏        | 312/2552 [15:45<1:30:51,  2.43s/it] 12%|█▏        | 313/2552 [15:46<1:20:22,  2.15s/it] 12%|█▏        | 314/2552 [15:48<1:11:32,  1.92s/it] 12%|█▏        | 315/2552 [15:49<1:05:54,  1.77s/it] 12%|█▏        | 316/2552 [15:50<1:00:34,  1.63s/it] 12%|█▏        | 317/2552 [15:52<59:46,  1.60s/it]   12%|█▏        | 318/2552 [15:53<55:49,  1.50s/it] 12%|█▎        | 319/2552 [15:54<53:44,  1.44s/it] 13%|█▎        | 320/2552 [15:56<55:36,  1.49s/it]                                                  {'loss': 0.5762, 'grad_norm': 12.721973419189453, 'learning_rate': 4.373040752351097e-05, 'rewards/chosen': 0.100904181599617, 'rewards/rejected': -1.3122601509094238, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.4131643772125244, 'logps/rejected': -62.9595947265625, 'logps/chosen': -45.0377082824707, 'logits/rejected': -0.533436119556427, 'logits/chosen': -0.5185867547988892, 'epoch': 0.13}
 13%|█▎        | 320/2552 [15:56<55:36,  1.49s/it] 13%|█▎        | 321/2552 [15:58<57:16,  1.54s/it] 13%|█▎        | 322/2552 [15:59<57:28,  1.55s/it] 13%|█▎        | 323/2552 [16:01<56:31,  1.52s/it] 13%|█▎        | 324/2552 [16:02<55:08,  1.48s/it] 13%|█▎        | 325/2552 [16:04<56:02,  1.51s/it] 13%|█▎        | 326/2552 [16:05<53:44,  1.45s/it] 13%|█▎        | 327/2552 [16:07<59:32,  1.61s/it] 13%|█▎        | 328/2552 [16:08<56:59,  1.54s/it] 13%|█▎        | 329/2552 [16:10<57:22,  1.55s/it] 13%|█▎        | 330/2552 [16:11<56:38,  1.53s/it]                                                  {'loss': 0.535, 'grad_norm': 7.403514385223389, 'learning_rate': 4.353448275862069e-05, 'rewards/chosen': -0.49024906754493713, 'rewards/rejected': -0.8461157083511353, 'rewards/accuracies': 0.5, 'rewards/margins': 0.35586661100387573, 'logps/rejected': -71.99089050292969, 'logps/chosen': -53.8329963684082, 'logits/rejected': -0.5992772579193115, 'logits/chosen': -0.5861352682113647, 'epoch': 0.13}
 13%|█▎        | 330/2552 [16:11<56:38,  1.53s/it] 13%|█▎        | 331/2552 [16:13<59:03,  1.60s/it] 13%|█▎        | 332/2552 [16:15<58:50,  1.59s/it] 13%|█▎        | 333/2552 [16:16<1:00:16,  1.63s/it] 13%|█▎        | 334/2552 [16:18<57:30,  1.56s/it]   13%|█▎        | 335/2552 [16:19<56:44,  1.54s/it] 13%|█▎        | 336/2552 [16:21<55:26,  1.50s/it] 13%|█▎        | 337/2552 [16:22<56:13,  1.52s/it] 13%|█▎        | 338/2552 [16:24<56:29,  1.53s/it] 13%|█▎        | 339/2552 [16:25<55:01,  1.49s/it] 13%|█▎        | 340/2552 [16:27<57:09,  1.55s/it]                                                  {'loss': 0.512, 'grad_norm': 10.024158477783203, 'learning_rate': 4.333855799373041e-05, 'rewards/chosen': -0.12008174508810043, 'rewards/rejected': -0.9802601933479309, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 0.8601784706115723, 'logps/rejected': -54.7960319519043, 'logps/chosen': -27.420719146728516, 'logits/rejected': -0.48210421204566956, 'logits/chosen': -0.44766467809677124, 'epoch': 0.13}
 13%|█▎        | 340/2552 [16:27<57:09,  1.55s/it] 13%|█▎        | 341/2552 [16:28<56:55,  1.54s/it] 13%|█▎        | 342/2552 [16:30<57:06,  1.55s/it] 13%|█▎        | 343/2552 [16:32<56:53,  1.55s/it] 13%|█▎        | 344/2552 [16:33<54:00,  1.47s/it] 14%|█▎        | 345/2552 [16:34<53:22,  1.45s/it] 14%|█▎        | 346/2552 [16:36<52:41,  1.43s/it] 14%|█▎        | 347/2552 [16:37<51:23,  1.40s/it] 14%|█▎        | 348/2552 [16:38<53:20,  1.45s/it] 14%|█▎        | 349/2552 [16:40<52:43,  1.44s/it] 14%|█▎        | 350/2552 [16:41<52:00,  1.42s/it]                                                  {'loss': 0.5178, 'grad_norm': 9.413602828979492, 'learning_rate': 4.3142633228840126e-05, 'rewards/chosen': 0.22787824273109436, 'rewards/rejected': -1.2264007329940796, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.4542789459228516, 'logps/rejected': -37.33561325073242, 'logps/chosen': -14.484049797058105, 'logits/rejected': -0.628939151763916, 'logits/chosen': -0.6172710061073303, 'epoch': 0.14}
 14%|█▎        | 350/2552 [16:41<52:00,  1.42s/it] 14%|█▍        | 351/2552 [16:43<53:51,  1.47s/it] 14%|█▍        | 352/2552 [16:44<52:28,  1.43s/it] 14%|█▍        | 353/2552 [16:46<53:47,  1.47s/it] 14%|█▍        | 354/2552 [16:47<53:11,  1.45s/it] 14%|█▍        | 355/2552 [16:48<51:41,  1.41s/it] 14%|█▍        | 356/2552 [16:50<51:55,  1.42s/it] 14%|█▍        | 357/2552 [16:52<53:51,  1.47s/it] 14%|█▍        | 358/2552 [16:53<54:48,  1.50s/it] 14%|█▍        | 359/2552 [16:55<56:56,  1.56s/it] 14%|█▍        | 360/2552 [16:56<54:20,  1.49s/it]                                                  {'loss': 0.5641, 'grad_norm': 8.564186096191406, 'learning_rate': 4.294670846394985e-05, 'rewards/chosen': -1.3980319499969482, 'rewards/rejected': -1.8352552652359009, 'rewards/accuracies': 0.5, 'rewards/margins': 0.4372231960296631, 'logps/rejected': -73.20568084716797, 'logps/chosen': -63.7000732421875, 'logits/rejected': -0.6462243795394897, 'logits/chosen': -0.6137879490852356, 'epoch': 0.14}
 14%|█▍        | 360/2552 [16:56<54:20,  1.49s/it] 14%|█▍        | 361/2552 [16:58<54:48,  1.50s/it] 14%|█▍        | 362/2552 [16:59<53:35,  1.47s/it] 14%|█▍        | 363/2552 [17:01<54:31,  1.49s/it] 14%|█▍        | 364/2552 [17:02<54:42,  1.50s/it] 14%|█▍        | 365/2552 [17:04<53:43,  1.47s/it] 14%|█▍        | 366/2552 [17:05<51:04,  1.40s/it] 14%|█▍        | 367/2552 [17:06<50:38,  1.39s/it] 14%|█▍        | 368/2552 [17:08<52:36,  1.45s/it] 14%|█▍        | 369/2552 [17:09<51:23,  1.41s/it] 14%|█▍        | 370/2552 [17:10<51:05,  1.41s/it]                                                  {'loss': 0.5548, 'grad_norm': 9.945718765258789, 'learning_rate': 4.275078369905957e-05, 'rewards/chosen': -1.1928863525390625, 'rewards/rejected': -1.4048960208892822, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.2120097577571869, 'logps/rejected': -62.053253173828125, 'logps/chosen': -74.5783462524414, 'logits/rejected': -0.5646829605102539, 'logits/chosen': -0.6117947101593018, 'epoch': 0.14}
 14%|█▍        | 370/2552 [17:10<51:05,  1.41s/it] 15%|█▍        | 371/2552 [17:12<53:18,  1.47s/it] 15%|█▍        | 372/2552 [17:14<56:13,  1.55s/it] 15%|█▍        | 373/2552 [17:15<55:50,  1.54s/it] 15%|█▍        | 374/2552 [17:17<55:11,  1.52s/it] 15%|█▍        | 375/2552 [17:18<52:43,  1.45s/it] 15%|█▍        | 376/2552 [17:19<51:21,  1.42s/it] 15%|█▍        | 377/2552 [17:21<52:46,  1.46s/it] 15%|█▍        | 378/2552 [17:22<53:11,  1.47s/it] 15%|█▍        | 379/2552 [17:24<55:36,  1.54s/it] 15%|█▍        | 380/2552 [17:25<53:44,  1.48s/it]                                                  {'loss': 0.6598, 'grad_norm': 17.26114273071289, 'learning_rate': 4.255485893416928e-05, 'rewards/chosen': -1.0628252029418945, 'rewards/rejected': -1.4259132146835327, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.36308813095092773, 'logps/rejected': -50.42503356933594, 'logps/chosen': -78.2469482421875, 'logits/rejected': -0.5751944780349731, 'logits/chosen': -0.6014671921730042, 'epoch': 0.15}
 15%|█▍        | 380/2552 [17:25<53:44,  1.48s/it] 15%|█▍        | 381/2552 [17:27<55:14,  1.53s/it] 15%|█▍        | 382/2552 [17:29<55:49,  1.54s/it] 15%|█▌        | 383/2552 [17:30<55:15,  1.53s/it] 15%|█▌        | 384/2552 [17:32<54:54,  1.52s/it] 15%|█▌        | 385/2552 [17:33<55:52,  1.55s/it] 15%|█▌        | 386/2552 [17:35<56:01,  1.55s/it] 15%|█▌        | 387/2552 [17:37<57:24,  1.59s/it] 15%|█▌        | 388/2552 [17:38<56:46,  1.57s/it] 15%|█▌        | 389/2552 [17:40<55:54,  1.55s/it] 15%|█▌        | 390/2552 [17:41<54:38,  1.52s/it]                                                  {'loss': 0.5958, 'grad_norm': 5.707217216491699, 'learning_rate': 4.2358934169279e-05, 'rewards/chosen': -0.5379305481910706, 'rewards/rejected': -1.199913501739502, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.6619828343391418, 'logps/rejected': -51.954917907714844, 'logps/chosen': -61.45609664916992, 'logits/rejected': -0.4276393949985504, 'logits/chosen': -0.439988911151886, 'epoch': 0.15}
 15%|█▌        | 390/2552 [17:41<54:38,  1.52s/it] 15%|█▌        | 391/2552 [17:42<53:13,  1.48s/it] 15%|█▌        | 392/2552 [17:44<56:30,  1.57s/it] 15%|█▌        | 393/2552 [17:46<59:20,  1.65s/it] 15%|█▌        | 394/2552 [17:48<58:50,  1.64s/it] 15%|█▌        | 395/2552 [17:49<56:30,  1.57s/it] 16%|█▌        | 396/2552 [17:50<53:16,  1.48s/it] 16%|█▌        | 397/2552 [17:52<52:38,  1.47s/it] 16%|█▌        | 398/2552 [17:53<51:51,  1.44s/it] 16%|█▌        | 399/2552 [17:55<55:17,  1.54s/it] 16%|█▌        | 400/2552 [17:56<53:24,  1.49s/it]                                                  {'loss': 0.5029, 'grad_norm': 7.654915809631348, 'learning_rate': 4.2163009404388715e-05, 'rewards/chosen': -0.40350037813186646, 'rewards/rejected': -1.3188608884811401, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 0.9153606295585632, 'logps/rejected': -37.733970642089844, 'logps/chosen': -35.99602127075195, 'logits/rejected': -0.7108713984489441, 'logits/chosen': -0.7144622802734375, 'epoch': 0.16}
 16%|█▌        | 400/2552 [17:56<53:24,  1.49s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:04,  1.16it/s][A
  4%|▍         | 3/77 [00:02<01:16,  1.03s/it][A
  5%|▌         | 4/77 [00:04<01:20,  1.10s/it][A
  6%|▋         | 5/77 [00:06<01:42,  1.42s/it][A
  8%|▊         | 6/77 [00:07<01:32,  1.30s/it][A
  9%|▉         | 7/77 [00:08<01:32,  1.32s/it][A
 10%|█         | 8/77 [00:10<01:35,  1.39s/it][A
 12%|█▏        | 9/77 [00:11<01:37,  1.43s/it][A
 13%|█▎        | 10/77 [00:12<01:27,  1.30s/it][A
 14%|█▍        | 11/77 [00:13<01:21,  1.24s/it][A
 16%|█▌        | 12/77 [00:15<01:34,  1.46s/it][A
 17%|█▋        | 13/77 [00:17<01:28,  1.39s/it][A
 18%|█▊        | 14/77 [00:18<01:22,  1.30s/it][A
 19%|█▉        | 15/77 [00:19<01:27,  1.41s/it][A
 21%|██        | 16/77 [00:20<01:15,  1.24s/it][A
 22%|██▏       | 17/77 [00:21<01:15,  1.26s/it][A
 23%|██▎       | 18/77 [00:23<01:16,  1.30s/it][A
 25%|██▍       | 19/77 [00:25<01:24,  1.45s/it][A
 26%|██▌       | 20/77 [00:25<01:12,  1.26s/it][A
 27%|██▋       | 21/77 [00:26<01:05,  1.18s/it][A
 29%|██▊       | 22/77 [00:28<01:09,  1.27s/it][A
 30%|██▉       | 23/77 [00:30<01:18,  1.46s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.42s/it][A
 32%|███▏      | 25/77 [00:32<01:12,  1.39s/it][A
 34%|███▍      | 26/77 [00:33<01:05,  1.28s/it][A
 35%|███▌      | 27/77 [00:35<01:06,  1.33s/it][A
 36%|███▋      | 28/77 [00:36<01:02,  1.27s/it][A
 38%|███▊      | 29/77 [00:38<01:07,  1.41s/it][A
 39%|███▉      | 30/77 [00:40<01:11,  1.52s/it][A
 40%|████      | 31/77 [00:41<01:11,  1.55s/it][A
 42%|████▏     | 32/77 [00:43<01:09,  1.55s/it][A
 43%|████▎     | 33/77 [00:44<01:07,  1.54s/it][A
 44%|████▍     | 34/77 [00:46<01:06,  1.54s/it][A
 45%|████▌     | 35/77 [00:47<01:03,  1.50s/it][A
 47%|████▋     | 36/77 [00:49<01:03,  1.56s/it][A
 48%|████▊     | 37/77 [00:50<00:57,  1.44s/it][A
 49%|████▉     | 38/77 [00:51<00:52,  1.35s/it][A
 51%|█████     | 39/77 [00:53<00:57,  1.51s/it][A
 52%|█████▏    | 40/77 [00:55<00:57,  1.54s/it][A
 53%|█████▎    | 41/77 [00:56<00:50,  1.39s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.42s/it][A
 56%|█████▌    | 43/77 [00:59<00:52,  1.54s/it][A
 57%|█████▋    | 44/77 [01:00<00:46,  1.41s/it][A
 58%|█████▊    | 45/77 [01:01<00:40,  1.28s/it][A
 60%|█████▉    | 46/77 [01:03<00:40,  1.31s/it][A
 61%|██████    | 47/77 [01:04<00:38,  1.28s/it][A
 62%|██████▏   | 48/77 [01:05<00:40,  1.38s/it][A
 64%|██████▎   | 49/77 [01:07<00:40,  1.43s/it][A
 65%|██████▍   | 50/77 [01:08<00:38,  1.41s/it][A
 66%|██████▌   | 51/77 [01:10<00:39,  1.53s/it][A
 68%|██████▊   | 52/77 [01:12<00:38,  1.52s/it][A
 69%|██████▉   | 53/77 [01:13<00:39,  1.63s/it][A
 70%|███████   | 54/77 [01:15<00:35,  1.54s/it][A
 71%|███████▏  | 55/77 [01:16<00:31,  1.44s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.70s/it][A
 74%|███████▍  | 57/77 [01:20<00:31,  1.58s/it][A
 75%|███████▌  | 58/77 [01:21<00:30,  1.60s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.59s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.43s/it][A
 79%|███████▉  | 61/77 [01:26<00:23,  1.49s/it][A
 81%|████████  | 62/77 [01:27<00:21,  1.46s/it][A
 82%|████████▏ | 63/77 [01:29<00:21,  1.53s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.42s/it][A
 84%|████████▍ | 65/77 [01:31<00:16,  1.41s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.56s/it][A
 87%|████████▋ | 67/77 [01:34<00:12,  1.29s/it][A
 88%|████████▊ | 68/77 [01:36<00:13,  1.46s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.45s/it][A
 91%|█████████ | 70/77 [01:38<00:09,  1.38s/it][A
 92%|█████████▏| 71/77 [01:39<00:07,  1.28s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.33s/it][A
 95%|█████████▍| 73/77 [01:42<00:05,  1.43s/it][A
 96%|█████████▌| 74/77 [01:44<00:04,  1.60s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.55s/it][A
 99%|█████████▊| 76/77 [01:47<00:01,  1.49s/it][A
100%|██████████| 77/77 [01:49<00:00,  1.54s/it][A                                                  
                                               [A{'eval_loss': 0.5550153255462646, 'eval_runtime': 110.7044, 'eval_samples_per_second': 11.038, 'eval_steps_per_second': 0.696, 'eval_rewards/chosen': -0.4278170168399811, 'eval_rewards/rejected': -1.1934350728988647, 'eval_rewards/accuracies': 0.7532467246055603, 'eval_rewards/margins': 0.765618085861206, 'eval_logps/rejected': -51.18749237060547, 'eval_logps/chosen': -42.78702926635742, 'eval_logits/rejected': -0.48343801498413086, 'eval_logits/chosen': -0.48438024520874023, 'epoch': 0.16}
 16%|█▌        | 400/2552 [19:47<53:24,  1.49s/it]
100%|██████████| 77/77 [01:49<00:00,  1.54s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 16%|█▌        | 401/2552 [20:15<25:33:48, 42.78s/it] 16%|█▌        | 402/2552 [20:17<18:09:03, 30.39s/it] 16%|█▌        | 403/2552 [20:19<13:00:47, 21.80s/it] 16%|█▌        | 404/2552 [20:20<9:25:38, 15.80s/it]  16%|█▌        | 405/2552 [20:22<6:52:11, 11.52s/it] 16%|█▌        | 406/2552 [20:23<5:03:38,  8.49s/it] 16%|█▌        | 407/2552 [20:25<3:47:19,  6.36s/it] 16%|█▌        | 408/2552 [20:26<2:54:48,  4.89s/it] 16%|█▌        | 409/2552 [20:28<2:18:12,  3.87s/it] 16%|█▌        | 410/2552 [20:29<1:52:47,  3.16s/it]                                                    {'loss': 0.6714, 'grad_norm': 9.240066528320312, 'learning_rate': 4.196708463949843e-05, 'rewards/chosen': -0.6054352521896362, 'rewards/rejected': -1.0258595943450928, 'rewards/accuracies': 0.5, 'rewards/margins': 0.4204244613647461, 'logps/rejected': -60.84816360473633, 'logps/chosen': -37.855342864990234, 'logits/rejected': -0.5892080068588257, 'logits/chosen': -0.5522381067276001, 'epoch': 0.16}
 16%|█▌        | 410/2552 [20:29<1:52:47,  3.16s/it] 16%|█▌        | 411/2552 [20:31<1:33:07,  2.61s/it] 16%|█▌        | 412/2552 [20:32<1:22:24,  2.31s/it] 16%|█▌        | 413/2552 [20:34<1:15:39,  2.12s/it] 16%|█▌        | 414/2552 [20:35<1:09:18,  1.95s/it] 16%|█▋        | 415/2552 [20:37<1:05:07,  1.83s/it] 16%|█▋        | 416/2552 [20:38<59:09,  1.66s/it]   16%|█▋        | 417/2552 [20:40<58:41,  1.65s/it] 16%|█▋        | 418/2552 [20:41<55:58,  1.57s/it] 16%|█▋        | 419/2552 [20:43<58:46,  1.65s/it] 16%|█▋        | 420/2552 [20:44<55:23,  1.56s/it]                                                  {'loss': 0.4781, 'grad_norm': 7.068098068237305, 'learning_rate': 4.177115987460815e-05, 'rewards/chosen': -0.33929210901260376, 'rewards/rejected': -1.3534488677978516, 'rewards/accuracies': 1.0, 'rewards/margins': 1.014156699180603, 'logps/rejected': -66.4021224975586, 'logps/chosen': -33.49055099487305, 'logits/rejected': -0.6012259721755981, 'logits/chosen': -0.5661693811416626, 'epoch': 0.16}
 16%|█▋        | 420/2552 [20:44<55:23,  1.56s/it] 16%|█▋        | 421/2552 [20:46<55:14,  1.56s/it] 17%|█▋        | 422/2552 [20:47<54:30,  1.54s/it] 17%|█▋        | 423/2552 [20:49<56:00,  1.58s/it] 17%|█▋        | 424/2552 [20:51<54:47,  1.54s/it] 17%|█▋        | 425/2552 [20:52<52:49,  1.49s/it] 17%|█▋        | 426/2552 [20:53<53:25,  1.51s/it] 17%|█▋        | 427/2552 [20:55<53:55,  1.52s/it] 17%|█▋        | 428/2552 [20:56<52:00,  1.47s/it] 17%|█▋        | 429/2552 [20:58<53:30,  1.51s/it] 17%|█▋        | 430/2552 [21:00<54:39,  1.55s/it]                                                  {'loss': 0.5206, 'grad_norm': 5.0341267585754395, 'learning_rate': 4.157523510971787e-05, 'rewards/chosen': -0.1950812041759491, 'rewards/rejected': -1.3199368715286255, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.1248555183410645, 'logps/rejected': -42.16200637817383, 'logps/chosen': -54.43061065673828, 'logits/rejected': -0.6339172720909119, 'logits/chosen': -0.6442738771438599, 'epoch': 0.17}
 17%|█▋        | 430/2552 [21:00<54:39,  1.55s/it] 17%|█▋        | 431/2552 [21:01<55:30,  1.57s/it] 17%|█▋        | 432/2552 [21:03<52:44,  1.49s/it] 17%|█▋        | 433/2552 [21:04<51:46,  1.47s/it] 17%|█▋        | 434/2552 [21:06<53:55,  1.53s/it] 17%|█▋        | 435/2552 [21:07<56:42,  1.61s/it] 17%|█▋        | 436/2552 [21:09<54:01,  1.53s/it] 17%|█▋        | 437/2552 [21:10<51:51,  1.47s/it] 17%|█▋        | 438/2552 [21:12<51:17,  1.46s/it] 17%|█▋        | 439/2552 [21:13<51:21,  1.46s/it] 17%|█▋        | 440/2552 [21:15<52:15,  1.48s/it]                                                  {'loss': 0.4691, 'grad_norm': 10.539104461669922, 'learning_rate': 4.1379310344827587e-05, 'rewards/chosen': -0.049569763243198395, 'rewards/rejected': -0.9666755795478821, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.9171058535575867, 'logps/rejected': -34.495174407958984, 'logps/chosen': -36.258365631103516, 'logits/rejected': -0.47266578674316406, 'logits/chosen': -0.4602736830711365, 'epoch': 0.17}
 17%|█▋        | 440/2552 [21:15<52:15,  1.48s/it] 17%|█▋        | 441/2552 [21:16<55:13,  1.57s/it] 17%|█▋        | 442/2552 [21:18<56:46,  1.61s/it] 17%|█▋        | 443/2552 [21:19<54:04,  1.54s/it] 17%|█▋        | 444/2552 [21:21<52:39,  1.50s/it] 17%|█▋        | 445/2552 [21:22<52:11,  1.49s/it] 17%|█▋        | 446/2552 [21:24<54:27,  1.55s/it] 18%|█▊        | 447/2552 [21:26<54:26,  1.55s/it] 18%|█▊        | 448/2552 [21:27<51:49,  1.48s/it] 18%|█▊        | 449/2552 [21:28<51:56,  1.48s/it] 18%|█▊        | 450/2552 [21:30<52:26,  1.50s/it]                                                  {'loss': 0.5705, 'grad_norm': 7.873030662536621, 'learning_rate': 4.1183385579937304e-05, 'rewards/chosen': -0.48140662908554077, 'rewards/rejected': -1.8889261484146118, 'rewards/accuracies': 1.0, 'rewards/margins': 1.4075194597244263, 'logps/rejected': -69.1809310913086, 'logps/chosen': -50.64116668701172, 'logits/rejected': -0.5171284675598145, 'logits/chosen': -0.5282866358757019, 'epoch': 0.18}
 18%|█▊        | 450/2552 [21:30<52:26,  1.50s/it] 18%|█▊        | 451/2552 [21:32<56:13,  1.61s/it] 18%|█▊        | 452/2552 [21:33<56:03,  1.60s/it] 18%|█▊        | 453/2552 [21:35<58:20,  1.67s/it] 18%|█▊        | 454/2552 [21:36<53:37,  1.53s/it] 18%|█▊        | 455/2552 [21:38<52:54,  1.51s/it] 18%|█▊        | 456/2552 [21:39<54:24,  1.56s/it] 18%|█▊        | 457/2552 [21:41<53:29,  1.53s/it] 18%|█▊        | 458/2552 [21:42<52:19,  1.50s/it] 18%|█▊        | 459/2552 [21:44<55:43,  1.60s/it] 18%|█▊        | 460/2552 [21:46<56:22,  1.62s/it]                                                  {'loss': 0.5675, 'grad_norm': 14.45653247833252, 'learning_rate': 4.098746081504702e-05, 'rewards/chosen': -0.5287227630615234, 'rewards/rejected': -1.2355269193649292, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.7068041563034058, 'logps/rejected': -43.821510314941406, 'logps/chosen': -36.85236358642578, 'logits/rejected': -0.5882250070571899, 'logits/chosen': -0.5623499155044556, 'epoch': 0.18}
 18%|█▊        | 460/2552 [21:46<56:22,  1.62s/it] 18%|█▊        | 461/2552 [21:47<55:31,  1.59s/it] 18%|█▊        | 462/2552 [21:49<51:55,  1.49s/it] 18%|█▊        | 463/2552 [21:50<52:03,  1.50s/it] 18%|█▊        | 464/2552 [21:52<55:08,  1.58s/it] 18%|█▊        | 465/2552 [21:53<53:28,  1.54s/it] 18%|█▊        | 466/2552 [21:55<55:12,  1.59s/it] 18%|█▊        | 467/2552 [21:56<51:54,  1.49s/it] 18%|█▊        | 468/2552 [21:58<52:13,  1.50s/it] 18%|█▊        | 469/2552 [21:59<53:11,  1.53s/it] 18%|█▊        | 470/2552 [22:01<53:22,  1.54s/it]                                                  {'loss': 0.6856, 'grad_norm': 11.406743049621582, 'learning_rate': 4.079153605015674e-05, 'rewards/chosen': -0.8072129487991333, 'rewards/rejected': -0.9952825307846069, 'rewards/accuracies': 0.5, 'rewards/margins': 0.18806956708431244, 'logps/rejected': -59.58516311645508, 'logps/chosen': -37.240684509277344, 'logits/rejected': -0.5117230415344238, 'logits/chosen': -0.5090540647506714, 'epoch': 0.18}
 18%|█▊        | 470/2552 [22:01<53:22,  1.54s/it] 18%|█▊        | 471/2552 [22:02<52:08,  1.50s/it] 18%|█▊        | 472/2552 [22:04<50:53,  1.47s/it] 19%|█▊        | 473/2552 [22:05<52:17,  1.51s/it] 19%|█▊        | 474/2552 [22:07<54:14,  1.57s/it] 19%|█▊        | 475/2552 [22:09<54:31,  1.58s/it] 19%|█▊        | 476/2552 [22:10<54:05,  1.56s/it] 19%|█▊        | 477/2552 [22:12<56:53,  1.65s/it] 19%|█▊        | 478/2552 [22:13<52:55,  1.53s/it] 19%|█▉        | 479/2552 [22:15<51:53,  1.50s/it] 19%|█▉        | 480/2552 [22:16<51:16,  1.48s/it]                                                  {'loss': 0.5746, 'grad_norm': 7.021359443664551, 'learning_rate': 4.059561128526646e-05, 'rewards/chosen': -0.8454686999320984, 'rewards/rejected': -1.2259423732757568, 'rewards/accuracies': 0.5, 'rewards/margins': 0.3804737627506256, 'logps/rejected': -65.27239990234375, 'logps/chosen': -60.9265251159668, 'logits/rejected': -0.6586469411849976, 'logits/chosen': -0.6525015830993652, 'epoch': 0.19}
 19%|█▉        | 480/2552 [22:16<51:16,  1.48s/it] 19%|█▉        | 481/2552 [22:18<50:34,  1.47s/it] 19%|█▉        | 482/2552 [22:19<50:12,  1.46s/it] 19%|█▉        | 483/2552 [22:20<48:37,  1.41s/it] 19%|█▉        | 484/2552 [22:22<47:56,  1.39s/it] 19%|█▉        | 485/2552 [22:23<48:19,  1.40s/it] 19%|█▉        | 486/2552 [22:25<49:18,  1.43s/it] 19%|█▉        | 487/2552 [22:27<53:19,  1.55s/it] 19%|█▉        | 488/2552 [22:28<53:35,  1.56s/it] 19%|█▉        | 489/2552 [22:30<53:55,  1.57s/it] 19%|█▉        | 490/2552 [22:31<51:54,  1.51s/it]                                                  {'loss': 0.5857, 'grad_norm': 18.9642391204834, 'learning_rate': 4.0399686520376176e-05, 'rewards/chosen': -0.6323472261428833, 'rewards/rejected': -2.0196692943573, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.387322187423706, 'logps/rejected': -56.252288818359375, 'logps/chosen': -59.3348274230957, 'logits/rejected': -0.45994067192077637, 'logits/chosen': -0.5030800700187683, 'epoch': 0.19}
 19%|█▉        | 490/2552 [22:31<51:54,  1.51s/it] 19%|█▉        | 491/2552 [22:33<54:30,  1.59s/it] 19%|█▉        | 492/2552 [22:34<55:20,  1.61s/it] 19%|█▉        | 493/2552 [22:36<55:03,  1.60s/it] 19%|█▉        | 494/2552 [22:38<54:47,  1.60s/it] 19%|█▉        | 495/2552 [22:39<55:25,  1.62s/it] 19%|█▉        | 496/2552 [22:41<54:28,  1.59s/it] 19%|█▉        | 497/2552 [22:42<52:36,  1.54s/it] 20%|█▉        | 498/2552 [22:44<50:10,  1.47s/it] 20%|█▉        | 499/2552 [22:45<50:36,  1.48s/it] 20%|█▉        | 500/2552 [22:46<49:46,  1.46s/it]                                                  {'loss': 0.4712, 'grad_norm': 5.122387409210205, 'learning_rate': 4.02037617554859e-05, 'rewards/chosen': -0.9572387933731079, 'rewards/rejected': -1.7784888744354248, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.8212504386901855, 'logps/rejected': -63.94008255004883, 'logps/chosen': -50.43044662475586, 'logits/rejected': -0.6431564092636108, 'logits/chosen': -0.663739800453186, 'epoch': 0.2}
 20%|█▉        | 500/2552 [22:47<49:46,  1.46s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:05,  1.15it/s][A
  4%|▍         | 3/77 [00:02<01:15,  1.02s/it][A
  5%|▌         | 4/77 [00:04<01:20,  1.11s/it][A
  6%|▋         | 5/77 [00:06<01:41,  1.41s/it][A
  8%|▊         | 6/77 [00:07<01:31,  1.29s/it][A
  9%|▉         | 7/77 [00:08<01:31,  1.31s/it][A
 10%|█         | 8/77 [00:10<01:33,  1.36s/it][A
 12%|█▏        | 9/77 [00:11<01:37,  1.43s/it][A
 13%|█▎        | 10/77 [00:12<01:27,  1.31s/it][A
 14%|█▍        | 11/77 [00:13<01:20,  1.23s/it][A
 16%|█▌        | 12/77 [00:15<01:34,  1.46s/it][A
 17%|█▋        | 13/77 [00:16<01:27,  1.37s/it][A
 18%|█▊        | 14/77 [00:18<01:22,  1.31s/it][A
 19%|█▉        | 15/77 [00:19<01:28,  1.43s/it][A
 21%|██        | 16/77 [00:20<01:16,  1.25s/it][A
 22%|██▏       | 17/77 [00:22<01:19,  1.33s/it][A
 23%|██▎       | 18/77 [00:23<01:15,  1.28s/it][A
 25%|██▍       | 19/77 [00:25<01:23,  1.44s/it][A
 26%|██▌       | 20/77 [00:25<01:11,  1.25s/it][A
 27%|██▋       | 21/77 [00:26<01:07,  1.20s/it][A
 29%|██▊       | 22/77 [00:28<01:09,  1.27s/it][A
 30%|██▉       | 23/77 [00:30<01:19,  1.46s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.42s/it][A
 32%|███▏      | 25/77 [00:32<01:11,  1.38s/it][A
 34%|███▍      | 26/77 [00:33<01:04,  1.27s/it][A
 35%|███▌      | 27/77 [00:35<01:06,  1.32s/it][A
 36%|███▋      | 28/77 [00:36<01:01,  1.26s/it][A
 38%|███▊      | 29/77 [00:38<01:07,  1.42s/it][A
 39%|███▉      | 30/77 [00:40<01:11,  1.52s/it][A
 40%|████      | 31/77 [00:41<01:11,  1.55s/it][A
 42%|████▏     | 32/77 [00:43<01:09,  1.56s/it][A
 43%|████▎     | 33/77 [00:44<01:06,  1.52s/it][A
 44%|████▍     | 34/77 [00:46<01:05,  1.52s/it][A
 45%|████▌     | 35/77 [00:47<01:02,  1.49s/it][A
 47%|████▋     | 36/77 [00:49<01:03,  1.56s/it][A
 48%|████▊     | 37/77 [00:50<00:57,  1.44s/it][A
 49%|████▉     | 38/77 [00:51<00:52,  1.34s/it][A
 51%|█████     | 39/77 [00:53<00:57,  1.51s/it][A
 52%|█████▏    | 40/77 [00:55<00:57,  1.55s/it][A
 53%|█████▎    | 41/77 [00:56<00:50,  1.40s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.42s/it][A
 56%|█████▌    | 43/77 [00:59<00:52,  1.54s/it][A
 57%|█████▋    | 44/77 [01:00<00:46,  1.41s/it][A
 58%|█████▊    | 45/77 [01:01<00:40,  1.28s/it][A
 60%|█████▉    | 46/77 [01:02<00:40,  1.29s/it][A
 61%|██████    | 47/77 [01:04<00:37,  1.26s/it][A
 62%|██████▏   | 48/77 [01:05<00:39,  1.37s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.40s/it][A
 65%|██████▍   | 50/77 [01:08<00:38,  1.43s/it][A
 66%|██████▌   | 51/77 [01:10<00:40,  1.55s/it][A
 68%|██████▊   | 52/77 [01:12<00:38,  1.54s/it][A
 69%|██████▉   | 53/77 [01:13<00:39,  1.63s/it][A
 70%|███████   | 54/77 [01:15<00:35,  1.52s/it][A
 71%|███████▏  | 55/77 [01:16<00:31,  1.44s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.67s/it][A
 74%|███████▍  | 57/77 [01:19<00:31,  1.56s/it][A
 75%|███████▌  | 58/77 [01:21<00:30,  1.59s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.58s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.42s/it][A
 79%|███████▉  | 61/77 [01:25<00:23,  1.49s/it][A
 81%|████████  | 62/77 [01:27<00:21,  1.46s/it][A
 82%|████████▏ | 63/77 [01:28<00:21,  1.52s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.41s/it][A
 84%|████████▍ | 65/77 [01:31<00:16,  1.41s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.57s/it][A
 87%|████████▋ | 67/77 [01:34<00:13,  1.30s/it][A
 88%|████████▊ | 68/77 [01:35<00:13,  1.47s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.45s/it][A
 91%|█████████ | 70/77 [01:38<00:09,  1.38s/it][A
 92%|█████████▏| 71/77 [01:39<00:07,  1.29s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.33s/it][A
 95%|█████████▍| 73/77 [01:42<00:05,  1.43s/it][A
 96%|█████████▌| 74/77 [01:44<00:04,  1.59s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.53s/it][A
 99%|█████████▊| 76/77 [01:47<00:01,  1.47s/it][A
100%|██████████| 77/77 [01:49<00:00,  1.53s/it][A                                                  
                                               [A{'eval_loss': 0.5619506239891052, 'eval_runtime': 110.3515, 'eval_samples_per_second': 11.074, 'eval_steps_per_second': 0.698, 'eval_rewards/chosen': -0.5638188123703003, 'eval_rewards/rejected': -1.5104886293411255, 'eval_rewards/accuracies': 0.7727272510528564, 'eval_rewards/margins': 0.9466698169708252, 'eval_logps/rejected': -54.3580322265625, 'eval_logps/chosen': -44.14704513549805, 'eval_logits/rejected': -0.4496077001094818, 'eval_logits/chosen': -0.4514636695384979, 'epoch': 0.2}
 20%|█▉        | 500/2552 [24:37<49:46,  1.46s/it]
100%|██████████| 77/77 [01:49<00:00,  1.53s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 20%|█▉        | 501/2552 [25:05<24:17:07, 42.63s/it] 20%|█▉        | 502/2552 [25:06<17:13:15, 30.24s/it] 20%|█▉        | 503/2552 [25:08<12:17:40, 21.60s/it] 20%|█▉        | 504/2552 [25:10<8:52:11, 15.59s/it]  20%|█▉        | 505/2552 [25:11<6:26:44, 11.34s/it] 20%|█▉        | 506/2552 [25:12<4:44:11,  8.33s/it] 20%|█▉        | 507/2552 [25:14<3:33:36,  6.27s/it] 20%|█▉        | 508/2552 [25:15<2:44:42,  4.83s/it] 20%|█▉        | 509/2552 [25:17<2:09:23,  3.80s/it] 20%|█▉        | 510/2552 [25:18<1:45:43,  3.11s/it]                                                    {'loss': 0.6028, 'grad_norm': 17.154754638671875, 'learning_rate': 4.000783699059562e-05, 'rewards/chosen': -0.4262324869632721, 'rewards/rejected': -1.3480812311172485, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.9218486547470093, 'logps/rejected': -70.54515075683594, 'logps/chosen': -53.1668701171875, 'logits/rejected': -0.6733278632164001, 'logits/chosen': -0.6657716035842896, 'epoch': 0.2}
 20%|█▉        | 510/2552 [25:18<1:45:43,  3.11s/it] 20%|██        | 511/2552 [25:19<1:28:32,  2.60s/it] 20%|██        | 512/2552 [25:21<1:17:59,  2.29s/it] 20%|██        | 513/2552 [25:23<1:11:11,  2.09s/it] 20%|██        | 514/2552 [25:24<1:05:36,  1.93s/it] 20%|██        | 515/2552 [25:25<58:26,  1.72s/it]   20%|██        | 516/2552 [25:27<54:21,  1.60s/it] 20%|██        | 517/2552 [25:28<53:09,  1.57s/it] 20%|██        | 518/2552 [25:30<53:23,  1.57s/it] 20%|██        | 519/2552 [25:31<51:12,  1.51s/it] 20%|██        | 520/2552 [25:33<49:08,  1.45s/it]                                                  {'loss': 0.6654, 'grad_norm': 9.65340805053711, 'learning_rate': 3.9811912225705336e-05, 'rewards/chosen': -0.7815369963645935, 'rewards/rejected': -0.854345440864563, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.0728083997964859, 'logps/rejected': -38.458194732666016, 'logps/chosen': -40.96300506591797, 'logits/rejected': -0.5245599150657654, 'logits/chosen': -0.5310729742050171, 'epoch': 0.2}
 20%|██        | 520/2552 [25:33<49:08,  1.45s/it] 20%|██        | 521/2552 [25:34<51:15,  1.51s/it] 20%|██        | 522/2552 [25:36<53:29,  1.58s/it] 20%|██        | 523/2552 [25:37<52:44,  1.56s/it] 21%|██        | 524/2552 [25:39<51:00,  1.51s/it] 21%|██        | 525/2552 [25:41<52:45,  1.56s/it] 21%|██        | 526/2552 [25:42<50:43,  1.50s/it] 21%|██        | 527/2552 [25:43<50:08,  1.49s/it] 21%|██        | 528/2552 [25:45<49:23,  1.46s/it] 21%|██        | 529/2552 [25:46<50:05,  1.49s/it] 21%|██        | 530/2552 [25:48<49:21,  1.46s/it]                                                  {'loss': 0.5864, 'grad_norm': 15.026548385620117, 'learning_rate': 3.9615987460815054e-05, 'rewards/chosen': -0.07433123886585236, 'rewards/rejected': -1.2874647378921509, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.2131335735321045, 'logps/rejected': -63.60649871826172, 'logps/chosen': -34.155921936035156, 'logits/rejected': -0.6334718465805054, 'logits/chosen': -0.6350659728050232, 'epoch': 0.21}
 21%|██        | 530/2552 [25:48<49:21,  1.46s/it] 21%|██        | 531/2552 [25:49<52:12,  1.55s/it] 21%|██        | 532/2552 [25:51<50:05,  1.49s/it] 21%|██        | 533/2552 [25:52<49:58,  1.48s/it] 21%|██        | 534/2552 [25:54<50:34,  1.50s/it] 21%|██        | 535/2552 [25:55<51:18,  1.53s/it] 21%|██        | 536/2552 [25:57<50:18,  1.50s/it] 21%|██        | 537/2552 [25:58<49:55,  1.49s/it] 21%|██        | 538/2552 [26:00<50:57,  1.52s/it] 21%|██        | 539/2552 [26:01<51:31,  1.54s/it] 21%|██        | 540/2552 [26:03<51:14,  1.53s/it]                                                  {'loss': 0.709, 'grad_norm': 10.405265808105469, 'learning_rate': 3.9420062695924765e-05, 'rewards/chosen': -0.5586957335472107, 'rewards/rejected': -0.9743126630783081, 'rewards/accuracies': 0.5, 'rewards/margins': 0.4156169891357422, 'logps/rejected': -61.44514083862305, 'logps/chosen': -42.9892463684082, 'logits/rejected': -0.6626420021057129, 'logits/chosen': -0.6174913644790649, 'epoch': 0.21}
 21%|██        | 540/2552 [26:03<51:14,  1.53s/it] 21%|██        | 541/2552 [26:05<55:13,  1.65s/it] 21%|██        | 542/2552 [26:06<51:31,  1.54s/it] 21%|██▏       | 543/2552 [26:07<48:36,  1.45s/it] 21%|██▏       | 544/2552 [26:09<48:56,  1.46s/it] 21%|██▏       | 545/2552 [26:10<49:56,  1.49s/it] 21%|██▏       | 546/2552 [26:12<49:54,  1.49s/it] 21%|██▏       | 547/2552 [26:13<49:13,  1.47s/it] 21%|██▏       | 548/2552 [26:15<47:22,  1.42s/it] 22%|██▏       | 549/2552 [26:16<45:05,  1.35s/it] 22%|██▏       | 550/2552 [26:17<45:28,  1.36s/it]                                                  {'loss': 0.593, 'grad_norm': 14.869141578674316, 'learning_rate': 3.922413793103448e-05, 'rewards/chosen': -0.47412848472595215, 'rewards/rejected': -1.0618007183074951, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.587672233581543, 'logps/rejected': -56.92559051513672, 'logps/chosen': -62.5150146484375, 'logits/rejected': -0.5849300622940063, 'logits/chosen': -0.5864987969398499, 'epoch': 0.22}
 22%|██▏       | 550/2552 [26:17<45:28,  1.36s/it] 22%|██▏       | 551/2552 [26:19<45:40,  1.37s/it] 22%|██▏       | 552/2552 [26:20<47:35,  1.43s/it] 22%|██▏       | 553/2552 [26:22<47:47,  1.43s/it] 22%|██▏       | 554/2552 [26:23<47:55,  1.44s/it] 22%|██▏       | 555/2552 [26:24<46:02,  1.38s/it] 22%|██▏       | 556/2552 [26:26<45:16,  1.36s/it] 22%|██▏       | 557/2552 [26:27<47:04,  1.42s/it] 22%|██▏       | 558/2552 [26:29<48:55,  1.47s/it] 22%|██▏       | 559/2552 [26:30<50:00,  1.51s/it] 22%|██▏       | 560/2552 [26:32<47:41,  1.44s/it]                                                  {'loss': 0.5539, 'grad_norm': 10.25602912902832, 'learning_rate': 3.90282131661442e-05, 'rewards/chosen': -0.9230642318725586, 'rewards/rejected': -1.2745780944824219, 'rewards/accuracies': 0.5, 'rewards/margins': 0.35151395201683044, 'logps/rejected': -48.13538360595703, 'logps/chosen': -38.126129150390625, 'logits/rejected': -0.5932262539863586, 'logits/chosen': -0.5807865262031555, 'epoch': 0.22}
 22%|██▏       | 560/2552 [26:32<47:41,  1.44s/it] 22%|██▏       | 561/2552 [26:33<47:21,  1.43s/it] 22%|██▏       | 562/2552 [26:35<48:50,  1.47s/it] 22%|██▏       | 563/2552 [26:36<51:16,  1.55s/it] 22%|██▏       | 564/2552 [26:38<49:19,  1.49s/it] 22%|██▏       | 565/2552 [26:39<47:13,  1.43s/it] 22%|██▏       | 566/2552 [26:40<46:06,  1.39s/it] 22%|██▏       | 567/2552 [26:42<45:16,  1.37s/it] 22%|██▏       | 568/2552 [26:43<45:05,  1.36s/it] 22%|██▏       | 569/2552 [26:44<44:10,  1.34s/it] 22%|██▏       | 570/2552 [26:46<44:21,  1.34s/it]                                                  {'loss': 0.5148, 'grad_norm': 13.497467994689941, 'learning_rate': 3.883228840125392e-05, 'rewards/chosen': -0.07758573442697525, 'rewards/rejected': -1.149234652519226, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.0716488361358643, 'logps/rejected': -55.5806770324707, 'logps/chosen': -38.735618591308594, 'logits/rejected': -0.6279177665710449, 'logits/chosen': -0.6321408748626709, 'epoch': 0.22}
 22%|██▏       | 570/2552 [26:46<44:21,  1.34s/it] 22%|██▏       | 571/2552 [26:47<45:27,  1.38s/it] 22%|██▏       | 572/2552 [26:48<44:56,  1.36s/it] 22%|██▏       | 573/2552 [26:50<48:03,  1.46s/it] 22%|██▏       | 574/2552 [26:51<46:01,  1.40s/it] 23%|██▎       | 575/2552 [26:53<45:58,  1.40s/it] 23%|██▎       | 576/2552 [26:55<50:28,  1.53s/it] 23%|██▎       | 577/2552 [26:56<50:52,  1.55s/it] 23%|██▎       | 578/2552 [26:58<51:31,  1.57s/it] 23%|██▎       | 579/2552 [26:59<49:13,  1.50s/it] 23%|██▎       | 580/2552 [27:01<50:48,  1.55s/it]                                                  {'loss': 0.5442, 'grad_norm': 3.6135714054107666, 'learning_rate': 3.8636363636363636e-05, 'rewards/chosen': -0.36442792415618896, 'rewards/rejected': -0.9824637174606323, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.6180359125137329, 'logps/rejected': -45.84699630737305, 'logps/chosen': -53.42222213745117, 'logits/rejected': -0.5535298585891724, 'logits/chosen': -0.5458746552467346, 'epoch': 0.23}
 23%|██▎       | 580/2552 [27:01<50:48,  1.55s/it] 23%|██▎       | 581/2552 [27:02<51:33,  1.57s/it] 23%|██▎       | 582/2552 [27:04<52:08,  1.59s/it] 23%|██▎       | 583/2552 [27:05<49:59,  1.52s/it] 23%|██▎       | 584/2552 [27:07<48:24,  1.48s/it] 23%|██▎       | 585/2552 [27:08<46:54,  1.43s/it] 23%|██▎       | 586/2552 [27:10<48:06,  1.47s/it] 23%|██▎       | 587/2552 [27:11<49:51,  1.52s/it] 23%|██▎       | 588/2552 [27:13<47:32,  1.45s/it] 23%|██▎       | 589/2552 [27:14<47:11,  1.44s/it] 23%|██▎       | 590/2552 [27:16<47:55,  1.47s/it]                                                  {'loss': 0.6349, 'grad_norm': 6.555203437805176, 'learning_rate': 3.8440438871473354e-05, 'rewards/chosen': -0.9422911405563354, 'rewards/rejected': -1.1030099391937256, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.16071882843971252, 'logps/rejected': -64.17945098876953, 'logps/chosen': -70.27046203613281, 'logits/rejected': -0.6836287975311279, 'logits/chosen': -0.6941161155700684, 'epoch': 0.23}
 23%|██▎       | 590/2552 [27:16<47:55,  1.47s/it] 23%|██▎       | 591/2552 [27:17<47:19,  1.45s/it] 23%|██▎       | 592/2552 [27:18<46:57,  1.44s/it] 23%|██▎       | 593/2552 [27:20<45:33,  1.40s/it] 23%|██▎       | 594/2552 [27:21<46:13,  1.42s/it] 23%|██▎       | 595/2552 [27:23<47:22,  1.45s/it] 23%|██▎       | 596/2552 [27:24<46:38,  1.43s/it] 23%|██▎       | 597/2552 [27:25<45:23,  1.39s/it] 23%|██▎       | 598/2552 [27:27<48:18,  1.48s/it] 23%|██▎       | 599/2552 [27:28<46:38,  1.43s/it] 24%|██▎       | 600/2552 [27:30<45:38,  1.40s/it]                                                  {'loss': 0.5499, 'grad_norm': 8.799647331237793, 'learning_rate': 3.824451410658307e-05, 'rewards/chosen': -0.7377669215202332, 'rewards/rejected': -1.3605940341949463, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.6228271722793579, 'logps/rejected': -67.5460433959961, 'logps/chosen': -69.63386535644531, 'logits/rejected': -0.4911971688270569, 'logits/chosen': -0.48147493600845337, 'epoch': 0.24}
 24%|██▎       | 600/2552 [27:30<45:38,  1.40s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:04,  1.17it/s][A
  4%|▍         | 3/77 [00:02<01:16,  1.03s/it][A
  5%|▌         | 4/77 [00:04<01:21,  1.12s/it][A
  6%|▋         | 5/77 [00:06<01:42,  1.43s/it][A
  8%|▊         | 6/77 [00:07<01:31,  1.29s/it][A
  9%|▉         | 7/77 [00:08<01:32,  1.33s/it][A
 10%|█         | 8/77 [00:10<01:34,  1.37s/it][A
 12%|█▏        | 9/77 [00:11<01:37,  1.43s/it][A
 13%|█▎        | 10/77 [00:12<01:28,  1.32s/it][A
 14%|█▍        | 11/77 [00:13<01:21,  1.24s/it][A
 16%|█▌        | 12/77 [00:15<01:34,  1.45s/it][A
 17%|█▋        | 13/77 [00:16<01:27,  1.36s/it][A
 18%|█▊        | 14/77 [00:18<01:22,  1.31s/it][A
 19%|█▉        | 15/77 [00:19<01:28,  1.42s/it][A
 21%|██        | 16/77 [00:20<01:15,  1.24s/it][A
 22%|██▏       | 17/77 [00:21<01:15,  1.27s/it][A
 23%|██▎       | 18/77 [00:23<01:16,  1.30s/it][A
 25%|██▍       | 19/77 [00:25<01:25,  1.47s/it][A
 26%|██▌       | 20/77 [00:25<01:12,  1.27s/it][A
 27%|██▋       | 21/77 [00:26<01:05,  1.18s/it][A
 29%|██▊       | 22/77 [00:28<01:11,  1.30s/it][A
 30%|██▉       | 23/77 [00:30<01:19,  1.47s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.43s/it][A
 32%|███▏      | 25/77 [00:33<01:12,  1.40s/it][A
 34%|███▍      | 26/77 [00:34<01:04,  1.27s/it][A
 35%|███▌      | 27/77 [00:35<01:06,  1.32s/it][A
 36%|███▋      | 28/77 [00:36<01:02,  1.27s/it][A
 38%|███▊      | 29/77 [00:38<01:07,  1.40s/it][A
 39%|███▉      | 30/77 [00:40<01:11,  1.52s/it][A
 40%|████      | 31/77 [00:41<01:11,  1.56s/it][A
 42%|████▏     | 32/77 [00:43<01:09,  1.55s/it][A
 43%|████▎     | 33/77 [00:44<01:07,  1.53s/it][A
 44%|████▍     | 34/77 [00:46<01:05,  1.53s/it][A
 45%|████▌     | 35/77 [00:47<01:03,  1.51s/it][A
 47%|████▋     | 36/77 [00:49<01:03,  1.56s/it][A
 48%|████▊     | 37/77 [00:50<00:57,  1.44s/it][A
 49%|████▉     | 38/77 [00:51<00:52,  1.34s/it][A
 51%|█████     | 39/77 [00:53<00:57,  1.51s/it][A
 52%|█████▏    | 40/77 [00:55<00:57,  1.55s/it][A
 53%|█████▎    | 41/77 [00:56<00:50,  1.40s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.42s/it][A
 56%|█████▌    | 43/77 [00:59<00:52,  1.55s/it][A
 57%|█████▋    | 44/77 [01:00<00:46,  1.42s/it][A
 58%|█████▊    | 45/77 [01:01<00:41,  1.28s/it][A
 60%|█████▉    | 46/77 [01:03<00:40,  1.31s/it][A
 61%|██████    | 47/77 [01:04<00:38,  1.28s/it][A
 62%|██████▏   | 48/77 [01:05<00:40,  1.39s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.40s/it][A
 65%|██████▍   | 50/77 [01:08<00:38,  1.43s/it][A
 66%|██████▌   | 51/77 [01:10<00:40,  1.55s/it][A
 68%|██████▊   | 52/77 [01:12<00:38,  1.53s/it][A
 69%|██████▉   | 53/77 [01:14<00:39,  1.64s/it][A
 70%|███████   | 54/77 [01:15<00:35,  1.53s/it][A
 71%|███████▏  | 55/77 [01:16<00:31,  1.45s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.68s/it][A
 74%|███████▍  | 57/77 [01:20<00:31,  1.58s/it][A
 75%|███████▌  | 58/77 [01:21<00:30,  1.60s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.59s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.43s/it][A
 79%|███████▉  | 61/77 [01:26<00:23,  1.49s/it][A
 81%|████████  | 62/77 [01:27<00:22,  1.48s/it][A
 82%|████████▏ | 63/77 [01:29<00:21,  1.54s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.43s/it][A
 84%|████████▍ | 65/77 [01:31<00:16,  1.41s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.56s/it][A
 87%|████████▋ | 67/77 [01:34<00:12,  1.29s/it][A
 88%|████████▊ | 68/77 [01:36<00:13,  1.47s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.44s/it][A
 91%|█████████ | 70/77 [01:38<00:09,  1.38s/it][A
 92%|█████████▏| 71/77 [01:39<00:07,  1.29s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.35s/it][A
 95%|█████████▍| 73/77 [01:43<00:05,  1.45s/it][A
 96%|█████████▌| 74/77 [01:45<00:04,  1.61s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.55s/it][A
 99%|█████████▊| 76/77 [01:47<00:01,  1.49s/it][A
100%|██████████| 77/77 [01:49<00:00,  1.53s/it][A                                                  
                                               [A{'eval_loss': 0.5389503240585327, 'eval_runtime': 110.7843, 'eval_samples_per_second': 11.03, 'eval_steps_per_second': 0.695, 'eval_rewards/chosen': -0.3959575891494751, 'eval_rewards/rejected': -1.311338186264038, 'eval_rewards/accuracies': 0.7662337422370911, 'eval_rewards/margins': 0.9153804779052734, 'eval_logps/rejected': -52.36652755737305, 'eval_logps/chosen': -42.46843719482422, 'eval_logits/rejected': -0.4363642632961273, 'eval_logits/chosen': -0.43720299005508423, 'epoch': 0.24}
 24%|██▎       | 600/2552 [29:21<45:38,  1.40s/it]
100%|██████████| 77/77 [01:49<00:00,  1.53s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 24%|██▎       | 601/2552 [29:49<23:07:08, 42.66s/it] 24%|██▎       | 602/2552 [29:50<16:27:03, 30.37s/it] 24%|██▎       | 603/2552 [29:52<11:46:19, 21.74s/it] 24%|██▎       | 604/2552 [29:53<8:27:39, 15.64s/it]  24%|██▎       | 605/2552 [29:55<6:11:23, 11.44s/it] 24%|██▎       | 606/2552 [29:57<4:35:44,  8.50s/it] 24%|██▍       | 607/2552 [29:58<3:27:11,  6.39s/it] 24%|██▍       | 608/2552 [30:00<2:39:10,  4.91s/it] 24%|██▍       | 609/2552 [30:01<2:05:46,  3.88s/it] 24%|██▍       | 610/2552 [30:03<1:43:14,  3.19s/it]                                                    {'loss': 0.626, 'grad_norm': 8.922391891479492, 'learning_rate': 3.804858934169279e-05, 'rewards/chosen': -0.978990912437439, 'rewards/rejected': -1.2239521741867065, 'rewards/accuracies': 0.4000000059604645, 'rewards/margins': 0.2449612319469452, 'logps/rejected': -66.67179107666016, 'logps/chosen': -89.09880065917969, 'logits/rejected': -0.6271323561668396, 'logits/chosen': -0.6670470237731934, 'epoch': 0.24}
 24%|██▍       | 610/2552 [30:03<1:43:14,  3.19s/it] 24%|██▍       | 611/2552 [30:04<1:25:17,  2.64s/it] 24%|██▍       | 612/2552 [30:06<1:15:30,  2.34s/it] 24%|██▍       | 613/2552 [30:07<1:08:02,  2.11s/it] 24%|██▍       | 614/2552 [30:08<1:00:40,  1.88s/it] 24%|██▍       | 615/2552 [30:10<57:45,  1.79s/it]   24%|██▍       | 616/2552 [30:12<55:15,  1.71s/it] 24%|██▍       | 617/2552 [30:13<51:24,  1.59s/it] 24%|██▍       | 618/2552 [30:14<47:59,  1.49s/it] 24%|██▍       | 619/2552 [30:15<46:25,  1.44s/it] 24%|██▍       | 620/2552 [30:17<45:23,  1.41s/it]                                                  {'loss': 0.4933, 'grad_norm': 7.771705627441406, 'learning_rate': 3.785266457680251e-05, 'rewards/chosen': -0.503532886505127, 'rewards/rejected': -1.6714750528335571, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.1679422855377197, 'logps/rejected': -73.72430419921875, 'logps/chosen': -52.610816955566406, 'logits/rejected': -0.5239856839179993, 'logits/chosen': -0.4932021200656891, 'epoch': 0.24}
 24%|██▍       | 620/2552 [30:17<45:23,  1.41s/it] 24%|██▍       | 621/2552 [30:18<45:45,  1.42s/it] 24%|██▍       | 622/2552 [30:20<45:00,  1.40s/it] 24%|██▍       | 623/2552 [30:21<48:31,  1.51s/it] 24%|██▍       | 624/2552 [30:23<46:32,  1.45s/it] 24%|██▍       | 625/2552 [30:24<44:35,  1.39s/it] 25%|██▍       | 626/2552 [30:26<47:22,  1.48s/it] 25%|██▍       | 627/2552 [30:27<49:37,  1.55s/it] 25%|██▍       | 628/2552 [30:29<50:20,  1.57s/it] 25%|██▍       | 629/2552 [30:31<50:53,  1.59s/it] 25%|██▍       | 630/2552 [30:32<49:43,  1.55s/it]                                                  {'loss': 0.4119, 'grad_norm': 5.106409549713135, 'learning_rate': 3.7656739811912225e-05, 'rewards/chosen': -0.20872840285301208, 'rewards/rejected': -1.0422662496566772, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.8335378766059875, 'logps/rejected': -86.63856506347656, 'logps/chosen': -46.42926788330078, 'logits/rejected': -0.5559948682785034, 'logits/chosen': -0.5254899859428406, 'epoch': 0.25}
 25%|██▍       | 630/2552 [30:32<49:43,  1.55s/it] 25%|██▍       | 631/2552 [30:34<50:51,  1.59s/it] 25%|██▍       | 632/2552 [30:35<49:57,  1.56s/it] 25%|██▍       | 633/2552 [30:37<48:12,  1.51s/it] 25%|██▍       | 634/2552 [30:38<47:25,  1.48s/it] 25%|██▍       | 635/2552 [30:39<46:52,  1.47s/it] 25%|██▍       | 636/2552 [30:41<46:10,  1.45s/it] 25%|██▍       | 637/2552 [30:42<46:33,  1.46s/it] 25%|██▌       | 638/2552 [30:44<48:55,  1.53s/it] 25%|██▌       | 639/2552 [30:45<47:35,  1.49s/it] 25%|██▌       | 640/2552 [30:47<46:48,  1.47s/it]                                                  {'loss': 0.4414, 'grad_norm': 4.99786901473999, 'learning_rate': 3.746081504702195e-05, 'rewards/chosen': -0.5044997334480286, 'rewards/rejected': -1.2377722263336182, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 0.7332724332809448, 'logps/rejected': -35.29726791381836, 'logps/chosen': -31.395828247070312, 'logits/rejected': -0.5525599718093872, 'logits/chosen': -0.5581725239753723, 'epoch': 0.25}
 25%|██▌       | 640/2552 [30:47<46:48,  1.47s/it] 25%|██▌       | 641/2552 [30:49<50:48,  1.60s/it] 25%|██▌       | 642/2552 [30:50<50:13,  1.58s/it] 25%|██▌       | 643/2552 [30:52<46:49,  1.47s/it] 25%|██▌       | 644/2552 [30:53<45:27,  1.43s/it] 25%|██▌       | 645/2552 [30:54<46:13,  1.45s/it] 25%|██▌       | 646/2552 [30:56<44:39,  1.41s/it] 25%|██▌       | 647/2552 [30:57<46:21,  1.46s/it] 25%|██▌       | 648/2552 [30:59<44:49,  1.41s/it] 25%|██▌       | 649/2552 [31:00<46:40,  1.47s/it] 25%|██▌       | 650/2552 [31:02<47:40,  1.50s/it]                                                  {'loss': 0.5991, 'grad_norm': 5.663900852203369, 'learning_rate': 3.726489028213167e-05, 'rewards/chosen': -1.396411657333374, 'rewards/rejected': -1.4422338008880615, 'rewards/accuracies': 0.5, 'rewards/margins': 0.04582207277417183, 'logps/rejected': -68.64915466308594, 'logps/chosen': -59.247047424316406, 'logits/rejected': -0.5653438568115234, 'logits/chosen': -0.5617831349372864, 'epoch': 0.25}
 25%|██▌       | 650/2552 [31:02<47:40,  1.50s/it] 26%|██▌       | 651/2552 [31:03<48:06,  1.52s/it] 26%|██▌       | 652/2552 [31:05<46:03,  1.45s/it] 26%|██▌       | 653/2552 [31:06<47:24,  1.50s/it] 26%|██▌       | 654/2552 [31:08<45:57,  1.45s/it] 26%|██▌       | 655/2552 [31:09<44:27,  1.41s/it] 26%|██▌       | 656/2552 [31:10<43:11,  1.37s/it] 26%|██▌       | 657/2552 [31:11<42:12,  1.34s/it] 26%|██▌       | 658/2552 [31:13<41:11,  1.30s/it] 26%|██▌       | 659/2552 [31:14<40:53,  1.30s/it] 26%|██▌       | 660/2552 [31:16<44:09,  1.40s/it]                                                  {'loss': 0.5578, 'grad_norm': 9.264382362365723, 'learning_rate': 3.7068965517241385e-05, 'rewards/chosen': -0.8226218223571777, 'rewards/rejected': -2.1685590744018555, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.3459372520446777, 'logps/rejected': -67.2340316772461, 'logps/chosen': -41.316688537597656, 'logits/rejected': -0.5620489120483398, 'logits/chosen': -0.5133081674575806, 'epoch': 0.26}
 26%|██▌       | 660/2552 [31:16<44:09,  1.40s/it] 26%|██▌       | 661/2552 [31:17<45:18,  1.44s/it] 26%|██▌       | 662/2552 [31:19<45:53,  1.46s/it] 26%|██▌       | 663/2552 [31:20<46:47,  1.49s/it] 26%|██▌       | 664/2552 [31:21<45:44,  1.45s/it] 26%|██▌       | 665/2552 [31:23<49:38,  1.58s/it] 26%|██▌       | 666/2552 [31:25<46:43,  1.49s/it] 26%|██▌       | 667/2552 [31:26<50:01,  1.59s/it] 26%|██▌       | 668/2552 [31:28<48:24,  1.54s/it] 26%|██▌       | 669/2552 [31:29<48:03,  1.53s/it] 26%|██▋       | 670/2552 [31:31<45:58,  1.47s/it]                                                  {'loss': 0.6599, 'grad_norm': 6.002804279327393, 'learning_rate': 3.68730407523511e-05, 'rewards/chosen': -1.3088643550872803, 'rewards/rejected': -1.846313714981079, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.5374494791030884, 'logps/rejected': -55.3044319152832, 'logps/chosen': -45.83513641357422, 'logits/rejected': -0.6961303949356079, 'logits/chosen': -0.6712988018989563, 'epoch': 0.26}
 26%|██▋       | 670/2552 [31:31<45:58,  1.47s/it] 26%|██▋       | 671/2552 [31:32<44:30,  1.42s/it] 26%|██▋       | 672/2552 [31:33<43:57,  1.40s/it] 26%|██▋       | 673/2552 [31:35<43:37,  1.39s/it] 26%|██▋       | 674/2552 [31:36<45:11,  1.44s/it] 26%|██▋       | 675/2552 [31:38<45:29,  1.45s/it] 26%|██▋       | 676/2552 [31:39<44:32,  1.42s/it] 27%|██▋       | 677/2552 [31:40<42:33,  1.36s/it] 27%|██▋       | 678/2552 [31:42<42:06,  1.35s/it] 27%|██▋       | 679/2552 [31:43<43:57,  1.41s/it] 27%|██▋       | 680/2552 [31:45<44:17,  1.42s/it]                                                  {'loss': 0.5491, 'grad_norm': 6.829859733581543, 'learning_rate': 3.667711598746082e-05, 'rewards/chosen': -0.529861330986023, 'rewards/rejected': -2.1328656673431396, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.6030040979385376, 'logps/rejected': -68.11141967773438, 'logps/chosen': -50.59412384033203, 'logits/rejected': -0.5168876647949219, 'logits/chosen': -0.5428991317749023, 'epoch': 0.27}
 27%|██▋       | 680/2552 [31:45<44:17,  1.42s/it] 27%|██▋       | 681/2552 [31:47<48:11,  1.55s/it] 27%|██▋       | 682/2552 [31:48<46:54,  1.50s/it] 27%|██▋       | 683/2552 [31:49<43:56,  1.41s/it] 27%|██▋       | 684/2552 [31:50<42:35,  1.37s/it] 27%|██▋       | 685/2552 [31:52<41:52,  1.35s/it] 27%|██▋       | 686/2552 [31:53<41:55,  1.35s/it] 27%|██▋       | 687/2552 [31:55<43:23,  1.40s/it] 27%|██▋       | 688/2552 [31:56<41:51,  1.35s/it] 27%|██▋       | 689/2552 [31:57<41:48,  1.35s/it] 27%|██▋       | 690/2552 [31:58<41:44,  1.35s/it]                                                  {'loss': 0.576, 'grad_norm': 7.926305294036865, 'learning_rate': 3.648119122257053e-05, 'rewards/chosen': -1.1264212131500244, 'rewards/rejected': -1.4680157899856567, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.34159451723098755, 'logps/rejected': -61.60176467895508, 'logps/chosen': -53.267173767089844, 'logits/rejected': -0.5757810473442078, 'logits/chosen': -0.5664593577384949, 'epoch': 0.27}
 27%|██▋       | 690/2552 [31:59<41:44,  1.35s/it] 27%|██▋       | 691/2552 [32:00<45:04,  1.45s/it] 27%|██▋       | 692/2552 [32:01<43:12,  1.39s/it] 27%|██▋       | 693/2552 [32:03<43:29,  1.40s/it] 27%|██▋       | 694/2552 [32:04<44:26,  1.44s/it] 27%|██▋       | 695/2552 [32:06<43:19,  1.40s/it] 27%|██▋       | 696/2552 [32:07<43:28,  1.41s/it] 27%|██▋       | 697/2552 [32:09<44:44,  1.45s/it] 27%|██▋       | 698/2552 [32:10<45:56,  1.49s/it] 27%|██▋       | 699/2552 [32:12<46:37,  1.51s/it] 27%|██▋       | 700/2552 [32:13<47:26,  1.54s/it]                                                  {'loss': 0.6429, 'grad_norm': 5.2531514167785645, 'learning_rate': 3.628526645768025e-05, 'rewards/chosen': -0.42164331674575806, 'rewards/rejected': -1.697288155555725, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.2756448984146118, 'logps/rejected': -66.5962905883789, 'logps/chosen': -26.200347900390625, 'logits/rejected': -0.6642868518829346, 'logits/chosen': -0.6245651245117188, 'epoch': 0.27}
 27%|██▋       | 700/2552 [32:13<47:26,  1.54s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:02,  1.19it/s][A
  4%|▍         | 3/77 [00:02<01:16,  1.03s/it][A
  5%|▌         | 4/77 [00:04<01:21,  1.12s/it][A
  6%|▋         | 5/77 [00:06<01:42,  1.42s/it][A
  8%|▊         | 6/77 [00:07<01:32,  1.30s/it][A
  9%|▉         | 7/77 [00:08<01:32,  1.33s/it][A
 10%|█         | 8/77 [00:10<01:34,  1.38s/it][A
 12%|█▏        | 9/77 [00:11<01:37,  1.44s/it][A
 13%|█▎        | 10/77 [00:12<01:28,  1.31s/it][A
 14%|█▍        | 11/77 [00:13<01:21,  1.23s/it][A
 16%|█▌        | 12/77 [00:15<01:35,  1.47s/it][A
 17%|█▋        | 13/77 [00:16<01:27,  1.37s/it][A
 18%|█▊        | 14/77 [00:18<01:23,  1.33s/it][A
 19%|█▉        | 15/77 [00:19<01:28,  1.43s/it][A
 21%|██        | 16/77 [00:20<01:16,  1.26s/it][A
 22%|██▏       | 17/77 [00:22<01:17,  1.29s/it][A
 23%|██▎       | 18/77 [00:23<01:18,  1.33s/it][A
 25%|██▍       | 19/77 [00:25<01:24,  1.46s/it][A
 26%|██▌       | 20/77 [00:26<01:15,  1.32s/it][A
 27%|██▋       | 21/77 [00:27<01:04,  1.16s/it][A
 29%|██▊       | 22/77 [00:28<01:10,  1.29s/it][A
 30%|██▉       | 23/77 [00:30<01:19,  1.47s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.43s/it][A
 32%|███▏      | 25/77 [00:33<01:12,  1.40s/it][A
 34%|███▍      | 26/77 [00:34<01:05,  1.29s/it][A
 35%|███▌      | 27/77 [00:35<01:05,  1.32s/it][A
 36%|███▋      | 28/77 [00:36<01:02,  1.27s/it][A
 38%|███▊      | 29/77 [00:38<01:07,  1.41s/it][A
 39%|███▉      | 30/77 [00:40<01:11,  1.52s/it][A
 40%|████      | 31/77 [00:41<01:11,  1.55s/it][A
 42%|████▏     | 32/77 [00:43<01:10,  1.56s/it][A
 43%|████▎     | 33/77 [00:44<01:06,  1.52s/it][A
 44%|████▍     | 34/77 [00:46<01:05,  1.52s/it][A
 45%|████▌     | 35/77 [00:47<01:02,  1.49s/it][A
 47%|████▋     | 36/77 [00:49<01:03,  1.55s/it][A
 48%|████▊     | 37/77 [00:50<00:57,  1.43s/it][A
 49%|████▉     | 38/77 [00:51<00:52,  1.34s/it][A
 51%|█████     | 39/77 [00:53<00:57,  1.51s/it][A
 52%|█████▏    | 40/77 [00:55<00:56,  1.54s/it][A
 53%|█████▎    | 41/77 [00:56<00:50,  1.39s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.41s/it][A
 56%|█████▌    | 43/77 [00:59<00:51,  1.53s/it][A
 57%|█████▋    | 44/77 [01:00<00:46,  1.41s/it][A
 58%|█████▊    | 45/77 [01:01<00:41,  1.28s/it][A
 60%|█████▉    | 46/77 [01:03<00:40,  1.29s/it][A
 61%|██████    | 47/77 [01:04<00:38,  1.29s/it][A
 62%|██████▏   | 48/77 [01:05<00:40,  1.38s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.41s/it][A
 65%|██████▍   | 50/77 [01:08<00:38,  1.42s/it][A
 66%|██████▌   | 51/77 [01:10<00:40,  1.54s/it][A
 68%|██████▊   | 52/77 [01:12<00:38,  1.54s/it][A
 69%|██████▉   | 53/77 [01:14<00:39,  1.65s/it][A
 70%|███████   | 54/77 [01:15<00:35,  1.55s/it][A
 71%|███████▏  | 55/77 [01:16<00:32,  1.46s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.69s/it][A
 74%|███████▍  | 57/77 [01:20<00:31,  1.57s/it][A
 75%|███████▌  | 58/77 [01:21<00:30,  1.61s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.60s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.43s/it][A
 79%|███████▉  | 61/77 [01:26<00:23,  1.50s/it][A
 81%|████████  | 62/77 [01:27<00:22,  1.47s/it][A
 82%|████████▏ | 63/77 [01:29<00:21,  1.54s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.42s/it][A
 84%|████████▍ | 65/77 [01:31<00:16,  1.41s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.57s/it][A
 87%|████████▋ | 67/77 [01:34<00:13,  1.35s/it][A
 88%|████████▊ | 68/77 [01:36<00:13,  1.45s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.44s/it][A
 91%|█████████ | 70/77 [01:38<00:09,  1.39s/it][A
 92%|█████████▏| 71/77 [01:40<00:07,  1.29s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.33s/it][A
 95%|█████████▍| 73/77 [01:43<00:05,  1.43s/it][A
 96%|█████████▌| 74/77 [01:45<00:04,  1.61s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.55s/it][A
 99%|█████████▊| 76/77 [01:47<00:01,  1.47s/it][A
100%|██████████| 77/77 [01:49<00:00,  1.52s/it][A                                                  
                                               [A{'eval_loss': 0.5295498371124268, 'eval_runtime': 110.8551, 'eval_samples_per_second': 11.023, 'eval_steps_per_second': 0.695, 'eval_rewards/chosen': -0.43482673168182373, 'eval_rewards/rejected': -1.3538702726364136, 'eval_rewards/accuracies': 0.7922077775001526, 'eval_rewards/margins': 0.9190434813499451, 'eval_logps/rejected': -52.791847229003906, 'eval_logps/chosen': -42.85712432861328, 'eval_logits/rejected': -0.47735780477523804, 'eval_logits/chosen': -0.4769020974636078, 'epoch': 0.27}
 27%|██▋       | 700/2552 [34:04<47:26,  1.54s/it]
100%|██████████| 77/77 [01:49<00:00,  1.52s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 27%|██▋       | 701/2552 [34:33<22:02:38, 42.87s/it] 28%|██▊       | 702/2552 [34:34<15:37:13, 30.40s/it] 28%|██▊       | 703/2552 [34:35<11:08:05, 21.68s/it] 28%|██▊       | 704/2552 [34:37<8:01:57, 15.65s/it]  28%|██▊       | 705/2552 [34:38<5:48:32, 11.32s/it] 28%|██▊       | 706/2552 [34:39<4:14:42,  8.28s/it] 28%|██▊       | 707/2552 [34:41<3:10:51,  6.21s/it] 28%|██▊       | 708/2552 [34:42<2:25:43,  4.74s/it] 28%|██▊       | 709/2552 [34:44<1:56:18,  3.79s/it] 28%|██▊       | 710/2552 [34:45<1:32:50,  3.02s/it]                                                    {'loss': 0.5253, 'grad_norm': 14.032330513000488, 'learning_rate': 3.608934169278997e-05, 'rewards/chosen': -0.34075766801834106, 'rewards/rejected': -1.4608763456344604, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.1201188564300537, 'logps/rejected': -65.12773895263672, 'logps/chosen': -51.67155075073242, 'logits/rejected': -0.6342160105705261, 'logits/chosen': -0.6204419136047363, 'epoch': 0.28}
 28%|██▊       | 710/2552 [34:45<1:32:50,  3.02s/it] 28%|██▊       | 711/2552 [34:46<1:17:22,  2.52s/it] 28%|██▊       | 712/2552 [34:48<1:06:45,  2.18s/it] 28%|██▊       | 713/2552 [34:49<1:00:01,  1.96s/it] 28%|██▊       | 714/2552 [34:50<54:33,  1.78s/it]   28%|██▊       | 715/2552 [34:52<51:23,  1.68s/it] 28%|██▊       | 716/2552 [34:53<47:02,  1.54s/it] 28%|██▊       | 717/2552 [34:54<45:49,  1.50s/it] 28%|██▊       | 718/2552 [34:56<43:50,  1.43s/it] 28%|██▊       | 719/2552 [34:57<41:38,  1.36s/it] 28%|██▊       | 720/2552 [34:58<43:31,  1.43s/it]                                                  {'loss': 0.5251, 'grad_norm': 7.12681245803833, 'learning_rate': 3.5893416927899686e-05, 'rewards/chosen': -0.18805208802223206, 'rewards/rejected': -0.8047387003898621, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.6166867017745972, 'logps/rejected': -58.69048309326172, 'logps/chosen': -55.94565963745117, 'logits/rejected': -0.5653223991394043, 'logits/chosen': -0.5494100451469421, 'epoch': 0.28}
 28%|██▊       | 720/2552 [34:59<43:31,  1.43s/it] 28%|██▊       | 721/2552 [35:00<42:46,  1.40s/it] 28%|██▊       | 722/2552 [35:01<45:14,  1.48s/it] 28%|██▊       | 723/2552 [35:03<45:30,  1.49s/it] 28%|██▊       | 724/2552 [35:04<43:54,  1.44s/it] 28%|██▊       | 725/2552 [35:06<43:54,  1.44s/it] 28%|██▊       | 726/2552 [35:07<43:32,  1.43s/it] 28%|██▊       | 727/2552 [35:08<42:04,  1.38s/it] 29%|██▊       | 728/2552 [35:10<45:20,  1.49s/it] 29%|██▊       | 729/2552 [35:12<45:31,  1.50s/it] 29%|██▊       | 730/2552 [35:13<45:33,  1.50s/it]                                                  {'loss': 0.4741, 'grad_norm': 8.950838088989258, 'learning_rate': 3.56974921630094e-05, 'rewards/chosen': -0.7409804463386536, 'rewards/rejected': -1.0668056011199951, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.32582518458366394, 'logps/rejected': -48.601318359375, 'logps/chosen': -44.74906921386719, 'logits/rejected': -0.5081242322921753, 'logits/chosen': -0.5260847210884094, 'epoch': 0.29}
 29%|██▊       | 730/2552 [35:13<45:33,  1.50s/it] 29%|██▊       | 731/2552 [35:15<45:27,  1.50s/it] 29%|██▊       | 732/2552 [35:16<46:38,  1.54s/it] 29%|██▊       | 733/2552 [35:18<44:15,  1.46s/it] 29%|██▉       | 734/2552 [35:19<46:14,  1.53s/it] 29%|██▉       | 735/2552 [35:20<43:06,  1.42s/it] 29%|██▉       | 736/2552 [35:22<42:36,  1.41s/it] 29%|██▉       | 737/2552 [35:23<43:12,  1.43s/it] 29%|██▉       | 738/2552 [35:25<42:28,  1.40s/it] 29%|██▉       | 739/2552 [35:26<41:19,  1.37s/it] 29%|██▉       | 740/2552 [35:27<41:29,  1.37s/it]                                                  {'loss': 0.5064, 'grad_norm': 6.362096309661865, 'learning_rate': 3.550156739811912e-05, 'rewards/chosen': -0.09511006623506546, 'rewards/rejected': -1.6311619281768799, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.5360519886016846, 'logps/rejected': -51.060516357421875, 'logps/chosen': -56.29637908935547, 'logits/rejected': -0.5537657737731934, 'logits/chosen': -0.5491107106208801, 'epoch': 0.29}
 29%|██▉       | 740/2552 [35:27<41:29,  1.37s/it] 29%|██▉       | 741/2552 [35:29<44:58,  1.49s/it] 29%|██▉       | 742/2552 [35:31<45:21,  1.50s/it] 29%|██▉       | 743/2552 [35:32<45:45,  1.52s/it] 29%|██▉       | 744/2552 [35:33<42:41,  1.42s/it] 29%|██▉       | 745/2552 [35:35<44:04,  1.46s/it] 29%|██▉       | 746/2552 [35:36<44:31,  1.48s/it] 29%|██▉       | 747/2552 [35:38<44:44,  1.49s/it] 29%|██▉       | 748/2552 [35:39<44:23,  1.48s/it] 29%|██▉       | 749/2552 [35:41<43:06,  1.43s/it] 29%|██▉       | 750/2552 [35:42<45:05,  1.50s/it]                                                  {'loss': 0.5138, 'grad_norm': 11.245002746582031, 'learning_rate': 3.530564263322884e-05, 'rewards/chosen': -0.4409302771091461, 'rewards/rejected': -1.6037486791610718, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.162818431854248, 'logps/rejected': -45.94621658325195, 'logps/chosen': -43.553199768066406, 'logits/rejected': -0.6309295892715454, 'logits/chosen': -0.6397971510887146, 'epoch': 0.29}
 29%|██▉       | 750/2552 [35:42<45:05,  1.50s/it] 29%|██▉       | 751/2552 [35:44<44:39,  1.49s/it] 29%|██▉       | 752/2552 [35:45<43:42,  1.46s/it] 30%|██▉       | 753/2552 [35:47<42:43,  1.43s/it] 30%|██▉       | 754/2552 [35:48<41:09,  1.37s/it] 30%|██▉       | 755/2552 [35:49<40:44,  1.36s/it] 30%|██▉       | 756/2552 [35:51<41:20,  1.38s/it] 30%|██▉       | 757/2552 [35:52<41:05,  1.37s/it] 30%|██▉       | 758/2552 [35:53<41:46,  1.40s/it] 30%|██▉       | 759/2552 [35:55<41:42,  1.40s/it] 30%|██▉       | 760/2552 [35:56<43:23,  1.45s/it]                                                  {'loss': 0.6864, 'grad_norm': 12.216626167297363, 'learning_rate': 3.510971786833856e-05, 'rewards/chosen': -0.8704401850700378, 'rewards/rejected': -1.0491524934768677, 'rewards/accuracies': 0.5, 'rewards/margins': 0.17871232330799103, 'logps/rejected': -42.46348571777344, 'logps/chosen': -45.52333068847656, 'logits/rejected': -0.6624265909194946, 'logits/chosen': -0.6513833999633789, 'epoch': 0.3}
 30%|██▉       | 760/2552 [35:56<43:23,  1.45s/it] 30%|██▉       | 761/2552 [35:58<43:06,  1.44s/it] 30%|██▉       | 762/2552 [35:59<43:29,  1.46s/it] 30%|██▉       | 763/2552 [36:01<45:12,  1.52s/it] 30%|██▉       | 764/2552 [36:02<44:50,  1.50s/it] 30%|██▉       | 765/2552 [36:04<43:14,  1.45s/it] 30%|███       | 766/2552 [36:05<41:34,  1.40s/it] 30%|███       | 767/2552 [36:07<43:40,  1.47s/it] 30%|███       | 768/2552 [36:08<42:15,  1.42s/it] 30%|███       | 769/2552 [36:09<42:48,  1.44s/it] 30%|███       | 770/2552 [36:11<41:36,  1.40s/it]                                                  {'loss': 0.5309, 'grad_norm': 8.41748332977295, 'learning_rate': 3.4913793103448275e-05, 'rewards/chosen': -1.0153807401657104, 'rewards/rejected': -1.1888442039489746, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.17346331477165222, 'logps/rejected': -39.71034240722656, 'logps/chosen': -30.75636863708496, 'logits/rejected': -0.6430853605270386, 'logits/chosen': -0.6374588012695312, 'epoch': 0.3}
 30%|███       | 770/2552 [36:11<41:36,  1.40s/it] 30%|███       | 771/2552 [36:12<40:37,  1.37s/it] 30%|███       | 772/2552 [36:14<42:07,  1.42s/it] 30%|███       | 773/2552 [36:15<40:04,  1.35s/it] 30%|███       | 774/2552 [36:16<42:55,  1.45s/it] 30%|███       | 775/2552 [36:18<41:54,  1.42s/it] 30%|███       | 776/2552 [36:19<40:15,  1.36s/it] 30%|███       | 777/2552 [36:20<39:38,  1.34s/it] 30%|███       | 778/2552 [36:22<38:26,  1.30s/it] 31%|███       | 779/2552 [36:23<41:18,  1.40s/it] 31%|███       | 780/2552 [36:25<41:18,  1.40s/it]                                                  {'loss': 0.4772, 'grad_norm': 7.664319038391113, 'learning_rate': 3.4717868338558e-05, 'rewards/chosen': -0.26612234115600586, 'rewards/rejected': -2.085667133331299, 'rewards/accuracies': 1.0, 'rewards/margins': 1.819544792175293, 'logps/rejected': -60.96772384643555, 'logps/chosen': -44.7375373840332, 'logits/rejected': -0.718672513961792, 'logits/chosen': -0.7127915620803833, 'epoch': 0.31}
 31%|███       | 780/2552 [36:25<41:18,  1.40s/it] 31%|███       | 781/2552 [36:26<40:13,  1.36s/it] 31%|███       | 782/2552 [36:27<41:14,  1.40s/it] 31%|███       | 783/2552 [36:29<39:38,  1.34s/it] 31%|███       | 784/2552 [36:30<40:09,  1.36s/it] 31%|███       | 785/2552 [36:32<41:54,  1.42s/it] 31%|███       | 786/2552 [36:33<40:25,  1.37s/it] 31%|███       | 787/2552 [36:34<40:06,  1.36s/it] 31%|███       | 788/2552 [36:35<38:58,  1.33s/it] 31%|███       | 789/2552 [36:37<38:47,  1.32s/it] 31%|███       | 790/2552 [36:38<39:22,  1.34s/it]                                                  {'loss': 0.5532, 'grad_norm': 11.123040199279785, 'learning_rate': 3.452194357366772e-05, 'rewards/chosen': -1.2638263702392578, 'rewards/rejected': -1.5880279541015625, 'rewards/accuracies': 0.5, 'rewards/margins': 0.3242015242576599, 'logps/rejected': -55.9128532409668, 'logps/chosen': -58.61787796020508, 'logits/rejected': -0.624853253364563, 'logits/chosen': -0.6227128505706787, 'epoch': 0.31}
 31%|███       | 790/2552 [36:38<39:22,  1.34s/it] 31%|███       | 791/2552 [36:40<40:54,  1.39s/it] 31%|███       | 792/2552 [36:41<42:51,  1.46s/it] 31%|███       | 793/2552 [36:43<41:54,  1.43s/it] 31%|███       | 794/2552 [36:44<44:15,  1.51s/it] 31%|███       | 795/2552 [36:46<43:11,  1.48s/it] 31%|███       | 796/2552 [36:47<41:37,  1.42s/it] 31%|███       | 797/2552 [36:48<41:37,  1.42s/it] 31%|███▏      | 798/2552 [36:50<41:06,  1.41s/it] 31%|███▏      | 799/2552 [36:51<39:53,  1.37s/it] 31%|███▏      | 800/2552 [36:52<39:56,  1.37s/it]                                                  {'loss': 0.634, 'grad_norm': 9.138739585876465, 'learning_rate': 3.4326018808777435e-05, 'rewards/chosen': -1.0860925912857056, 'rewards/rejected': -1.2575743198394775, 'rewards/accuracies': 0.4000000059604645, 'rewards/margins': 0.17148156464099884, 'logps/rejected': -50.0114860534668, 'logps/chosen': -40.8960075378418, 'logits/rejected': -0.5466269254684448, 'logits/chosen': -0.5529334545135498, 'epoch': 0.31}
 31%|███▏      | 800/2552 [36:52<39:56,  1.37s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:03,  1.19it/s][A
  4%|▍         | 3/77 [00:02<01:15,  1.01s/it][A
  5%|▌         | 4/77 [00:04<01:20,  1.11s/it][A
  6%|▋         | 5/77 [00:06<01:42,  1.43s/it][A
  8%|▊         | 6/77 [00:07<01:32,  1.30s/it][A
  9%|▉         | 7/77 [00:08<01:32,  1.32s/it][A
 10%|█         | 8/77 [00:10<01:35,  1.38s/it][A
 12%|█▏        | 9/77 [00:11<01:43,  1.52s/it][A
 13%|█▎        | 10/77 [00:13<01:32,  1.38s/it][A
 14%|█▍        | 11/77 [00:14<01:24,  1.28s/it][A
 16%|█▌        | 12/77 [00:16<01:36,  1.48s/it][A
 17%|█▋        | 13/77 [00:17<01:28,  1.38s/it][A
 18%|█▊        | 14/77 [00:18<01:22,  1.32s/it][A
 19%|█▉        | 15/77 [00:20<01:28,  1.42s/it][A
 21%|██        | 16/77 [00:20<01:16,  1.25s/it][A
 22%|██▏       | 17/77 [00:22<01:16,  1.27s/it][A
 23%|██▎       | 18/77 [00:23<01:16,  1.30s/it][A
 25%|██▍       | 19/77 [00:25<01:24,  1.46s/it][A
 26%|██▌       | 20/77 [00:26<01:12,  1.27s/it][A
 27%|██▋       | 21/77 [00:27<01:05,  1.18s/it][A
 29%|██▊       | 22/77 [00:28<01:10,  1.29s/it][A
 30%|██▉       | 23/77 [00:30<01:19,  1.48s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.43s/it][A
 32%|███▏      | 25/77 [00:33<01:12,  1.39s/it][A
 34%|███▍      | 26/77 [00:34<01:05,  1.29s/it][A
 35%|███▌      | 27/77 [00:35<01:06,  1.33s/it][A
 36%|███▋      | 28/77 [00:36<01:02,  1.27s/it][A
 38%|███▊      | 29/77 [00:38<01:07,  1.40s/it][A
 39%|███▉      | 30/77 [00:40<01:11,  1.52s/it][A
 40%|████      | 31/77 [00:42<01:11,  1.55s/it][A
 42%|████▏     | 32/77 [00:43<01:10,  1.56s/it][A
 43%|████▎     | 33/77 [00:45<01:07,  1.54s/it][A
 44%|████▍     | 34/77 [00:46<01:06,  1.54s/it][A
 45%|████▌     | 35/77 [00:48<01:02,  1.50s/it][A
 47%|████▋     | 36/77 [00:49<01:03,  1.56s/it][A
 48%|████▊     | 37/77 [00:50<00:57,  1.44s/it][A
 49%|████▉     | 38/77 [00:52<00:52,  1.34s/it][A
 51%|█████     | 39/77 [00:53<00:57,  1.51s/it][A
 52%|█████▏    | 40/77 [00:55<00:57,  1.56s/it][A
 53%|█████▎    | 41/77 [00:56<00:50,  1.40s/it][A
 55%|█████▍    | 42/77 [00:58<00:49,  1.41s/it][A
 56%|█████▌    | 43/77 [00:59<00:52,  1.54s/it][A
 57%|█████▋    | 44/77 [01:01<00:46,  1.41s/it][A
 58%|█████▊    | 45/77 [01:02<00:41,  1.29s/it][A
 60%|█████▉    | 46/77 [01:03<00:40,  1.31s/it][A
 61%|██████    | 47/77 [01:04<00:38,  1.27s/it][A
 62%|██████▏   | 48/77 [01:06<00:39,  1.37s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.39s/it][A
 65%|██████▍   | 50/77 [01:09<00:38,  1.41s/it][A
 66%|██████▌   | 51/77 [01:10<00:40,  1.54s/it][A
 68%|██████▊   | 52/77 [01:12<00:38,  1.54s/it][A
 69%|██████▉   | 53/77 [01:14<00:39,  1.64s/it][A
 70%|███████   | 54/77 [01:15<00:35,  1.53s/it][A
 71%|███████▏  | 55/77 [01:16<00:31,  1.44s/it][A
 73%|███████▎  | 56/77 [01:19<00:35,  1.69s/it][A
 74%|███████▍  | 57/77 [01:20<00:31,  1.58s/it][A
 75%|███████▌  | 58/77 [01:22<00:30,  1.60s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.60s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.44s/it][A
 79%|███████▉  | 61/77 [01:26<00:24,  1.50s/it][A
 81%|████████  | 62/77 [01:27<00:22,  1.48s/it][A
 82%|████████▏ | 63/77 [01:29<00:21,  1.54s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.42s/it][A
 84%|████████▍ | 65/77 [01:32<00:16,  1.41s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.57s/it][A
 87%|████████▋ | 67/77 [01:34<00:13,  1.30s/it][A
 88%|████████▊ | 68/77 [01:36<00:13,  1.47s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.46s/it][A
 91%|█████████ | 70/77 [01:39<00:09,  1.39s/it][A
 92%|█████████▏| 71/77 [01:40<00:07,  1.33s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.33s/it][A
 95%|█████████▍| 73/77 [01:43<00:05,  1.44s/it][A
 96%|█████████▌| 74/77 [01:45<00:04,  1.59s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.54s/it][A
 99%|█████████▊| 76/77 [01:48<00:01,  1.47s/it][A
100%|██████████| 77/77 [01:49<00:00,  1.52s/it][A                                                  
                                               [A{'eval_loss': 0.5175579190254211, 'eval_runtime': 111.0345, 'eval_samples_per_second': 11.006, 'eval_steps_per_second': 0.693, 'eval_rewards/chosen': -0.5070725083351135, 'eval_rewards/rejected': -1.483680009841919, 'eval_rewards/accuracies': 0.7857142686843872, 'eval_rewards/margins': 0.9766076803207397, 'eval_logps/rejected': -54.08994674682617, 'eval_logps/chosen': -43.57958221435547, 'eval_logits/rejected': -0.484250545501709, 'eval_logits/chosen': -0.4824669659137726, 'epoch': 0.31}
 31%|███▏      | 800/2552 [38:43<39:56,  1.37s/it]
100%|██████████| 77/77 [01:49<00:00,  1.52s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 31%|███▏      | 801/2552 [39:12<20:47:37, 42.75s/it] 31%|███▏      | 802/2552 [39:13<14:44:21, 30.32s/it] 31%|███▏      | 803/2552 [39:14<10:30:21, 21.62s/it] 32%|███▏      | 804/2552 [39:16<7:34:52, 15.61s/it]  32%|███▏      | 805/2552 [39:17<5:29:42, 11.32s/it] 32%|███▏      | 806/2552 [39:19<4:01:54,  8.31s/it] 32%|███▏      | 807/2552 [39:20<3:03:10,  6.30s/it] 32%|███▏      | 808/2552 [39:21<2:20:08,  4.82s/it] 32%|███▏      | 809/2552 [39:23<1:50:43,  3.81s/it] 32%|███▏      | 810/2552 [39:24<1:28:43,  3.06s/it]                                                    {'loss': 0.5137, 'grad_norm': 9.50029182434082, 'learning_rate': 3.413009404388715e-05, 'rewards/chosen': -0.8597278594970703, 'rewards/rejected': -1.653477668762207, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 0.793749988079071, 'logps/rejected': -62.334434509277344, 'logps/chosen': -30.60189437866211, 'logits/rejected': -0.5286271572113037, 'logits/chosen': -0.512020468711853, 'epoch': 0.32}
 32%|███▏      | 810/2552 [39:24<1:28:43,  3.06s/it] 32%|███▏      | 811/2552 [39:26<1:13:43,  2.54s/it] 32%|███▏      | 812/2552 [39:27<1:05:15,  2.25s/it] 32%|███▏      | 813/2552 [39:29<59:43,  2.06s/it]   32%|███▏      | 814/2552 [39:30<56:02,  1.93s/it] 32%|███▏      | 815/2552 [39:32<50:12,  1.73s/it] 32%|███▏      | 816/2552 [39:33<45:50,  1.58s/it] 32%|███▏      | 817/2552 [39:34<43:27,  1.50s/it] 32%|███▏      | 818/2552 [39:35<41:25,  1.43s/it] 32%|███▏      | 819/2552 [39:37<40:21,  1.40s/it] 32%|███▏      | 820/2552 [39:38<41:00,  1.42s/it]                                                  {'loss': 0.4907, 'grad_norm': 10.262284278869629, 'learning_rate': 3.393416927899687e-05, 'rewards/chosen': 0.06108320876955986, 'rewards/rejected': -2.0366339683532715, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 2.097716808319092, 'logps/rejected': -35.20997619628906, 'logps/chosen': -15.269708633422852, 'logits/rejected': -0.5502433180809021, 'logits/chosen': -0.5588949918746948, 'epoch': 0.32}
 32%|███▏      | 820/2552 [39:38<41:00,  1.42s/it] 32%|███▏      | 821/2552 [39:40<41:07,  1.43s/it] 32%|███▏      | 822/2552 [39:41<40:38,  1.41s/it] 32%|███▏      | 823/2552 [39:43<40:52,  1.42s/it] 32%|███▏      | 824/2552 [39:44<40:55,  1.42s/it] 32%|███▏      | 825/2552 [39:46<42:23,  1.47s/it] 32%|███▏      | 826/2552 [39:47<42:13,  1.47s/it] 32%|███▏      | 827/2552 [39:48<40:17,  1.40s/it] 32%|███▏      | 828/2552 [39:50<39:19,  1.37s/it] 32%|███▏      | 829/2552 [39:51<40:22,  1.41s/it] 33%|███▎      | 830/2552 [39:52<40:48,  1.42s/it]                                                  {'loss': 0.5898, 'grad_norm': 16.389141082763672, 'learning_rate': 3.373824451410659e-05, 'rewards/chosen': -0.7522954940795898, 'rewards/rejected': -1.6049045324325562, 'rewards/accuracies': 0.5, 'rewards/margins': 0.8526089787483215, 'logps/rejected': -49.73021697998047, 'logps/chosen': -40.56959533691406, 'logits/rejected': -0.653058648109436, 'logits/chosen': -0.6448640823364258, 'epoch': 0.33}
 33%|███▎      | 830/2552 [39:53<40:48,  1.42s/it] 33%|███▎      | 831/2552 [39:54<41:09,  1.43s/it] 33%|███▎      | 832/2552 [39:55<40:35,  1.42s/it] 33%|███▎      | 833/2552 [39:57<40:35,  1.42s/it] 33%|███▎      | 834/2552 [39:58<39:56,  1.40s/it] 33%|███▎      | 835/2552 [40:00<40:51,  1.43s/it] 33%|███▎      | 836/2552 [40:01<40:27,  1.41s/it] 33%|███▎      | 837/2552 [40:02<38:59,  1.36s/it] 33%|███▎      | 838/2552 [40:04<40:52,  1.43s/it] 33%|███▎      | 839/2552 [40:05<40:33,  1.42s/it] 33%|███▎      | 840/2552 [40:07<40:14,  1.41s/it]                                                  {'loss': 0.4926, 'grad_norm': 8.196967124938965, 'learning_rate': 3.35423197492163e-05, 'rewards/chosen': -0.13355842232704163, 'rewards/rejected': -1.4650737047195435, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.3315150737762451, 'logps/rejected': -46.072898864746094, 'logps/chosen': -29.242244720458984, 'logits/rejected': -0.6018004417419434, 'logits/chosen': -0.6049128770828247, 'epoch': 0.33}
 33%|███▎      | 840/2552 [40:07<40:14,  1.41s/it] 33%|███▎      | 841/2552 [40:08<41:44,  1.46s/it] 33%|███▎      | 842/2552 [40:10<40:28,  1.42s/it] 33%|███▎      | 843/2552 [40:11<39:23,  1.38s/it] 33%|███▎      | 844/2552 [40:12<38:52,  1.37s/it] 33%|███▎      | 845/2552 [40:14<39:02,  1.37s/it] 33%|███▎      | 846/2552 [40:15<38:44,  1.36s/it] 33%|███▎      | 847/2552 [40:16<38:53,  1.37s/it] 33%|███▎      | 848/2552 [40:18<39:48,  1.40s/it] 33%|███▎      | 849/2552 [40:19<40:42,  1.43s/it] 33%|███▎      | 850/2552 [40:21<40:00,  1.41s/it]                                                  {'loss': 0.6276, 'grad_norm': 12.16712474822998, 'learning_rate': 3.334639498432602e-05, 'rewards/chosen': -0.4916857182979584, 'rewards/rejected': -1.905637502670288, 'rewards/accuracies': 1.0, 'rewards/margins': 1.4139517545700073, 'logps/rejected': -63.91692352294922, 'logps/chosen': -31.132579803466797, 'logits/rejected': -0.5737892389297485, 'logits/chosen': -0.5355254411697388, 'epoch': 0.33}
 33%|███▎      | 850/2552 [40:21<40:00,  1.41s/it] 33%|███▎      | 851/2552 [40:22<39:33,  1.40s/it] 33%|███▎      | 852/2552 [40:23<40:09,  1.42s/it] 33%|███▎      | 853/2552 [40:25<38:56,  1.38s/it] 33%|███▎      | 854/2552 [40:26<39:02,  1.38s/it] 34%|███▎      | 855/2552 [40:27<37:47,  1.34s/it] 34%|███▎      | 856/2552 [40:29<36:58,  1.31s/it] 34%|███▎      | 857/2552 [40:30<38:13,  1.35s/it] 34%|███▎      | 858/2552 [40:31<39:10,  1.39s/it] 34%|███▎      | 859/2552 [40:33<39:17,  1.39s/it] 34%|███▎      | 860/2552 [40:34<40:50,  1.45s/it]                                                  {'loss': 0.4653, 'grad_norm': 6.897651195526123, 'learning_rate': 3.3150470219435735e-05, 'rewards/chosen': -0.731388509273529, 'rewards/rejected': -0.9191678762435913, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.1877794861793518, 'logps/rejected': -49.41011428833008, 'logps/chosen': -53.870933532714844, 'logits/rejected': -0.6527045965194702, 'logits/chosen': -0.6671880483627319, 'epoch': 0.34}
 34%|███▎      | 860/2552 [40:35<40:50,  1.45s/it] 34%|███▎      | 861/2552 [40:36<42:15,  1.50s/it] 34%|███▍      | 862/2552 [40:37<41:18,  1.47s/it] 34%|███▍      | 863/2552 [40:39<42:26,  1.51s/it] 34%|███▍      | 864/2552 [40:40<40:52,  1.45s/it] 34%|███▍      | 865/2552 [40:42<41:22,  1.47s/it] 34%|███▍      | 866/2552 [40:44<42:26,  1.51s/it] 34%|███▍      | 867/2552 [40:45<43:44,  1.56s/it] 34%|███▍      | 868/2552 [40:46<40:48,  1.45s/it] 34%|███▍      | 869/2552 [40:48<38:36,  1.38s/it] 34%|███▍      | 870/2552 [40:49<39:51,  1.42s/it]                                                  {'loss': 0.5766, 'grad_norm': 7.913592338562012, 'learning_rate': 3.295454545454545e-05, 'rewards/chosen': -0.4384400248527527, 'rewards/rejected': -1.5305838584899902, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.0921437740325928, 'logps/rejected': -72.55709075927734, 'logps/chosen': -43.979827880859375, 'logits/rejected': -0.6731500625610352, 'logits/chosen': -0.6516333818435669, 'epoch': 0.34}
 34%|███▍      | 870/2552 [40:49<39:51,  1.42s/it] 34%|███▍      | 871/2552 [40:50<38:58,  1.39s/it] 34%|███▍      | 872/2552 [40:52<38:04,  1.36s/it] 34%|███▍      | 873/2552 [40:53<37:29,  1.34s/it] 34%|███▍      | 874/2552 [40:54<38:23,  1.37s/it] 34%|███▍      | 875/2552 [40:56<38:32,  1.38s/it] 34%|███▍      | 876/2552 [40:57<37:38,  1.35s/it] 34%|███▍      | 877/2552 [40:58<36:45,  1.32s/it] 34%|███▍      | 878/2552 [41:00<35:42,  1.28s/it] 34%|███▍      | 879/2552 [41:01<35:51,  1.29s/it] 34%|███▍      | 880/2552 [41:02<34:58,  1.26s/it]                                                  {'loss': 0.4785, 'grad_norm': 6.24270486831665, 'learning_rate': 3.275862068965517e-05, 'rewards/chosen': -1.2509195804595947, 'rewards/rejected': -1.4410961866378784, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.19017675518989563, 'logps/rejected': -73.66474914550781, 'logps/chosen': -81.17860412597656, 'logits/rejected': -0.6493340730667114, 'logits/chosen': -0.6545081734657288, 'epoch': 0.34}
 34%|███▍      | 880/2552 [41:02<34:58,  1.26s/it] 35%|███▍      | 881/2552 [41:03<35:39,  1.28s/it] 35%|███▍      | 882/2552 [41:05<38:19,  1.38s/it] 35%|███▍      | 883/2552 [41:06<37:43,  1.36s/it] 35%|███▍      | 884/2552 [41:08<39:13,  1.41s/it] 35%|███▍      | 885/2552 [41:09<38:27,  1.38s/it] 35%|███▍      | 886/2552 [41:11<40:57,  1.47s/it] 35%|███▍      | 887/2552 [41:12<39:03,  1.41s/it] 35%|███▍      | 888/2552 [41:13<37:59,  1.37s/it] 35%|███▍      | 889/2552 [41:15<39:17,  1.42s/it] 35%|███▍      | 890/2552 [41:16<38:13,  1.38s/it]                                                  {'loss': 0.4879, 'grad_norm': 13.464985847473145, 'learning_rate': 3.256269592476489e-05, 'rewards/chosen': -0.7924704551696777, 'rewards/rejected': -1.6975771188735962, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 0.9051064252853394, 'logps/rejected': -50.07878112792969, 'logps/chosen': -31.017135620117188, 'logits/rejected': -0.7594450116157532, 'logits/chosen': -0.7595051527023315, 'epoch': 0.35}
 35%|███▍      | 890/2552 [41:16<38:13,  1.38s/it] 35%|███▍      | 891/2552 [41:17<36:50,  1.33s/it] 35%|███▍      | 892/2552 [41:19<35:53,  1.30s/it] 35%|███▍      | 893/2552 [41:20<38:40,  1.40s/it] 35%|███▌      | 894/2552 [41:22<38:54,  1.41s/it] 35%|███▌      | 895/2552 [41:23<39:15,  1.42s/it] 35%|███▌      | 896/2552 [41:25<40:08,  1.45s/it] 35%|███▌      | 897/2552 [41:26<38:44,  1.40s/it] 35%|███▌      | 898/2552 [41:27<38:04,  1.38s/it] 35%|███▌      | 899/2552 [41:29<37:59,  1.38s/it] 35%|███▌      | 900/2552 [41:30<37:04,  1.35s/it]                                                  {'loss': 0.5804, 'grad_norm': 9.765843391418457, 'learning_rate': 3.2366771159874606e-05, 'rewards/chosen': -1.1948072910308838, 'rewards/rejected': -1.4207162857055664, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.22590899467468262, 'logps/rejected': -54.88811492919922, 'logps/chosen': -61.895713806152344, 'logits/rejected': -0.6300620436668396, 'logits/chosen': -0.6418341994285583, 'epoch': 0.35}
 35%|███▌      | 900/2552 [41:30<37:04,  1.35s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:02,  1.20it/s][A
  4%|▍         | 3/77 [00:02<01:16,  1.03s/it][A
  5%|▌         | 4/77 [00:04<01:21,  1.11s/it][A
  6%|▋         | 5/77 [00:06<01:41,  1.41s/it][A
  8%|▊         | 6/77 [00:07<01:31,  1.29s/it][A
  9%|▉         | 7/77 [00:08<01:32,  1.33s/it][A
 10%|█         | 8/77 [00:10<01:33,  1.36s/it][A
 12%|█▏        | 9/77 [00:11<01:37,  1.43s/it][A
 13%|█▎        | 10/77 [00:12<01:28,  1.32s/it][A
 14%|█▍        | 11/77 [00:13<01:21,  1.23s/it][A
 16%|█▌        | 12/77 [00:15<01:34,  1.46s/it][A
 17%|█▋        | 13/77 [00:16<01:28,  1.38s/it][A
 18%|█▊        | 14/77 [00:18<01:22,  1.30s/it][A
 19%|█▉        | 15/77 [00:19<01:27,  1.41s/it][A
 21%|██        | 16/77 [00:20<01:15,  1.24s/it][A
 22%|██▏       | 17/77 [00:21<01:16,  1.27s/it][A
 23%|██▎       | 18/77 [00:23<01:16,  1.30s/it][A
 25%|██▍       | 19/77 [00:25<01:24,  1.45s/it][A
 26%|██▌       | 20/77 [00:25<01:12,  1.27s/it][A
 27%|██▋       | 21/77 [00:26<01:05,  1.17s/it][A
 29%|██▊       | 22/77 [00:28<01:10,  1.27s/it][A
 30%|██▉       | 23/77 [00:30<01:18,  1.46s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.42s/it][A
 32%|███▏      | 25/77 [00:32<01:12,  1.39s/it][A
 34%|███▍      | 26/77 [00:33<01:05,  1.28s/it][A
 35%|███▌      | 27/77 [00:35<01:06,  1.32s/it][A
 36%|███▋      | 28/77 [00:36<01:02,  1.27s/it][A
 38%|███▊      | 29/77 [00:38<01:07,  1.41s/it][A
 39%|███▉      | 30/77 [00:40<01:11,  1.53s/it][A
 40%|████      | 31/77 [00:41<01:11,  1.55s/it][A
 42%|████▏     | 32/77 [00:43<01:09,  1.55s/it][A
 43%|████▎     | 33/77 [00:44<01:06,  1.52s/it][A
 44%|████▍     | 34/77 [00:46<01:05,  1.53s/it][A
 45%|████▌     | 35/77 [00:47<01:03,  1.50s/it][A
 47%|████▋     | 36/77 [00:49<01:03,  1.56s/it][A
 48%|████▊     | 37/77 [00:50<00:57,  1.44s/it][A
 49%|████▉     | 38/77 [00:51<00:52,  1.35s/it][A
 51%|█████     | 39/77 [00:53<00:57,  1.51s/it][A
 52%|█████▏    | 40/77 [00:55<00:57,  1.56s/it][A
 53%|█████▎    | 41/77 [00:56<00:50,  1.40s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.43s/it][A
 56%|█████▌    | 43/77 [00:59<00:52,  1.53s/it][A
 57%|█████▋    | 44/77 [01:00<00:46,  1.41s/it][A
 58%|█████▊    | 45/77 [01:01<00:41,  1.28s/it][A
 60%|█████▉    | 46/77 [01:02<00:40,  1.29s/it][A
 61%|██████    | 47/77 [01:04<00:38,  1.28s/it][A
 62%|██████▏   | 48/77 [01:05<00:39,  1.37s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.41s/it][A
 65%|██████▍   | 50/77 [01:08<00:38,  1.43s/it][A
 66%|██████▌   | 51/77 [01:10<00:40,  1.55s/it][A
 68%|██████▊   | 52/77 [01:12<00:38,  1.53s/it][A
 69%|██████▉   | 53/77 [01:13<00:39,  1.64s/it][A
 70%|███████   | 54/77 [01:15<00:35,  1.54s/it][A
 71%|███████▏  | 55/77 [01:16<00:31,  1.45s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.69s/it][A
 74%|███████▍  | 57/77 [01:20<00:31,  1.58s/it][A
 75%|███████▌  | 58/77 [01:21<00:30,  1.60s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.59s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.43s/it][A
 79%|███████▉  | 61/77 [01:25<00:23,  1.48s/it][A
 81%|████████  | 62/77 [01:27<00:22,  1.47s/it][A
 82%|████████▏ | 63/77 [01:29<00:21,  1.54s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.42s/it][A
 84%|████████▍ | 65/77 [01:31<00:16,  1.41s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.56s/it][A
 87%|████████▋ | 67/77 [01:34<00:12,  1.29s/it][A
 88%|████████▊ | 68/77 [01:36<00:13,  1.47s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.44s/it][A
 91%|█████████ | 70/77 [01:38<00:09,  1.37s/it][A
 92%|█████████▏| 71/77 [01:39<00:07,  1.27s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.31s/it][A
 95%|█████████▍| 73/77 [01:42<00:05,  1.44s/it][A
 96%|█████████▌| 74/77 [01:44<00:04,  1.59s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.53s/it][A
 99%|█████████▊| 76/77 [01:47<00:01,  1.48s/it][A
100%|██████████| 77/77 [01:49<00:00,  1.52s/it][A                                                  
                                               [A{'eval_loss': 0.5209789276123047, 'eval_runtime': 110.5044, 'eval_samples_per_second': 11.058, 'eval_steps_per_second': 0.697, 'eval_rewards/chosen': -0.4569897949695587, 'eval_rewards/rejected': -1.4713090658187866, 'eval_rewards/accuracies': 0.7857142686843872, 'eval_rewards/margins': 1.0143194198608398, 'eval_logps/rejected': -53.96623992919922, 'eval_logps/chosen': -43.07875442504883, 'eval_logits/rejected': -0.4845251142978668, 'eval_logits/chosen': -0.4832867681980133, 'epoch': 0.35}
 35%|███▌      | 900/2552 [43:21<37:04,  1.35s/it]
100%|██████████| 77/77 [01:49<00:00,  1.52s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 35%|███▌      | 901/2552 [43:48<19:29:13, 42.49s/it] 35%|███▌      | 902/2552 [43:50<13:48:54, 30.14s/it] 35%|███▌      | 903/2552 [43:51<9:51:56, 21.54s/it]  35%|███▌      | 904/2552 [43:53<7:06:48, 15.54s/it] 35%|███▌      | 905/2552 [43:54<5:12:40, 11.39s/it] 36%|███▌      | 906/2552 [43:56<3:51:58,  8.46s/it] 36%|███▌      | 907/2552 [43:58<2:55:43,  6.41s/it] 36%|███▌      | 908/2552 [43:59<2:13:02,  4.86s/it] 36%|███▌      | 909/2552 [44:00<1:43:58,  3.80s/it] 36%|███▌      | 910/2552 [44:02<1:22:42,  3.02s/it]                                                    {'loss': 0.6289, 'grad_norm': 7.208377361297607, 'learning_rate': 3.2170846394984324e-05, 'rewards/chosen': -0.8333165049552917, 'rewards/rejected': -1.3669471740722656, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.5336307287216187, 'logps/rejected': -63.250038146972656, 'logps/chosen': -47.661537170410156, 'logits/rejected': -0.5499613881111145, 'logits/chosen': -0.5448010563850403, 'epoch': 0.36}
 36%|███▌      | 910/2552 [44:02<1:22:42,  3.02s/it] 36%|███▌      | 911/2552 [44:03<1:10:18,  2.57s/it] 36%|███▌      | 912/2552 [44:05<1:01:34,  2.25s/it] 36%|███▌      | 913/2552 [44:06<53:40,  1.96s/it]   36%|███▌      | 914/2552 [44:08<52:26,  1.92s/it] 36%|███▌      | 915/2552 [44:09<49:33,  1.82s/it] 36%|███▌      | 916/2552 [44:11<48:36,  1.78s/it] 36%|███▌      | 917/2552 [44:12<45:47,  1.68s/it] 36%|███▌      | 918/2552 [44:14<44:10,  1.62s/it] 36%|███▌      | 919/2552 [44:15<42:57,  1.58s/it] 36%|███▌      | 920/2552 [44:17<40:49,  1.50s/it]                                                  {'loss': 0.3937, 'grad_norm': 6.643992900848389, 'learning_rate': 3.197492163009405e-05, 'rewards/chosen': -0.30930444598197937, 'rewards/rejected': -1.5087944269180298, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.1994898319244385, 'logps/rejected': -56.628509521484375, 'logps/chosen': -29.738155364990234, 'logits/rejected': -0.5611312389373779, 'logits/chosen': -0.5390156507492065, 'epoch': 0.36}
 36%|███▌      | 920/2552 [44:17<40:49,  1.50s/it] 36%|███▌      | 921/2552 [44:18<38:20,  1.41s/it] 36%|███▌      | 922/2552 [44:19<38:17,  1.41s/it] 36%|███▌      | 923/2552 [44:21<37:58,  1.40s/it] 36%|███▌      | 924/2552 [44:22<41:19,  1.52s/it] 36%|███▌      | 925/2552 [44:24<39:48,  1.47s/it] 36%|███▋      | 926/2552 [44:25<40:28,  1.49s/it] 36%|███▋      | 927/2552 [44:27<41:45,  1.54s/it] 36%|███▋      | 928/2552 [44:28<39:24,  1.46s/it] 36%|███▋      | 929/2552 [44:30<38:07,  1.41s/it] 36%|███▋      | 930/2552 [44:31<36:20,  1.34s/it]                                                  {'loss': 0.454, 'grad_norm': 9.761009216308594, 'learning_rate': 3.1778996865203767e-05, 'rewards/chosen': -0.23140034079551697, 'rewards/rejected': -1.8625770807266235, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.6311765909194946, 'logps/rejected': -82.54621124267578, 'logps/chosen': -31.096670150756836, 'logits/rejected': -0.7720664739608765, 'logits/chosen': -0.715755820274353, 'epoch': 0.36}
 36%|███▋      | 930/2552 [44:31<36:20,  1.34s/it] 36%|███▋      | 931/2552 [44:32<37:52,  1.40s/it] 37%|███▋      | 932/2552 [44:34<37:44,  1.40s/it] 37%|███▋      | 933/2552 [44:35<39:20,  1.46s/it] 37%|███▋      | 934/2552 [44:37<37:39,  1.40s/it] 37%|███▋      | 935/2552 [44:38<36:46,  1.36s/it] 37%|███▋      | 936/2552 [44:39<35:36,  1.32s/it] 37%|███▋      | 937/2552 [44:41<36:45,  1.37s/it] 37%|███▋      | 938/2552 [44:42<38:40,  1.44s/it] 37%|███▋      | 939/2552 [44:44<38:26,  1.43s/it] 37%|███▋      | 940/2552 [44:45<37:11,  1.38s/it]                                                  {'loss': 0.404, 'grad_norm': 9.247302055358887, 'learning_rate': 3.1583072100313484e-05, 'rewards/chosen': -0.3527021110057831, 'rewards/rejected': -1.9390227794647217, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.5863206386566162, 'logps/rejected': -52.44488525390625, 'logps/chosen': -42.194557189941406, 'logits/rejected': -0.5935801267623901, 'logits/chosen': -0.5850402116775513, 'epoch': 0.37}
 37%|███▋      | 940/2552 [44:45<37:11,  1.38s/it] 37%|███▋      | 941/2552 [44:46<39:25,  1.47s/it] 37%|███▋      | 942/2552 [44:48<40:19,  1.50s/it] 37%|███▋      | 943/2552 [44:49<39:03,  1.46s/it] 37%|███▋      | 944/2552 [44:51<38:03,  1.42s/it] 37%|███▋      | 945/2552 [44:52<36:45,  1.37s/it] 37%|███▋      | 946/2552 [44:53<36:39,  1.37s/it] 37%|███▋      | 947/2552 [44:55<35:22,  1.32s/it] 37%|███▋      | 948/2552 [44:56<34:33,  1.29s/it] 37%|███▋      | 949/2552 [44:57<37:40,  1.41s/it] 37%|███▋      | 950/2552 [44:59<37:47,  1.42s/it]                                                  {'loss': 0.5872, 'grad_norm': 7.009274959564209, 'learning_rate': 3.13871473354232e-05, 'rewards/chosen': -0.37049272656440735, 'rewards/rejected': -1.6678882837295532, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.2973954677581787, 'logps/rejected': -55.38639450073242, 'logps/chosen': -40.9395866394043, 'logits/rejected': -0.6491196751594543, 'logits/chosen': -0.6257172226905823, 'epoch': 0.37}
 37%|███▋      | 950/2552 [44:59<37:47,  1.42s/it] 37%|███▋      | 951/2552 [45:00<37:15,  1.40s/it] 37%|███▋      | 952/2552 [45:02<38:42,  1.45s/it] 37%|███▋      | 953/2552 [45:03<39:01,  1.46s/it] 37%|███▋      | 954/2552 [45:05<39:50,  1.50s/it] 37%|███▋      | 955/2552 [45:06<37:49,  1.42s/it] 37%|███▋      | 956/2552 [45:08<37:34,  1.41s/it] 38%|███▊      | 957/2552 [45:09<40:09,  1.51s/it] 38%|███▊      | 958/2552 [45:11<39:10,  1.47s/it] 38%|███▊      | 959/2552 [45:12<39:22,  1.48s/it] 38%|███▊      | 960/2552 [45:14<39:10,  1.48s/it]                                                  {'loss': 0.6898, 'grad_norm': 10.838841438293457, 'learning_rate': 3.119122257053292e-05, 'rewards/chosen': -0.7542308568954468, 'rewards/rejected': -1.6245418787002563, 'rewards/accuracies': 0.5, 'rewards/margins': 0.8703109622001648, 'logps/rejected': -62.740509033203125, 'logps/chosen': -35.463050842285156, 'logits/rejected': -0.49921542406082153, 'logits/chosen': -0.5096806287765503, 'epoch': 0.38}
 38%|███▊      | 960/2552 [45:14<39:10,  1.48s/it] 38%|███▊      | 961/2552 [45:15<37:48,  1.43s/it] 38%|███▊      | 962/2552 [45:16<36:08,  1.36s/it] 38%|███▊      | 963/2552 [45:18<36:56,  1.39s/it] 38%|███▊      | 964/2552 [45:19<38:29,  1.45s/it] 38%|███▊      | 965/2552 [45:20<36:44,  1.39s/it] 38%|███▊      | 966/2552 [45:22<37:31,  1.42s/it] 38%|███▊      | 967/2552 [45:23<36:36,  1.39s/it] 38%|███▊      | 968/2552 [45:25<36:49,  1.40s/it] 38%|███▊      | 969/2552 [45:26<36:01,  1.37s/it] 38%|███▊      | 970/2552 [45:28<38:44,  1.47s/it]                                                  {'loss': 0.3861, 'grad_norm': 4.0898919105529785, 'learning_rate': 3.099529780564264e-05, 'rewards/chosen': -0.535727858543396, 'rewards/rejected': -1.6274206638336182, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.0916929244995117, 'logps/rejected': -47.0352783203125, 'logps/chosen': -51.51190185546875, 'logits/rejected': -0.6365103125572205, 'logits/chosen': -0.6474515199661255, 'epoch': 0.38}
 38%|███▊      | 970/2552 [45:28<38:44,  1.47s/it] 38%|███▊      | 971/2552 [45:29<37:43,  1.43s/it] 38%|███▊      | 972/2552 [45:31<39:03,  1.48s/it] 38%|███▊      | 973/2552 [45:32<37:24,  1.42s/it] 38%|███▊      | 974/2552 [45:33<36:24,  1.38s/it] 38%|███▊      | 975/2552 [45:35<37:28,  1.43s/it] 38%|███▊      | 976/2552 [45:36<36:06,  1.37s/it] 38%|███▊      | 977/2552 [45:37<36:47,  1.40s/it] 38%|███▊      | 978/2552 [45:39<36:48,  1.40s/it] 38%|███▊      | 979/2552 [45:40<35:57,  1.37s/it] 38%|███▊      | 980/2552 [45:41<35:23,  1.35s/it]                                                  {'loss': 0.5936, 'grad_norm': 8.703048706054688, 'learning_rate': 3.0799373040752356e-05, 'rewards/chosen': -1.3347504138946533, 'rewards/rejected': -1.4875351190567017, 'rewards/accuracies': 0.5, 'rewards/margins': 0.15278464555740356, 'logps/rejected': -71.17137145996094, 'logps/chosen': -42.43037414550781, 'logits/rejected': -0.5186265707015991, 'logits/chosen': -0.4656098484992981, 'epoch': 0.38}
 38%|███▊      | 980/2552 [45:42<35:23,  1.35s/it] 38%|███▊      | 981/2552 [45:43<35:56,  1.37s/it] 38%|███▊      | 982/2552 [45:44<36:32,  1.40s/it] 39%|███▊      | 983/2552 [45:46<35:20,  1.35s/it] 39%|███▊      | 984/2552 [45:47<34:05,  1.30s/it] 39%|███▊      | 985/2552 [45:48<36:33,  1.40s/it] 39%|███▊      | 986/2552 [45:50<36:19,  1.39s/it] 39%|███▊      | 987/2552 [45:51<38:07,  1.46s/it] 39%|███▊      | 988/2552 [45:53<38:10,  1.46s/it] 39%|███▉      | 989/2552 [45:54<38:44,  1.49s/it] 39%|███▉      | 990/2552 [45:56<38:18,  1.47s/it]                                                  {'loss': 0.509, 'grad_norm': 11.04184341430664, 'learning_rate': 3.060344827586207e-05, 'rewards/chosen': 0.00926885660737753, 'rewards/rejected': -1.798257827758789, 'rewards/accuracies': 1.0, 'rewards/margins': 1.8075265884399414, 'logps/rejected': -65.5008773803711, 'logps/chosen': -34.99561309814453, 'logits/rejected': -0.5999476909637451, 'logits/chosen': -0.5787268877029419, 'epoch': 0.39}
 39%|███▉      | 990/2552 [45:56<38:18,  1.47s/it] 39%|███▉      | 991/2552 [45:57<38:19,  1.47s/it] 39%|███▉      | 992/2552 [45:59<37:46,  1.45s/it] 39%|███▉      | 993/2552 [46:00<37:13,  1.43s/it] 39%|███▉      | 994/2552 [46:01<36:40,  1.41s/it] 39%|███▉      | 995/2552 [46:03<37:26,  1.44s/it] 39%|███▉      | 996/2552 [46:05<38:33,  1.49s/it] 39%|███▉      | 997/2552 [46:06<36:35,  1.41s/it] 39%|███▉      | 998/2552 [46:07<37:09,  1.43s/it] 39%|███▉      | 999/2552 [46:09<36:50,  1.42s/it] 39%|███▉      | 1000/2552 [46:10<36:41,  1.42s/it]                                                   {'loss': 0.6009, 'grad_norm': 5.6338958740234375, 'learning_rate': 3.0407523510971785e-05, 'rewards/chosen': -0.2965208888053894, 'rewards/rejected': -1.117326021194458, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.8208051919937134, 'logps/rejected': -43.774375915527344, 'logps/chosen': -47.78745651245117, 'logits/rejected': -0.5701934695243835, 'logits/chosen': -0.5784116387367249, 'epoch': 0.39}
 39%|███▉      | 1000/2552 [46:10<36:41,  1.42s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:03,  1.19it/s][A
  4%|▍         | 3/77 [00:02<01:15,  1.03s/it][A
  5%|▌         | 4/77 [00:04<01:21,  1.12s/it][A
  6%|▋         | 5/77 [00:06<01:42,  1.43s/it][A
  8%|▊         | 6/77 [00:07<01:32,  1.31s/it][A
  9%|▉         | 7/77 [00:08<01:33,  1.33s/it][A
 10%|█         | 8/77 [00:10<01:34,  1.37s/it][A
 12%|█▏        | 9/77 [00:11<01:37,  1.43s/it][A
 13%|█▎        | 10/77 [00:12<01:28,  1.32s/it][A
 14%|█▍        | 11/77 [00:13<01:22,  1.24s/it][A
 16%|█▌        | 12/77 [00:15<01:34,  1.46s/it][A
 17%|█▋        | 13/77 [00:16<01:27,  1.37s/it][A
 18%|█▊        | 14/77 [00:18<01:22,  1.30s/it][A
 19%|█▉        | 15/77 [00:19<01:28,  1.42s/it][A
 21%|██        | 16/77 [00:20<01:16,  1.25s/it][A
 22%|██▏       | 17/77 [00:21<01:16,  1.27s/it][A
 23%|██▎       | 18/77 [00:23<01:16,  1.30s/it][A
 25%|██▍       | 19/77 [00:25<01:23,  1.44s/it][A
 26%|██▌       | 20/77 [00:25<01:11,  1.26s/it][A
 27%|██▋       | 21/77 [00:26<01:05,  1.17s/it][A
 29%|██▊       | 22/77 [00:28<01:10,  1.28s/it][A
 30%|██▉       | 23/77 [00:30<01:19,  1.48s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.43s/it][A
 32%|███▏      | 25/77 [00:33<01:12,  1.40s/it][A
 34%|███▍      | 26/77 [00:34<01:04,  1.27s/it][A
 35%|███▌      | 27/77 [00:35<01:06,  1.32s/it][A
 36%|███▋      | 28/77 [00:36<01:01,  1.25s/it][A
 38%|███▊      | 29/77 [00:38<01:07,  1.41s/it][A
 39%|███▉      | 30/77 [00:40<01:11,  1.51s/it][A
 40%|████      | 31/77 [00:41<01:11,  1.55s/it][A
 42%|████▏     | 32/77 [00:43<01:09,  1.55s/it][A
 43%|████▎     | 33/77 [00:44<01:06,  1.52s/it][A
 44%|████▍     | 34/77 [00:46<01:05,  1.53s/it][A
 45%|████▌     | 35/77 [00:47<01:02,  1.49s/it][A
 47%|████▋     | 36/77 [00:49<01:03,  1.56s/it][A
 48%|████▊     | 37/77 [00:50<00:57,  1.43s/it][A
 49%|████▉     | 38/77 [00:51<00:52,  1.34s/it][A
 51%|█████     | 39/77 [00:53<00:57,  1.52s/it][A
 52%|█████▏    | 40/77 [00:55<00:57,  1.55s/it][A
 53%|█████▎    | 41/77 [00:56<00:50,  1.40s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.42s/it][A
 56%|█████▌    | 43/77 [00:59<00:52,  1.54s/it][A
 57%|█████▋    | 44/77 [01:00<00:46,  1.41s/it][A
 58%|█████▊    | 45/77 [01:01<00:41,  1.29s/it][A
 60%|█████▉    | 46/77 [01:02<00:40,  1.31s/it][A
 61%|██████    | 47/77 [01:04<00:37,  1.26s/it][A
 62%|██████▏   | 48/77 [01:05<00:39,  1.37s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.40s/it][A
 65%|██████▍   | 50/77 [01:08<00:38,  1.42s/it][A
 66%|██████▌   | 51/77 [01:10<00:39,  1.54s/it][A
 68%|██████▊   | 52/77 [01:12<00:38,  1.54s/it][A
 69%|██████▉   | 53/77 [01:13<00:39,  1.65s/it][A
 70%|███████   | 54/77 [01:15<00:35,  1.55s/it][A
 71%|███████▏  | 55/77 [01:16<00:31,  1.45s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.68s/it][A
 74%|███████▍  | 57/77 [01:20<00:31,  1.57s/it][A
 75%|███████▌  | 58/77 [01:21<00:30,  1.59s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.58s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.42s/it][A
 79%|███████▉  | 61/77 [01:25<00:23,  1.50s/it][A
 81%|████████  | 62/77 [01:27<00:22,  1.47s/it][A
 82%|████████▏ | 63/77 [01:29<00:21,  1.54s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.43s/it][A
 84%|████████▍ | 65/77 [01:31<00:17,  1.42s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.56s/it][A
 87%|████████▋ | 67/77 [01:34<00:12,  1.30s/it][A
 88%|████████▊ | 68/77 [01:36<00:13,  1.47s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.46s/it][A
 91%|█████████ | 70/77 [01:38<00:09,  1.39s/it][A
 92%|█████████▏| 71/77 [01:39<00:07,  1.29s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.32s/it][A
 95%|█████████▍| 73/77 [01:42<00:05,  1.43s/it][A
 96%|█████████▌| 74/77 [01:44<00:04,  1.60s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.55s/it][A
 99%|█████████▊| 76/77 [01:47<00:01,  1.49s/it][A
100%|██████████| 77/77 [01:49<00:00,  1.53s/it][A                                                   
                                               [A{'eval_loss': 0.5190957188606262, 'eval_runtime': 110.6606, 'eval_samples_per_second': 11.043, 'eval_steps_per_second': 0.696, 'eval_rewards/chosen': -0.5079150795936584, 'eval_rewards/rejected': -1.5735841989517212, 'eval_rewards/accuracies': 0.798701286315918, 'eval_rewards/margins': 1.065669298171997, 'eval_logps/rejected': -54.98898696899414, 'eval_logps/chosen': -43.58800506591797, 'eval_logits/rejected': -0.4617682695388794, 'eval_logits/chosen': -0.4622754156589508, 'epoch': 0.39}
 39%|███▉      | 1000/2552 [48:01<36:41,  1.42s/it]
100%|██████████| 77/77 [01:49<00:00,  1.53s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 39%|███▉      | 1001/2552 [48:29<18:24:37, 42.73s/it] 39%|███▉      | 1002/2552 [48:31<13:03:20, 30.32s/it] 39%|███▉      | 1003/2552 [48:32<9:18:22, 21.63s/it]  39%|███▉      | 1004/2552 [48:33<6:41:42, 15.57s/it] 39%|███▉      | 1005/2552 [48:35<4:50:30, 11.27s/it] 39%|███▉      | 1006/2552 [48:36<3:35:00,  8.34s/it] 39%|███▉      | 1007/2552 [48:37<2:40:10,  6.22s/it] 39%|███▉      | 1008/2552 [48:39<2:01:44,  4.73s/it] 40%|███▉      | 1009/2552 [48:40<1:36:52,  3.77s/it] 40%|███▉      | 1010/2552 [48:41<1:18:02,  3.04s/it]                                                     {'loss': 0.5021, 'grad_norm': 11.620721817016602, 'learning_rate': 3.0211598746081506e-05, 'rewards/chosen': -0.08329172432422638, 'rewards/rejected': -1.513868808746338, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.430577039718628, 'logps/rejected': -56.914306640625, 'logps/chosen': -35.04998016357422, 'logits/rejected': -0.5518806576728821, 'logits/chosen': -0.5304684042930603, 'epoch': 0.4}
 40%|███▉      | 1010/2552 [48:42<1:18:02,  3.04s/it] 40%|███▉      | 1011/2552 [48:43<1:04:42,  2.52s/it] 40%|███▉      | 1012/2552 [48:44<54:49,  2.14s/it]   40%|███▉      | 1013/2552 [48:45<48:09,  1.88s/it] 40%|███▉      | 1014/2552 [48:46<42:48,  1.67s/it] 40%|███▉      | 1015/2552 [48:48<41:15,  1.61s/it] 40%|███▉      | 1016/2552 [48:49<40:11,  1.57s/it] 40%|███▉      | 1017/2552 [48:51<37:30,  1.47s/it] 40%|███▉      | 1018/2552 [48:52<38:39,  1.51s/it] 40%|███▉      | 1019/2552 [48:54<37:33,  1.47s/it] 40%|███▉      | 1020/2552 [48:55<36:28,  1.43s/it]                                                   {'loss': 0.5391, 'grad_norm': 5.699512004852295, 'learning_rate': 3.0015673981191224e-05, 'rewards/chosen': -0.9609378576278687, 'rewards/rejected': -1.6094871759414673, 'rewards/accuracies': 0.5, 'rewards/margins': 0.6485494375228882, 'logps/rejected': -64.38574981689453, 'logps/chosen': -41.331382751464844, 'logits/rejected': -0.6655874848365784, 'logits/chosen': -0.626678466796875, 'epoch': 0.4}
 40%|███▉      | 1020/2552 [48:55<36:28,  1.43s/it] 40%|████      | 1021/2552 [48:57<37:27,  1.47s/it] 40%|████      | 1022/2552 [48:58<35:44,  1.40s/it] 40%|████      | 1023/2552 [48:59<37:19,  1.46s/it] 40%|████      | 1024/2552 [49:01<35:52,  1.41s/it] 40%|████      | 1025/2552 [49:02<34:23,  1.35s/it] 40%|████      | 1026/2552 [49:03<33:57,  1.34s/it] 40%|████      | 1027/2552 [49:04<33:10,  1.31s/it] 40%|████      | 1028/2552 [49:06<33:05,  1.30s/it] 40%|████      | 1029/2552 [49:07<33:13,  1.31s/it] 40%|████      | 1030/2552 [49:09<34:17,  1.35s/it]                                                   {'loss': 0.5204, 'grad_norm': 10.283027648925781, 'learning_rate': 2.981974921630094e-05, 'rewards/chosen': -0.05478914827108383, 'rewards/rejected': -1.758405327796936, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.7036161422729492, 'logps/rejected': -70.29398345947266, 'logps/chosen': -55.3985595703125, 'logits/rejected': -0.6204451322555542, 'logits/chosen': -0.605839729309082, 'epoch': 0.4}
 40%|████      | 1030/2552 [49:09<34:17,  1.35s/it] 40%|████      | 1031/2552 [49:10<33:49,  1.33s/it] 40%|████      | 1032/2552 [49:11<36:20,  1.43s/it] 40%|████      | 1033/2552 [49:13<35:07,  1.39s/it] 41%|████      | 1034/2552 [49:14<34:04,  1.35s/it] 41%|████      | 1035/2552 [49:15<33:59,  1.34s/it] 41%|████      | 1036/2552 [49:17<33:42,  1.33s/it] 41%|████      | 1037/2552 [49:18<35:18,  1.40s/it] 41%|████      | 1038/2552 [49:20<36:49,  1.46s/it] 41%|████      | 1039/2552 [49:21<35:52,  1.42s/it] 41%|████      | 1040/2552 [49:23<36:42,  1.46s/it]                                                   {'loss': 0.6422, 'grad_norm': 14.700577735900879, 'learning_rate': 2.962382445141066e-05, 'rewards/chosen': -0.22344568371772766, 'rewards/rejected': -1.527574896812439, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.3041292428970337, 'logps/rejected': -60.954017639160156, 'logps/chosen': -45.15879440307617, 'logits/rejected': -0.6670104265213013, 'logits/chosen': -0.653584361076355, 'epoch': 0.41}
 41%|████      | 1040/2552 [49:23<36:42,  1.46s/it] 41%|████      | 1041/2552 [49:24<37:31,  1.49s/it] 41%|████      | 1042/2552 [49:26<35:41,  1.42s/it] 41%|████      | 1043/2552 [49:27<36:12,  1.44s/it] 41%|████      | 1044/2552 [49:29<37:36,  1.50s/it] 41%|████      | 1045/2552 [49:30<35:35,  1.42s/it] 41%|████      | 1046/2552 [49:31<35:46,  1.43s/it] 41%|████      | 1047/2552 [49:33<36:11,  1.44s/it] 41%|████      | 1048/2552 [49:34<35:33,  1.42s/it] 41%|████      | 1049/2552 [49:36<36:33,  1.46s/it] 41%|████      | 1050/2552 [49:37<36:21,  1.45s/it]                                                   {'loss': 0.4864, 'grad_norm': 11.921950340270996, 'learning_rate': 2.9427899686520377e-05, 'rewards/chosen': -0.7332350015640259, 'rewards/rejected': -1.654518723487854, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 0.9212838411331177, 'logps/rejected': -46.986351013183594, 'logps/chosen': -41.752220153808594, 'logits/rejected': -0.6390048861503601, 'logits/chosen': -0.6358684301376343, 'epoch': 0.41}
 41%|████      | 1050/2552 [49:37<36:21,  1.45s/it] 41%|████      | 1051/2552 [49:39<36:03,  1.44s/it] 41%|████      | 1052/2552 [49:40<35:43,  1.43s/it] 41%|████▏     | 1053/2552 [49:41<35:19,  1.41s/it] 41%|████▏     | 1054/2552 [49:43<35:01,  1.40s/it] 41%|████▏     | 1055/2552 [49:44<33:39,  1.35s/it] 41%|████▏     | 1056/2552 [49:45<34:44,  1.39s/it] 41%|████▏     | 1057/2552 [49:47<36:04,  1.45s/it] 41%|████▏     | 1058/2552 [49:49<37:44,  1.52s/it] 41%|████▏     | 1059/2552 [49:50<35:48,  1.44s/it] 42%|████▏     | 1060/2552 [49:51<34:44,  1.40s/it]                                                   {'loss': 0.6192, 'grad_norm': 17.652944564819336, 'learning_rate': 2.9231974921630095e-05, 'rewards/chosen': -1.0809142589569092, 'rewards/rejected': -1.1861279010772705, 'rewards/accuracies': 0.5, 'rewards/margins': 0.10521364212036133, 'logps/rejected': -23.330608367919922, 'logps/chosen': -56.52544021606445, 'logits/rejected': -0.49981674551963806, 'logits/chosen': -0.5735081434249878, 'epoch': 0.42}
 42%|████▏     | 1060/2552 [49:51<34:44,  1.40s/it] 42%|████▏     | 1061/2552 [49:53<36:03,  1.45s/it] 42%|████▏     | 1062/2552 [49:54<35:30,  1.43s/it] 42%|████▏     | 1063/2552 [49:55<33:43,  1.36s/it] 42%|████▏     | 1064/2552 [49:57<33:20,  1.34s/it] 42%|████▏     | 1065/2552 [49:58<32:54,  1.33s/it] 42%|████▏     | 1066/2552 [49:59<33:06,  1.34s/it] 42%|████▏     | 1067/2552 [50:01<33:26,  1.35s/it] 42%|████▏     | 1068/2552 [50:02<34:06,  1.38s/it] 42%|████▏     | 1069/2552 [50:04<34:05,  1.38s/it] 42%|████▏     | 1070/2552 [50:05<33:43,  1.37s/it]                                                   {'loss': 0.5031, 'grad_norm': 7.134093761444092, 'learning_rate': 2.9036050156739813e-05, 'rewards/chosen': -0.5831606984138489, 'rewards/rejected': -1.8073650598526, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.2242045402526855, 'logps/rejected': -60.48814010620117, 'logps/chosen': -74.73821258544922, 'logits/rejected': -0.6499615907669067, 'logits/chosen': -0.6694322228431702, 'epoch': 0.42}
 42%|████▏     | 1070/2552 [50:05<33:43,  1.37s/it] 42%|████▏     | 1071/2552 [50:06<35:14,  1.43s/it] 42%|████▏     | 1072/2552 [50:08<34:50,  1.41s/it] 42%|████▏     | 1073/2552 [50:09<33:51,  1.37s/it] 42%|████▏     | 1074/2552 [50:11<35:30,  1.44s/it] 42%|████▏     | 1075/2552 [50:12<35:31,  1.44s/it] 42%|████▏     | 1076/2552 [50:13<34:33,  1.40s/it] 42%|████▏     | 1077/2552 [50:15<35:29,  1.44s/it] 42%|████▏     | 1078/2552 [50:16<35:06,  1.43s/it] 42%|████▏     | 1079/2552 [50:18<36:05,  1.47s/it] 42%|████▏     | 1080/2552 [50:19<35:14,  1.44s/it]                                                   {'loss': 0.5373, 'grad_norm': 10.817834854125977, 'learning_rate': 2.884012539184953e-05, 'rewards/chosen': -0.2900586724281311, 'rewards/rejected': -1.4387538433074951, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.1486952304840088, 'logps/rejected': -68.96859741210938, 'logps/chosen': -44.74052047729492, 'logits/rejected': -0.4798964858055115, 'logits/chosen': -0.44608965516090393, 'epoch': 0.42}
 42%|████▏     | 1080/2552 [50:19<35:14,  1.44s/it] 42%|████▏     | 1081/2552 [50:21<34:32,  1.41s/it] 42%|████▏     | 1082/2552 [50:22<34:52,  1.42s/it] 42%|████▏     | 1083/2552 [50:24<36:00,  1.47s/it] 42%|████▏     | 1084/2552 [50:25<36:08,  1.48s/it] 43%|████▎     | 1085/2552 [50:26<34:15,  1.40s/it] 43%|████▎     | 1086/2552 [50:28<33:09,  1.36s/it] 43%|████▎     | 1087/2552 [50:29<32:22,  1.33s/it] 43%|████▎     | 1088/2552 [50:30<33:54,  1.39s/it] 43%|████▎     | 1089/2552 [50:32<34:28,  1.41s/it] 43%|████▎     | 1090/2552 [50:33<34:07,  1.40s/it]                                                   {'loss': 0.5976, 'grad_norm': 12.526838302612305, 'learning_rate': 2.864420062695925e-05, 'rewards/chosen': -0.5729301571846008, 'rewards/rejected': -1.7288885116577148, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.1559584140777588, 'logps/rejected': -74.10011291503906, 'logps/chosen': -50.99068832397461, 'logits/rejected': -0.6175781488418579, 'logits/chosen': -0.6091052293777466, 'epoch': 0.43}
 43%|████▎     | 1090/2552 [50:33<34:07,  1.40s/it] 43%|████▎     | 1091/2552 [50:35<33:06,  1.36s/it] 43%|████▎     | 1092/2552 [50:36<31:40,  1.30s/it] 43%|████▎     | 1093/2552 [50:37<31:26,  1.29s/it] 43%|████▎     | 1094/2552 [50:38<31:38,  1.30s/it] 43%|████▎     | 1095/2552 [50:40<31:51,  1.31s/it] 43%|████▎     | 1096/2552 [50:41<31:23,  1.29s/it] 43%|████▎     | 1097/2552 [50:42<32:09,  1.33s/it] 43%|████▎     | 1098/2552 [50:44<31:14,  1.29s/it] 43%|████▎     | 1099/2552 [50:45<31:00,  1.28s/it] 43%|████▎     | 1100/2552 [50:46<32:53,  1.36s/it]                                                   {'loss': 0.3538, 'grad_norm': 15.355642318725586, 'learning_rate': 2.844827586206897e-05, 'rewards/chosen': 0.2241578847169876, 'rewards/rejected': -1.3697130680084229, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.593870759010315, 'logps/rejected': -54.7442512512207, 'logps/chosen': -48.730384826660156, 'logits/rejected': -0.6600807309150696, 'logits/chosen': -0.659243643283844, 'epoch': 0.43}
 43%|████▎     | 1100/2552 [50:46<32:53,  1.36s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:02,  1.20it/s][A
  4%|▍         | 3/77 [00:02<01:15,  1.02s/it][A
  5%|▌         | 4/77 [00:04<01:20,  1.11s/it][A
  6%|▋         | 5/77 [00:06<01:41,  1.41s/it][A
  8%|▊         | 6/77 [00:07<01:32,  1.30s/it][A
  9%|▉         | 7/77 [00:08<01:33,  1.33s/it][A
 10%|█         | 8/77 [00:10<01:35,  1.38s/it][A
 12%|█▏        | 9/77 [00:11<01:37,  1.43s/it][A
 13%|█▎        | 10/77 [00:12<01:28,  1.32s/it][A
 14%|█▍        | 11/77 [00:13<01:21,  1.24s/it][A
 16%|█▌        | 12/77 [00:15<01:37,  1.50s/it][A
 17%|█▋        | 13/77 [00:17<01:28,  1.39s/it][A
 18%|█▊        | 14/77 [00:18<01:23,  1.32s/it][A
 19%|█▉        | 15/77 [00:19<01:29,  1.45s/it][A
 21%|██        | 16/77 [00:20<01:16,  1.26s/it][A
 22%|██▏       | 17/77 [00:22<01:17,  1.28s/it][A
 23%|██▎       | 18/77 [00:23<01:16,  1.30s/it][A
 25%|██▍       | 19/77 [00:25<01:24,  1.45s/it][A
 26%|██▌       | 20/77 [00:26<01:12,  1.27s/it][A
 27%|██▋       | 21/77 [00:27<01:05,  1.17s/it][A
 29%|██▊       | 22/77 [00:28<01:10,  1.28s/it][A
 30%|██▉       | 23/77 [00:30<01:18,  1.46s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.43s/it][A
 32%|███▏      | 25/77 [00:33<01:12,  1.40s/it][A
 34%|███▍      | 26/77 [00:34<01:05,  1.27s/it][A
 35%|███▌      | 27/77 [00:35<01:06,  1.33s/it][A
 36%|███▋      | 28/77 [00:36<01:02,  1.27s/it][A
 38%|███▊      | 29/77 [00:38<01:08,  1.42s/it][A
 39%|███▉      | 30/77 [00:40<01:14,  1.58s/it][A
 40%|████      | 31/77 [00:42<01:13,  1.59s/it][A
 42%|████▏     | 32/77 [00:43<01:11,  1.58s/it][A
 43%|████▎     | 33/77 [00:45<01:08,  1.56s/it][A
 44%|████▍     | 34/77 [00:46<01:06,  1.55s/it][A
 45%|████▌     | 35/77 [00:48<01:03,  1.52s/it][A
 47%|████▋     | 36/77 [00:49<01:04,  1.58s/it][A
 48%|████▊     | 37/77 [00:50<00:57,  1.44s/it][A
 49%|████▉     | 38/77 [00:52<00:53,  1.37s/it][A
 51%|█████     | 39/77 [00:54<00:58,  1.53s/it][A
 52%|█████▏    | 40/77 [00:55<00:57,  1.57s/it][A
 53%|█████▎    | 41/77 [00:56<00:50,  1.41s/it][A
 55%|█████▍    | 42/77 [00:58<00:49,  1.43s/it][A
 56%|█████▌    | 43/77 [01:00<00:52,  1.55s/it][A
 57%|█████▋    | 44/77 [01:01<00:46,  1.41s/it][A
 58%|█████▊    | 45/77 [01:02<00:41,  1.29s/it][A
 60%|█████▉    | 46/77 [01:03<00:39,  1.29s/it][A
 61%|██████    | 47/77 [01:04<00:38,  1.30s/it][A
 62%|██████▏   | 48/77 [01:06<00:40,  1.40s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.42s/it][A
 65%|██████▍   | 50/77 [01:09<00:38,  1.44s/it][A
 66%|██████▌   | 51/77 [01:11<00:40,  1.56s/it][A
 68%|██████▊   | 52/77 [01:12<00:38,  1.54s/it][A
 69%|██████▉   | 53/77 [01:14<00:39,  1.63s/it][A
 70%|███████   | 54/77 [01:15<00:35,  1.53s/it][A
 71%|███████▏  | 55/77 [01:17<00:31,  1.44s/it][A
 73%|███████▎  | 56/77 [01:19<00:35,  1.69s/it][A
 74%|███████▍  | 57/77 [01:20<00:31,  1.58s/it][A
 75%|███████▌  | 58/77 [01:22<00:30,  1.60s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.59s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.42s/it][A
 79%|███████▉  | 61/77 [01:26<00:23,  1.50s/it][A
 81%|████████  | 62/77 [01:28<00:22,  1.48s/it][A
 82%|████████▏ | 63/77 [01:29<00:21,  1.53s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.42s/it][A
 84%|████████▍ | 65/77 [01:32<00:16,  1.41s/it][A
 86%|████████▌ | 66/77 [01:34<00:17,  1.57s/it][A
 87%|████████▋ | 67/77 [01:34<00:12,  1.30s/it][A
 88%|████████▊ | 68/77 [01:36<00:13,  1.47s/it][A
 90%|████████▉ | 69/77 [01:38<00:11,  1.44s/it][A
 91%|█████████ | 70/77 [01:39<00:09,  1.39s/it][A
 92%|█████████▏| 71/77 [01:40<00:07,  1.30s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.33s/it][A
 95%|█████████▍| 73/77 [01:43<00:05,  1.42s/it][A
 96%|█████████▌| 74/77 [01:45<00:04,  1.60s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.53s/it][A
 99%|█████████▊| 76/77 [01:48<00:01,  1.48s/it][A
100%|██████████| 77/77 [01:49<00:00,  1.52s/it][A                                                   
                                               [A{'eval_loss': 0.5289976000785828, 'eval_runtime': 111.1925, 'eval_samples_per_second': 10.99, 'eval_steps_per_second': 0.692, 'eval_rewards/chosen': -0.46039146184921265, 'eval_rewards/rejected': -1.4813934564590454, 'eval_rewards/accuracies': 0.7857142686843872, 'eval_rewards/margins': 1.0210020542144775, 'eval_logps/rejected': -54.06708526611328, 'eval_logps/chosen': -43.11277389526367, 'eval_logits/rejected': -0.4782250225543976, 'eval_logits/chosen': -0.477474570274353, 'epoch': 0.43}
 43%|████▎     | 1100/2552 [52:38<32:53,  1.36s/it]
100%|██████████| 77/77 [01:50<00:00,  1.52s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 43%|████▎     | 1101/2552 [53:06<17:15:02, 42.80s/it] 43%|████▎     | 1102/2552 [53:08<12:16:11, 30.46s/it] 43%|████▎     | 1103/2552 [53:09<8:45:42, 21.77s/it]  43%|████▎     | 1104/2552 [53:10<6:17:21, 15.64s/it] 43%|████▎     | 1105/2552 [53:12<4:33:01, 11.32s/it] 43%|████▎     | 1106/2552 [53:13<3:21:48,  8.37s/it] 43%|████▎     | 1107/2552 [53:14<2:31:32,  6.29s/it] 43%|████▎     | 1108/2552 [53:16<1:57:27,  4.88s/it] 43%|████▎     | 1109/2552 [53:18<1:33:24,  3.88s/it] 43%|████▎     | 1110/2552 [53:19<1:16:49,  3.20s/it]                                                     {'loss': 0.6021, 'grad_norm': 7.94413423538208, 'learning_rate': 2.8252351097178687e-05, 'rewards/chosen': -1.1276676654815674, 'rewards/rejected': -1.3349493741989136, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.20728158950805664, 'logps/rejected': -33.1398811340332, 'logps/chosen': -28.274883270263672, 'logits/rejected': -0.683014988899231, 'logits/chosen': -0.6698278784751892, 'epoch': 0.43}
 43%|████▎     | 1110/2552 [53:19<1:16:49,  3.20s/it] 44%|████▎     | 1111/2552 [53:21<1:04:06,  2.67s/it] 44%|████▎     | 1112/2552 [53:22<55:17,  2.30s/it]   44%|████▎     | 1113/2552 [53:24<50:19,  2.10s/it] 44%|████▎     | 1114/2552 [53:25<44:38,  1.86s/it] 44%|████▎     | 1115/2552 [53:26<41:02,  1.71s/it] 44%|████▎     | 1116/2552 [53:28<37:35,  1.57s/it] 44%|████▍     | 1117/2552 [53:29<35:13,  1.47s/it] 44%|████▍     | 1118/2552 [53:30<33:21,  1.40s/it] 44%|████▍     | 1119/2552 [53:31<31:49,  1.33s/it] 44%|████▍     | 1120/2552 [53:33<31:32,  1.32s/it]                                                   {'loss': 0.5429, 'grad_norm': 8.293728828430176, 'learning_rate': 2.8056426332288405e-05, 'rewards/chosen': -0.4026877284049988, 'rewards/rejected': -1.9968286752700806, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.5941412448883057, 'logps/rejected': -82.30420684814453, 'logps/chosen': -39.35492706298828, 'logits/rejected': -0.6643657684326172, 'logits/chosen': -0.6373711824417114, 'epoch': 0.44}
 44%|████▍     | 1120/2552 [53:33<31:32,  1.32s/it] 44%|████▍     | 1121/2552 [53:34<32:21,  1.36s/it] 44%|████▍     | 1122/2552 [53:35<32:37,  1.37s/it] 44%|████▍     | 1123/2552 [53:37<33:59,  1.43s/it] 44%|████▍     | 1124/2552 [53:38<32:49,  1.38s/it] 44%|████▍     | 1125/2552 [53:40<32:21,  1.36s/it] 44%|████▍     | 1126/2552 [53:41<31:27,  1.32s/it] 44%|████▍     | 1127/2552 [53:42<31:25,  1.32s/it] 44%|████▍     | 1128/2552 [53:44<33:25,  1.41s/it] 44%|████▍     | 1129/2552 [53:45<32:09,  1.36s/it] 44%|████▍     | 1130/2552 [53:46<32:28,  1.37s/it]                                                   {'loss': 0.5013, 'grad_norm': 19.064226150512695, 'learning_rate': 2.7860501567398123e-05, 'rewards/chosen': -0.5358847379684448, 'rewards/rejected': -1.5411880016326904, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.0053032636642456, 'logps/rejected': -55.18479537963867, 'logps/chosen': -28.147045135498047, 'logits/rejected': -0.6293820738792419, 'logits/chosen': -0.5681455731391907, 'epoch': 0.44}
 44%|████▍     | 1130/2552 [53:46<32:28,  1.37s/it] 44%|████▍     | 1131/2552 [53:48<33:01,  1.39s/it] 44%|████▍     | 1132/2552 [53:49<33:50,  1.43s/it] 44%|████▍     | 1133/2552 [53:51<35:35,  1.50s/it] 44%|████▍     | 1134/2552 [53:53<35:55,  1.52s/it] 44%|████▍     | 1135/2552 [53:54<36:59,  1.57s/it] 45%|████▍     | 1136/2552 [53:56<34:43,  1.47s/it] 45%|████▍     | 1137/2552 [53:57<33:28,  1.42s/it] 45%|████▍     | 1138/2552 [53:58<32:33,  1.38s/it] 45%|████▍     | 1139/2552 [53:59<31:56,  1.36s/it] 45%|████▍     | 1140/2552 [54:01<31:34,  1.34s/it]                                                   {'loss': 0.5496, 'grad_norm': 9.479463577270508, 'learning_rate': 2.7664576802507834e-05, 'rewards/chosen': -0.40216583013534546, 'rewards/rejected': -1.601820945739746, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.1996549367904663, 'logps/rejected': -56.20454025268555, 'logps/chosen': -32.942928314208984, 'logits/rejected': -0.7497636675834656, 'logits/chosen': -0.7376148700714111, 'epoch': 0.45}
 45%|████▍     | 1140/2552 [54:01<31:34,  1.34s/it] 45%|████▍     | 1141/2552 [54:02<31:14,  1.33s/it] 45%|████▍     | 1142/2552 [54:03<30:40,  1.31s/it] 45%|████▍     | 1143/2552 [54:04<29:36,  1.26s/it] 45%|████▍     | 1144/2552 [54:06<29:26,  1.25s/it] 45%|████▍     | 1145/2552 [54:07<29:50,  1.27s/it] 45%|████▍     | 1146/2552 [54:09<31:40,  1.35s/it] 45%|████▍     | 1147/2552 [54:10<31:09,  1.33s/it] 45%|████▍     | 1148/2552 [54:11<30:01,  1.28s/it] 45%|████▌     | 1149/2552 [54:12<29:19,  1.25s/it] 45%|████▌     | 1150/2552 [54:13<29:05,  1.24s/it]                                                   {'loss': 0.586, 'grad_norm': 8.226734161376953, 'learning_rate': 2.7468652037617555e-05, 'rewards/chosen': -1.4422258138656616, 'rewards/rejected': -2.251070261001587, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.8088440895080566, 'logps/rejected': -80.57989501953125, 'logps/chosen': -56.89570236206055, 'logits/rejected': -0.6053486466407776, 'logits/chosen': -0.6179501414299011, 'epoch': 0.45}
 45%|████▌     | 1150/2552 [54:13<29:05,  1.24s/it] 45%|████▌     | 1151/2552 [54:15<30:54,  1.32s/it] 45%|████▌     | 1152/2552 [54:16<32:55,  1.41s/it] 45%|████▌     | 1153/2552 [54:18<31:47,  1.36s/it] 45%|████▌     | 1154/2552 [54:19<33:02,  1.42s/it] 45%|████▌     | 1155/2552 [54:21<33:48,  1.45s/it] 45%|████▌     | 1156/2552 [54:22<33:15,  1.43s/it] 45%|████▌     | 1157/2552 [54:24<34:14,  1.47s/it] 45%|████▌     | 1158/2552 [54:25<34:09,  1.47s/it] 45%|████▌     | 1159/2552 [54:27<35:08,  1.51s/it] 45%|████▌     | 1160/2552 [54:28<33:16,  1.43s/it]                                                   {'loss': 0.612, 'grad_norm': 15.942058563232422, 'learning_rate': 2.7272727272727273e-05, 'rewards/chosen': -0.9385712742805481, 'rewards/rejected': -1.599069356918335, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.6604982614517212, 'logps/rejected': -60.8326416015625, 'logps/chosen': -50.98096466064453, 'logits/rejected': -0.4092618525028229, 'logits/chosen': -0.3840106725692749, 'epoch': 0.45}
 45%|████▌     | 1160/2552 [54:28<33:16,  1.43s/it] 45%|████▌     | 1161/2552 [54:29<32:42,  1.41s/it] 46%|████▌     | 1162/2552 [54:31<32:11,  1.39s/it] 46%|████▌     | 1163/2552 [54:32<31:08,  1.35s/it] 46%|████▌     | 1164/2552 [54:33<30:47,  1.33s/it] 46%|████▌     | 1165/2552 [54:35<31:57,  1.38s/it] 46%|████▌     | 1166/2552 [54:36<32:26,  1.40s/it] 46%|████▌     | 1167/2552 [54:38<33:50,  1.47s/it] 46%|████▌     | 1168/2552 [54:39<34:11,  1.48s/it] 46%|████▌     | 1169/2552 [54:41<34:19,  1.49s/it] 46%|████▌     | 1170/2552 [54:43<35:23,  1.54s/it]                                                   {'loss': 0.4786, 'grad_norm': 12.430946350097656, 'learning_rate': 2.707680250783699e-05, 'rewards/chosen': -0.6987602114677429, 'rewards/rejected': -1.7238314151763916, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.025071144104004, 'logps/rejected': -60.94499969482422, 'logps/chosen': -60.55437469482422, 'logits/rejected': -0.559278130531311, 'logits/chosen': -0.5590828657150269, 'epoch': 0.46}
 46%|████▌     | 1170/2552 [54:43<35:23,  1.54s/it] 46%|████▌     | 1171/2552 [54:44<33:52,  1.47s/it] 46%|████▌     | 1172/2552 [54:45<32:20,  1.41s/it] 46%|████▌     | 1173/2552 [54:47<33:49,  1.47s/it] 46%|████▌     | 1174/2552 [54:48<33:03,  1.44s/it] 46%|████▌     | 1175/2552 [54:50<34:07,  1.49s/it] 46%|████▌     | 1176/2552 [54:51<32:32,  1.42s/it] 46%|████▌     | 1177/2552 [54:53<34:05,  1.49s/it] 46%|████▌     | 1178/2552 [54:54<32:27,  1.42s/it] 46%|████▌     | 1179/2552 [54:55<30:51,  1.35s/it] 46%|████▌     | 1180/2552 [54:57<31:58,  1.40s/it]                                                   {'loss': 0.463, 'grad_norm': 6.169379234313965, 'learning_rate': 2.688087774294671e-05, 'rewards/chosen': -0.5122358798980713, 'rewards/rejected': -1.5413278341293335, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.0290918350219727, 'logps/rejected': -48.65623474121094, 'logps/chosen': -38.8787841796875, 'logits/rejected': -0.6502364873886108, 'logits/chosen': -0.648380696773529, 'epoch': 0.46}
 46%|████▌     | 1180/2552 [54:57<31:58,  1.40s/it] 46%|████▋     | 1181/2552 [54:58<34:26,  1.51s/it] 46%|████▋     | 1182/2552 [55:00<35:32,  1.56s/it] 46%|████▋     | 1183/2552 [55:01<34:47,  1.53s/it] 46%|████▋     | 1184/2552 [55:03<33:25,  1.47s/it] 46%|████▋     | 1185/2552 [55:04<31:35,  1.39s/it] 46%|████▋     | 1186/2552 [55:05<31:05,  1.37s/it] 47%|████▋     | 1187/2552 [55:07<30:16,  1.33s/it] 47%|████▋     | 1188/2552 [55:08<32:10,  1.42s/it] 47%|████▋     | 1189/2552 [55:10<31:41,  1.39s/it] 47%|████▋     | 1190/2552 [55:11<32:17,  1.42s/it]                                                   {'loss': 0.6109, 'grad_norm': 8.860282897949219, 'learning_rate': 2.6684952978056427e-05, 'rewards/chosen': -0.8163164854049683, 'rewards/rejected': -1.746455430984497, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.930138885974884, 'logps/rejected': -53.29601287841797, 'logps/chosen': -31.247243881225586, 'logits/rejected': -0.5744460821151733, 'logits/chosen': -0.554155170917511, 'epoch': 0.47}
 47%|████▋     | 1190/2552 [55:11<32:17,  1.42s/it] 47%|████▋     | 1191/2552 [55:12<32:03,  1.41s/it] 47%|████▋     | 1192/2552 [55:14<33:07,  1.46s/it] 47%|████▋     | 1193/2552 [55:15<32:00,  1.41s/it] 47%|████▋     | 1194/2552 [55:17<31:58,  1.41s/it] 47%|████▋     | 1195/2552 [55:18<31:02,  1.37s/it] 47%|████▋     | 1196/2552 [55:19<29:55,  1.32s/it] 47%|████▋     | 1197/2552 [55:21<29:50,  1.32s/it] 47%|████▋     | 1198/2552 [55:22<31:31,  1.40s/it] 47%|████▋     | 1199/2552 [55:24<32:22,  1.44s/it] 47%|████▋     | 1200/2552 [55:25<31:39,  1.40s/it]                                                   {'loss': 0.4731, 'grad_norm': 6.370964527130127, 'learning_rate': 2.6489028213166144e-05, 'rewards/chosen': -0.23491303622722626, 'rewards/rejected': -1.560146450996399, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.3252335786819458, 'logps/rejected': -44.2701301574707, 'logps/chosen': -33.174896240234375, 'logits/rejected': -0.5052143335342407, 'logits/chosen': -0.4870383143424988, 'epoch': 0.47}
 47%|████▋     | 1200/2552 [55:25<31:39,  1.40s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:03,  1.18it/s][A
  4%|▍         | 3/77 [00:02<01:15,  1.01s/it][A
  5%|▌         | 4/77 [00:04<01:20,  1.11s/it][A
  6%|▋         | 5/77 [00:06<01:41,  1.41s/it][A
  8%|▊         | 6/77 [00:07<01:32,  1.30s/it][A
  9%|▉         | 7/77 [00:08<01:32,  1.32s/it][A
 10%|█         | 8/77 [00:10<01:33,  1.36s/it][A
 12%|█▏        | 9/77 [00:11<01:37,  1.43s/it][A
 13%|█▎        | 10/77 [00:12<01:27,  1.31s/it][A
 14%|█▍        | 11/77 [00:13<01:21,  1.23s/it][A
 16%|█▌        | 12/77 [00:15<01:34,  1.46s/it][A
 17%|█▋        | 13/77 [00:16<01:28,  1.38s/it][A
 18%|█▊        | 14/77 [00:18<01:23,  1.32s/it][A
 19%|█▉        | 15/77 [00:19<01:27,  1.41s/it][A
 21%|██        | 16/77 [00:20<01:15,  1.24s/it][A
 22%|██▏       | 17/77 [00:21<01:15,  1.26s/it][A
 23%|██▎       | 18/77 [00:23<01:16,  1.30s/it][A
 25%|██▍       | 19/77 [00:25<01:24,  1.45s/it][A
 26%|██▌       | 20/77 [00:25<01:12,  1.27s/it][A
 27%|██▋       | 21/77 [00:26<01:06,  1.18s/it][A
 29%|██▊       | 22/77 [00:28<01:11,  1.29s/it][A
 30%|██▉       | 23/77 [00:30<01:19,  1.46s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.43s/it][A
 32%|███▏      | 25/77 [00:32<01:12,  1.39s/it][A
 34%|███▍      | 26/77 [00:33<01:05,  1.28s/it][A
 35%|███▌      | 27/77 [00:35<01:06,  1.34s/it][A
 36%|███▋      | 28/77 [00:36<01:01,  1.26s/it][A
 38%|███▊      | 29/77 [00:38<01:08,  1.43s/it][A
 39%|███▉      | 30/77 [00:40<01:11,  1.53s/it][A
 40%|████      | 31/77 [00:41<01:11,  1.56s/it][A
 42%|████▏     | 32/77 [00:43<01:09,  1.56s/it][A
 43%|████▎     | 33/77 [00:44<01:07,  1.53s/it][A
 44%|████▍     | 34/77 [00:46<01:05,  1.53s/it][A
 45%|████▌     | 35/77 [00:47<01:02,  1.50s/it][A
 47%|████▋     | 36/77 [00:49<01:03,  1.55s/it][A
 48%|████▊     | 37/77 [00:50<00:57,  1.43s/it][A
 49%|████▉     | 38/77 [00:51<00:52,  1.34s/it][A
 51%|█████     | 39/77 [00:53<00:56,  1.50s/it][A
 52%|█████▏    | 40/77 [00:55<00:56,  1.53s/it][A
 53%|█████▎    | 41/77 [00:56<00:49,  1.38s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.42s/it][A
 56%|█████▌    | 43/77 [00:59<00:52,  1.54s/it][A
 57%|█████▋    | 44/77 [01:00<00:46,  1.41s/it][A
 58%|█████▊    | 45/77 [01:01<00:41,  1.29s/it][A
 60%|█████▉    | 46/77 [01:03<00:40,  1.32s/it][A
 61%|██████    | 47/77 [01:04<00:38,  1.27s/it][A
 62%|██████▏   | 48/77 [01:05<00:39,  1.37s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.42s/it][A
 65%|██████▍   | 50/77 [01:08<00:38,  1.42s/it][A
 66%|██████▌   | 51/77 [01:10<00:40,  1.54s/it][A
 68%|██████▊   | 52/77 [01:12<00:38,  1.53s/it][A
 69%|██████▉   | 53/77 [01:13<00:39,  1.64s/it][A
 70%|███████   | 54/77 [01:15<00:35,  1.52s/it][A
 71%|███████▏  | 55/77 [01:16<00:31,  1.44s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.69s/it][A
 74%|███████▍  | 57/77 [01:20<00:31,  1.58s/it][A
 75%|███████▌  | 58/77 [01:21<00:30,  1.60s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.58s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.43s/it][A
 79%|███████▉  | 61/77 [01:25<00:23,  1.49s/it][A
 81%|████████  | 62/77 [01:27<00:21,  1.46s/it][A
 82%|████████▏ | 63/77 [01:29<00:21,  1.53s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.43s/it][A
 84%|████████▍ | 65/77 [01:31<00:16,  1.41s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.55s/it][A
 87%|████████▋ | 67/77 [01:34<00:12,  1.30s/it][A
 88%|████████▊ | 68/77 [01:35<00:13,  1.45s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.44s/it][A
 91%|█████████ | 70/77 [01:38<00:09,  1.39s/it][A
 92%|█████████▏| 71/77 [01:39<00:07,  1.30s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.34s/it][A
 95%|█████████▍| 73/77 [01:42<00:05,  1.45s/it][A
 96%|█████████▌| 74/77 [01:44<00:04,  1.60s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.53s/it][A
 99%|█████████▊| 76/77 [01:47<00:01,  1.49s/it][A
100%|██████████| 77/77 [01:49<00:00,  1.53s/it][A                                                   
                                               [A{'eval_loss': 0.515434741973877, 'eval_runtime': 110.563, 'eval_samples_per_second': 11.053, 'eval_steps_per_second': 0.696, 'eval_rewards/chosen': -0.5505115389823914, 'eval_rewards/rejected': -1.6344176530838013, 'eval_rewards/accuracies': 0.7857142686843872, 'eval_rewards/margins': 1.0839060544967651, 'eval_logps/rejected': -55.597320556640625, 'eval_logps/chosen': -44.01396942138672, 'eval_logits/rejected': -0.4902215003967285, 'eval_logits/chosen': -0.48714739084243774, 'epoch': 0.47}
 47%|████▋     | 1200/2552 [57:16<31:39,  1.40s/it]
100%|██████████| 77/77 [01:49<00:00,  1.53s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 47%|████▋     | 1201/2552 [57:44<16:00:01, 42.64s/it] 47%|████▋     | 1202/2552 [57:45<11:19:47, 30.21s/it] 47%|████▋     | 1203/2552 [57:46<8:04:19, 21.54s/it]  47%|████▋     | 1204/2552 [57:48<5:47:10, 15.45s/it] 47%|████▋     | 1205/2552 [57:49<4:13:13, 11.28s/it] 47%|████▋     | 1206/2552 [57:51<3:06:34,  8.32s/it] 47%|████▋     | 1207/2552 [57:52<2:18:30,  6.18s/it] 47%|████▋     | 1208/2552 [57:53<1:47:17,  4.79s/it] 47%|████▋     | 1209/2552 [57:55<1:23:45,  3.74s/it] 47%|████▋     | 1210/2552 [57:56<1:07:19,  3.01s/it]                                                     {'loss': 0.5651, 'grad_norm': 8.552888870239258, 'learning_rate': 2.6293103448275862e-05, 'rewards/chosen': -0.43932318687438965, 'rewards/rejected': -1.9159419536590576, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.4766188859939575, 'logps/rejected': -58.20268630981445, 'logps/chosen': -33.2613525390625, 'logits/rejected': -0.6285003423690796, 'logits/chosen': -0.6000655889511108, 'epoch': 0.47}
 47%|████▋     | 1210/2552 [57:56<1:07:19,  3.01s/it] 47%|████▋     | 1211/2552 [57:57<56:05,  2.51s/it]   47%|████▋     | 1212/2552 [57:58<47:04,  2.11s/it] 48%|████▊     | 1213/2552 [58:00<41:36,  1.86s/it] 48%|████▊     | 1214/2552 [58:01<39:36,  1.78s/it] 48%|████▊     | 1215/2552 [58:03<38:25,  1.72s/it] 48%|████▊     | 1216/2552 [58:04<36:34,  1.64s/it] 48%|████▊     | 1217/2552 [58:06<34:08,  1.53s/it] 48%|████▊     | 1218/2552 [58:07<31:33,  1.42s/it] 48%|████▊     | 1219/2552 [58:08<31:02,  1.40s/it] 48%|████▊     | 1220/2552 [58:09<29:59,  1.35s/it]                                                   {'loss': 0.4817, 'grad_norm': 7.886431694030762, 'learning_rate': 2.609717868338558e-05, 'rewards/chosen': -0.3791061341762543, 'rewards/rejected': -2.166818141937256, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.7877118587493896, 'logps/rejected': -78.78101348876953, 'logps/chosen': -24.31857681274414, 'logits/rejected': -0.6131259799003601, 'logits/chosen': -0.5835683941841125, 'epoch': 0.48}
 48%|████▊     | 1220/2552 [58:09<29:59,  1.35s/it] 48%|████▊     | 1221/2552 [58:11<31:58,  1.44s/it] 48%|████▊     | 1222/2552 [58:12<31:06,  1.40s/it] 48%|████▊     | 1223/2552 [58:14<31:32,  1.42s/it] 48%|████▊     | 1224/2552 [58:15<30:45,  1.39s/it] 48%|████▊     | 1225/2552 [58:17<32:28,  1.47s/it] 48%|████▊     | 1226/2552 [58:18<33:11,  1.50s/it] 48%|████▊     | 1227/2552 [58:20<33:43,  1.53s/it] 48%|████▊     | 1228/2552 [58:21<33:24,  1.51s/it] 48%|████▊     | 1229/2552 [58:23<31:05,  1.41s/it] 48%|████▊     | 1230/2552 [58:24<29:54,  1.36s/it]                                                   {'loss': 0.7164, 'grad_norm': 5.220003128051758, 'learning_rate': 2.59012539184953e-05, 'rewards/chosen': -0.8615278005599976, 'rewards/rejected': -2.037353515625, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.1758254766464233, 'logps/rejected': -70.28202056884766, 'logps/chosen': -32.8135986328125, 'logits/rejected': -0.6457693576812744, 'logits/chosen': -0.5984138250350952, 'epoch': 0.48}
 48%|████▊     | 1230/2552 [58:24<29:54,  1.36s/it] 48%|████▊     | 1231/2552 [58:25<29:57,  1.36s/it] 48%|████▊     | 1232/2552 [58:27<30:06,  1.37s/it] 48%|████▊     | 1233/2552 [58:28<29:58,  1.36s/it] 48%|████▊     | 1234/2552 [58:29<31:11,  1.42s/it] 48%|████▊     | 1235/2552 [58:31<30:27,  1.39s/it] 48%|████▊     | 1236/2552 [58:32<30:36,  1.40s/it] 48%|████▊     | 1237/2552 [58:33<30:03,  1.37s/it] 49%|████▊     | 1238/2552 [58:35<29:03,  1.33s/it] 49%|████▊     | 1239/2552 [58:36<28:41,  1.31s/it] 49%|████▊     | 1240/2552 [58:38<30:14,  1.38s/it]                                                   {'loss': 0.4767, 'grad_norm': 7.172971725463867, 'learning_rate': 2.570532915360502e-05, 'rewards/chosen': -0.5626155734062195, 'rewards/rejected': -2.2359495162963867, 'rewards/accuracies': 1.0, 'rewards/margins': 1.6733338832855225, 'logps/rejected': -81.51748657226562, 'logps/chosen': -25.598447799682617, 'logits/rejected': -0.6055535674095154, 'logits/chosen': -0.568939745426178, 'epoch': 0.49}
 49%|████▊     | 1240/2552 [58:38<30:14,  1.38s/it] 49%|████▊     | 1241/2552 [58:39<29:29,  1.35s/it] 49%|████▊     | 1242/2552 [58:40<30:31,  1.40s/it] 49%|████▊     | 1243/2552 [58:42<29:51,  1.37s/it] 49%|████▊     | 1244/2552 [58:43<29:41,  1.36s/it] 49%|████▉     | 1245/2552 [58:44<28:59,  1.33s/it] 49%|████▉     | 1246/2552 [58:45<28:11,  1.29s/it] 49%|████▉     | 1247/2552 [58:47<27:26,  1.26s/it] 49%|████▉     | 1248/2552 [58:48<28:33,  1.31s/it] 49%|████▉     | 1249/2552 [58:50<30:11,  1.39s/it] 49%|████▉     | 1250/2552 [58:51<29:28,  1.36s/it]                                                   {'loss': 0.5537, 'grad_norm': 6.030264854431152, 'learning_rate': 2.5509404388714737e-05, 'rewards/chosen': -1.1161631345748901, 'rewards/rejected': -1.239949345588684, 'rewards/accuracies': 0.5, 'rewards/margins': 0.12378610670566559, 'logps/rejected': -55.305564880371094, 'logps/chosen': -74.14389038085938, 'logits/rejected': -0.6558300256729126, 'logits/chosen': -0.6358078122138977, 'epoch': 0.49}
 49%|████▉     | 1250/2552 [58:51<29:28,  1.36s/it] 49%|████▉     | 1251/2552 [58:53<31:20,  1.45s/it] 49%|████▉     | 1252/2552 [58:54<30:05,  1.39s/it] 49%|████▉     | 1253/2552 [58:55<28:58,  1.34s/it] 49%|████▉     | 1254/2552 [58:57<31:02,  1.44s/it] 49%|████▉     | 1255/2552 [58:58<29:58,  1.39s/it] 49%|████▉     | 1256/2552 [58:59<29:01,  1.34s/it] 49%|████▉     | 1257/2552 [59:00<28:16,  1.31s/it] 49%|████▉     | 1258/2552 [59:02<29:03,  1.35s/it] 49%|████▉     | 1259/2552 [59:03<28:11,  1.31s/it] 49%|████▉     | 1260/2552 [59:04<28:30,  1.32s/it]                                                   {'loss': 0.4995, 'grad_norm': 7.534501552581787, 'learning_rate': 2.5313479623824455e-05, 'rewards/chosen': -0.17776170372962952, 'rewards/rejected': -1.7392269372940063, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.5614653825759888, 'logps/rejected': -57.418113708496094, 'logps/chosen': -23.27033805847168, 'logits/rejected': -0.6003347635269165, 'logits/chosen': -0.5831405520439148, 'epoch': 0.49}
 49%|████▉     | 1260/2552 [59:04<28:30,  1.32s/it] 49%|████▉     | 1261/2552 [59:06<28:29,  1.32s/it] 49%|████▉     | 1262/2552 [59:07<28:51,  1.34s/it] 49%|████▉     | 1263/2552 [59:09<29:28,  1.37s/it] 50%|████▉     | 1264/2552 [59:10<30:08,  1.40s/it] 50%|████▉     | 1265/2552 [59:12<30:34,  1.43s/it] 50%|████▉     | 1266/2552 [59:13<29:11,  1.36s/it] 50%|████▉     | 1267/2552 [59:14<28:26,  1.33s/it] 50%|████▉     | 1268/2552 [59:15<27:57,  1.31s/it] 50%|████▉     | 1269/2552 [59:17<30:15,  1.42s/it] 50%|████▉     | 1270/2552 [59:18<29:44,  1.39s/it]                                                   {'loss': 0.5801, 'grad_norm': 10.265213966369629, 'learning_rate': 2.5117554858934173e-05, 'rewards/chosen': -0.3486401438713074, 'rewards/rejected': -2.5746753215789795, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 2.2260353565216064, 'logps/rejected': -70.68077087402344, 'logps/chosen': -36.688045501708984, 'logits/rejected': -0.5669885873794556, 'logits/chosen': -0.5662314891815186, 'epoch': 0.5}
 50%|████▉     | 1270/2552 [59:18<29:44,  1.39s/it] 50%|████▉     | 1271/2552 [59:20<29:32,  1.38s/it] 50%|████▉     | 1272/2552 [59:21<29:00,  1.36s/it] 50%|████▉     | 1273/2552 [59:22<30:09,  1.41s/it] 50%|████▉     | 1274/2552 [59:24<29:19,  1.38s/it] 50%|████▉     | 1275/2552 [59:25<28:42,  1.35s/it] 50%|█████     | 1276/2552 [59:26<29:22,  1.38s/it] 50%|█████     | 1277/2552 [59:28<30:04,  1.42s/it] 50%|█████     | 1278/2552 [59:29<28:33,  1.35s/it] 50%|█████     | 1279/2552 [59:30<27:51,  1.31s/it] 50%|█████     | 1280/2552 [59:32<29:11,  1.38s/it]                                                   {'loss': 0.4873, 'grad_norm': 8.060158729553223, 'learning_rate': 2.4921630094043887e-05, 'rewards/chosen': -0.3936375677585602, 'rewards/rejected': -2.1466076374053955, 'rewards/accuracies': 1.0, 'rewards/margins': 1.7529700994491577, 'logps/rejected': -67.54178619384766, 'logps/chosen': -22.742036819458008, 'logits/rejected': -0.6318975687026978, 'logits/chosen': -0.556092381477356, 'epoch': 0.5}
 50%|█████     | 1280/2552 [59:32<29:11,  1.38s/it] 50%|█████     | 1281/2552 [59:33<28:44,  1.36s/it] 50%|█████     | 1282/2552 [59:35<28:43,  1.36s/it] 50%|█████     | 1283/2552 [59:36<30:25,  1.44s/it] 50%|█████     | 1284/2552 [59:37<29:06,  1.38s/it] 50%|█████     | 1285/2552 [59:39<28:19,  1.34s/it] 50%|█████     | 1286/2552 [59:40<28:05,  1.33s/it] 50%|█████     | 1287/2552 [59:42<30:04,  1.43s/it] 50%|█████     | 1288/2552 [59:43<30:15,  1.44s/it] 51%|█████     | 1289/2552 [59:45<30:04,  1.43s/it] 51%|█████     | 1290/2552 [59:46<30:40,  1.46s/it]                                                   {'loss': 0.3754, 'grad_norm': 9.83803939819336, 'learning_rate': 2.4725705329153605e-05, 'rewards/chosen': -0.5152233242988586, 'rewards/rejected': -1.6685501337051392, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.1533267498016357, 'logps/rejected': -90.31037139892578, 'logps/chosen': -37.3287239074707, 'logits/rejected': -0.7185976505279541, 'logits/chosen': -0.6959272027015686, 'epoch': 0.51}
 51%|█████     | 1290/2552 [59:46<30:40,  1.46s/it] 51%|█████     | 1291/2552 [59:47<29:34,  1.41s/it] 51%|█████     | 1292/2552 [59:49<29:22,  1.40s/it] 51%|█████     | 1293/2552 [59:50<28:09,  1.34s/it] 51%|█████     | 1294/2552 [59:51<28:17,  1.35s/it] 51%|█████     | 1295/2552 [59:53<27:47,  1.33s/it] 51%|█████     | 1296/2552 [59:54<27:30,  1.31s/it] 51%|█████     | 1297/2552 [59:55<27:31,  1.32s/it] 51%|█████     | 1298/2552 [59:57<28:55,  1.38s/it] 51%|█████     | 1299/2552 [59:58<28:44,  1.38s/it] 51%|█████     | 1300/2552 [59:59<27:46,  1.33s/it]                                                   {'loss': 0.5853, 'grad_norm': 9.587122917175293, 'learning_rate': 2.4529780564263326e-05, 'rewards/chosen': -1.4278508424758911, 'rewards/rejected': -1.6505063772201538, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.22265557944774628, 'logps/rejected': -61.166221618652344, 'logps/chosen': -65.40771484375, 'logits/rejected': -0.6958783268928528, 'logits/chosen': -0.7107001543045044, 'epoch': 0.51}
 51%|█████     | 1300/2552 [59:59<27:46,  1.33s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:04,  1.17it/s][A
  4%|▍         | 3/77 [00:02<01:15,  1.01s/it][A
  5%|▌         | 4/77 [00:04<01:20,  1.11s/it][A
  6%|▋         | 5/77 [00:06<01:42,  1.42s/it][A
  8%|▊         | 6/77 [00:07<01:31,  1.29s/it][A
  9%|▉         | 7/77 [00:08<01:31,  1.31s/it][A
 10%|█         | 8/77 [00:10<01:33,  1.35s/it][A
 12%|█▏        | 9/77 [00:11<01:36,  1.43s/it][A
 13%|█▎        | 10/77 [00:12<01:27,  1.31s/it][A
 14%|█▍        | 11/77 [00:13<01:21,  1.24s/it][A
 16%|█▌        | 12/77 [00:15<01:34,  1.46s/it][A
 17%|█▋        | 13/77 [00:16<01:28,  1.39s/it][A
 18%|█▊        | 14/77 [00:18<01:24,  1.33s/it][A
 19%|█▉        | 15/77 [00:19<01:28,  1.43s/it][A
 21%|██        | 16/77 [00:20<01:16,  1.25s/it][A
 22%|██▏       | 17/77 [00:21<01:16,  1.28s/it][A
 23%|██▎       | 18/77 [00:23<01:17,  1.32s/it][A
 25%|██▍       | 19/77 [00:25<01:24,  1.46s/it][A
 26%|██▌       | 20/77 [00:25<01:12,  1.27s/it][A
 27%|██▋       | 21/77 [00:26<01:05,  1.17s/it][A
 29%|██▊       | 22/77 [00:28<01:11,  1.29s/it][A
 30%|██▉       | 23/77 [00:30<01:20,  1.49s/it][A
 31%|███       | 24/77 [00:31<01:16,  1.44s/it][A
 32%|███▏      | 25/77 [00:33<01:13,  1.40s/it][A
 34%|███▍      | 26/77 [00:34<01:05,  1.29s/it][A
 35%|███▌      | 27/77 [00:35<01:06,  1.34s/it][A
 36%|███▋      | 28/77 [00:36<01:02,  1.28s/it][A
 38%|███▊      | 29/77 [00:38<01:07,  1.42s/it][A
 39%|███▉      | 30/77 [00:40<01:11,  1.52s/it][A
 40%|████      | 31/77 [00:41<01:11,  1.55s/it][A
 42%|████▏     | 32/77 [00:43<01:10,  1.56s/it][A
 43%|████▎     | 33/77 [00:44<01:07,  1.54s/it][A
 44%|████▍     | 34/77 [00:46<01:06,  1.54s/it][A
 45%|████▌     | 35/77 [00:47<01:03,  1.50s/it][A
 47%|████▋     | 36/77 [00:49<01:04,  1.58s/it][A
 48%|████▊     | 37/77 [00:50<00:58,  1.45s/it][A
 49%|████▉     | 38/77 [00:51<00:52,  1.36s/it][A
 51%|█████     | 39/77 [00:53<00:57,  1.52s/it][A
 52%|█████▏    | 40/77 [00:55<00:57,  1.56s/it][A
 53%|█████▎    | 41/77 [00:56<00:50,  1.40s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.42s/it][A
 56%|█████▌    | 43/77 [00:59<00:52,  1.54s/it][A
 57%|█████▋    | 44/77 [01:00<00:47,  1.43s/it][A
 58%|█████▊    | 45/77 [01:01<00:41,  1.30s/it][A
 60%|█████▉    | 46/77 [01:03<00:40,  1.30s/it][A
 61%|██████    | 47/77 [01:04<00:38,  1.28s/it][A
 62%|██████▏   | 48/77 [01:06<00:39,  1.37s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.41s/it][A
 65%|██████▍   | 50/77 [01:09<00:38,  1.43s/it][A
 66%|██████▌   | 51/77 [01:10<00:40,  1.55s/it][A
 68%|██████▊   | 52/77 [01:12<00:38,  1.54s/it][A
 69%|██████▉   | 53/77 [01:14<00:39,  1.63s/it][A
 70%|███████   | 54/77 [01:15<00:34,  1.52s/it][A
 71%|███████▏  | 55/77 [01:16<00:31,  1.44s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.68s/it][A
 74%|███████▍  | 57/77 [01:20<00:31,  1.57s/it][A
 75%|███████▌  | 58/77 [01:21<00:30,  1.60s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.59s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.42s/it][A
 79%|███████▉  | 61/77 [01:26<00:23,  1.49s/it][A
 81%|████████  | 62/77 [01:27<00:22,  1.47s/it][A
 82%|████████▏ | 63/77 [01:29<00:21,  1.54s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.42s/it][A
 84%|████████▍ | 65/77 [01:31<00:17,  1.42s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.57s/it][A
 87%|████████▋ | 67/77 [01:34<00:13,  1.30s/it][A
 88%|████████▊ | 68/77 [01:36<00:13,  1.47s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.47s/it][A
 91%|█████████ | 70/77 [01:39<00:09,  1.40s/it][A
 92%|█████████▏| 71/77 [01:40<00:07,  1.30s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.34s/it][A
 95%|█████████▍| 73/77 [01:43<00:05,  1.45s/it][A
 96%|█████████▌| 74/77 [01:45<00:04,  1.62s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.55s/it][A
 99%|█████████▊| 76/77 [01:48<00:01,  1.49s/it][A
100%|██████████| 77/77 [01:49<00:00,  1.54s/it][A                                                   
                                               [A{'eval_loss': 0.5332258939743042, 'eval_runtime': 111.0089, 'eval_samples_per_second': 11.008, 'eval_steps_per_second': 0.694, 'eval_rewards/chosen': -0.7626235485076904, 'eval_rewards/rejected': -1.8359626531600952, 'eval_rewards/accuracies': 0.7857142686843872, 'eval_rewards/margins': 1.0733389854431152, 'eval_logps/rejected': -57.61276626586914, 'eval_logps/chosen': -46.13508987426758, 'eval_logits/rejected': -0.5619999170303345, 'eval_logits/chosen': -0.5581462383270264, 'epoch': 0.51}
 51%|█████     | 1300/2552 [1:01:50<27:46,  1.33s/it]
100%|██████████| 77/77 [01:49<00:00,  1.54s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 51%|█████     | 1301/2552 [1:02:19<14:51:20, 42.75s/it] 51%|█████     | 1302/2552 [1:02:20<10:33:45, 30.42s/it] 51%|█████     | 1303/2552 [1:02:22<7:31:06, 21.67s/it]  51%|█████     | 1304/2552 [1:02:23<5:24:42, 15.61s/it] 51%|█████     | 1305/2552 [1:02:24<3:54:44, 11.29s/it] 51%|█████     | 1306/2552 [1:02:26<2:53:05,  8.33s/it] 51%|█████     | 1307/2552 [1:02:27<2:09:10,  6.23s/it] 51%|█████▏    | 1308/2552 [1:02:28<1:37:38,  4.71s/it] 51%|█████▏    | 1309/2552 [1:02:30<1:18:38,  3.80s/it] 51%|█████▏    | 1310/2552 [1:02:31<1:04:36,  3.12s/it]                                                       {'loss': 0.456, 'grad_norm': 15.538005828857422, 'learning_rate': 2.4333855799373044e-05, 'rewards/chosen': -1.1972911357879639, 'rewards/rejected': -2.23968243598938, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.042391300201416, 'logps/rejected': -63.03193283081055, 'logps/chosen': -49.19587326049805, 'logits/rejected': -0.7500404119491577, 'logits/chosen': -0.7562795281410217, 'epoch': 0.51}
 51%|█████▏    | 1310/2552 [1:02:31<1:04:36,  3.12s/it] 51%|█████▏    | 1311/2552 [1:02:33<52:52,  2.56s/it]   51%|█████▏    | 1312/2552 [1:02:34<44:53,  2.17s/it] 51%|█████▏    | 1313/2552 [1:02:35<39:46,  1.93s/it] 51%|█████▏    | 1314/2552 [1:02:37<36:26,  1.77s/it] 52%|█████▏    | 1315/2552 [1:02:38<34:56,  1.70s/it] 52%|█████▏    | 1316/2552 [1:02:40<32:23,  1.57s/it] 52%|█████▏    | 1317/2552 [1:02:41<31:49,  1.55s/it] 52%|█████▏    | 1318/2552 [1:02:42<30:09,  1.47s/it] 52%|█████▏    | 1319/2552 [1:02:44<30:20,  1.48s/it] 52%|█████▏    | 1320/2552 [1:02:45<28:47,  1.40s/it]                                                     {'loss': 0.3407, 'grad_norm': 11.23910903930664, 'learning_rate': 2.413793103448276e-05, 'rewards/chosen': -1.0329781770706177, 'rewards/rejected': -2.3428890705108643, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.3099110126495361, 'logps/rejected': -74.15995788574219, 'logps/chosen': -57.78363800048828, 'logits/rejected': -0.6930879354476929, 'logits/chosen': -0.6930714249610901, 'epoch': 0.52}
 52%|█████▏    | 1320/2552 [1:02:45<28:47,  1.40s/it] 52%|█████▏    | 1321/2552 [1:02:47<31:10,  1.52s/it] 52%|█████▏    | 1322/2552 [1:02:48<29:45,  1.45s/it] 52%|█████▏    | 1323/2552 [1:02:49<28:59,  1.42s/it] 52%|█████▏    | 1324/2552 [1:02:51<28:04,  1.37s/it] 52%|█████▏    | 1325/2552 [1:02:52<27:10,  1.33s/it] 52%|█████▏    | 1326/2552 [1:02:53<26:32,  1.30s/it] 52%|█████▏    | 1327/2552 [1:02:55<28:37,  1.40s/it] 52%|█████▏    | 1328/2552 [1:02:56<28:36,  1.40s/it] 52%|█████▏    | 1329/2552 [1:02:57<27:45,  1.36s/it] 52%|█████▏    | 1330/2552 [1:02:59<28:06,  1.38s/it]                                                     {'loss': 0.4943, 'grad_norm': 10.428055763244629, 'learning_rate': 2.3942006269592476e-05, 'rewards/chosen': -1.2281242609024048, 'rewards/rejected': -2.4465935230255127, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.2184693813323975, 'logps/rejected': -67.60746002197266, 'logps/chosen': -48.104095458984375, 'logits/rejected': -0.8098152279853821, 'logits/chosen': -0.7755609750747681, 'epoch': 0.52}
 52%|█████▏    | 1330/2552 [1:02:59<28:06,  1.38s/it] 52%|█████▏    | 1331/2552 [1:03:00<29:15,  1.44s/it] 52%|█████▏    | 1332/2552 [1:03:02<30:29,  1.50s/it] 52%|█████▏    | 1333/2552 [1:03:04<30:51,  1.52s/it] 52%|█████▏    | 1334/2552 [1:03:05<29:33,  1.46s/it] 52%|█████▏    | 1335/2552 [1:03:06<29:29,  1.45s/it] 52%|█████▏    | 1336/2552 [1:03:08<28:14,  1.39s/it] 52%|█████▏    | 1337/2552 [1:03:09<26:58,  1.33s/it] 52%|█████▏    | 1338/2552 [1:03:10<26:24,  1.31s/it] 52%|█████▏    | 1339/2552 [1:03:12<28:40,  1.42s/it] 53%|█████▎    | 1340/2552 [1:03:13<27:04,  1.34s/it]                                                     {'loss': 0.5167, 'grad_norm': 5.568069934844971, 'learning_rate': 2.3746081504702194e-05, 'rewards/chosen': -0.8145337104797363, 'rewards/rejected': -2.2528347969055176, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.4383013248443604, 'logps/rejected': -41.370826721191406, 'logps/chosen': -46.0255126953125, 'logits/rejected': -0.7204358577728271, 'logits/chosen': -0.7276875376701355, 'epoch': 0.53}
 53%|█████▎    | 1340/2552 [1:03:13<27:04,  1.34s/it] 53%|█████▎    | 1341/2552 [1:03:14<27:08,  1.35s/it] 53%|█████▎    | 1342/2552 [1:03:16<27:34,  1.37s/it] 53%|█████▎    | 1343/2552 [1:03:17<26:45,  1.33s/it] 53%|█████▎    | 1344/2552 [1:03:19<28:07,  1.40s/it] 53%|█████▎    | 1345/2552 [1:03:21<37:10,  1.85s/it] 53%|█████▎    | 1346/2552 [1:03:23<33:58,  1.69s/it] 53%|█████▎    | 1347/2552 [1:03:24<31:29,  1.57s/it] 53%|█████▎    | 1348/2552 [1:03:25<29:50,  1.49s/it] 53%|█████▎    | 1349/2552 [1:03:27<28:48,  1.44s/it] 53%|█████▎    | 1350/2552 [1:03:28<27:41,  1.38s/it]                                                     {'loss': 0.5777, 'grad_norm': 11.471874237060547, 'learning_rate': 2.3550156739811912e-05, 'rewards/chosen': -1.3008716106414795, 'rewards/rejected': -2.6617627143859863, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.3608907461166382, 'logps/rejected': -96.4476089477539, 'logps/chosen': -49.122779846191406, 'logits/rejected': -0.7027448415756226, 'logits/chosen': -0.6493719816207886, 'epoch': 0.53}
 53%|█████▎    | 1350/2552 [1:03:28<27:41,  1.38s/it] 53%|█████▎    | 1351/2552 [1:03:29<27:29,  1.37s/it] 53%|█████▎    | 1352/2552 [1:03:30<26:41,  1.33s/it] 53%|█████▎    | 1353/2552 [1:03:32<26:57,  1.35s/it] 53%|█████▎    | 1354/2552 [1:03:33<26:03,  1.31s/it] 53%|█████▎    | 1355/2552 [1:03:34<25:55,  1.30s/it] 53%|█████▎    | 1356/2552 [1:03:36<27:03,  1.36s/it] 53%|█████▎    | 1357/2552 [1:03:37<27:34,  1.38s/it] 53%|█████▎    | 1358/2552 [1:03:39<27:04,  1.36s/it] 53%|█████▎    | 1359/2552 [1:03:40<26:25,  1.33s/it] 53%|█████▎    | 1360/2552 [1:03:41<26:50,  1.35s/it]                                                     {'loss': 0.4921, 'grad_norm': 9.62871265411377, 'learning_rate': 2.335423197492163e-05, 'rewards/chosen': -0.3850707411766052, 'rewards/rejected': -2.0949819087982178, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.7099111080169678, 'logps/rejected': -69.20518493652344, 'logps/chosen': -35.80113220214844, 'logits/rejected': -0.6269798874855042, 'logits/chosen': -0.5699499845504761, 'epoch': 0.53}
 53%|█████▎    | 1360/2552 [1:03:41<26:50,  1.35s/it] 53%|█████▎    | 1361/2552 [1:03:43<26:57,  1.36s/it] 53%|█████▎    | 1362/2552 [1:03:44<26:27,  1.33s/it] 53%|█████▎    | 1363/2552 [1:03:45<25:29,  1.29s/it] 53%|█████▎    | 1364/2552 [1:03:47<26:50,  1.36s/it] 53%|█████▎    | 1365/2552 [1:03:48<27:08,  1.37s/it] 54%|█████▎    | 1366/2552 [1:03:50<27:47,  1.41s/it] 54%|█████▎    | 1367/2552 [1:03:51<27:03,  1.37s/it] 54%|█████▎    | 1368/2552 [1:03:52<27:04,  1.37s/it] 54%|█████▎    | 1369/2552 [1:03:53<26:12,  1.33s/it] 54%|█████▎    | 1370/2552 [1:03:55<27:19,  1.39s/it]                                                     {'loss': 0.6701, 'grad_norm': 13.975953102111816, 'learning_rate': 2.315830721003135e-05, 'rewards/chosen': -0.7392140626907349, 'rewards/rejected': -2.3266429901123047, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.5874292850494385, 'logps/rejected': -59.072784423828125, 'logps/chosen': -36.24388885498047, 'logits/rejected': -0.48457151651382446, 'logits/chosen': -0.4543541967868805, 'epoch': 0.54}
 54%|█████▎    | 1370/2552 [1:03:55<27:19,  1.39s/it] 54%|█████▎    | 1371/2552 [1:03:56<27:51,  1.41s/it] 54%|█████▍    | 1372/2552 [1:03:58<28:59,  1.47s/it] 54%|█████▍    | 1373/2552 [1:03:59<28:54,  1.47s/it] 54%|█████▍    | 1374/2552 [1:04:01<27:32,  1.40s/it] 54%|█████▍    | 1375/2552 [1:04:02<26:42,  1.36s/it] 54%|█████▍    | 1376/2552 [1:04:03<27:05,  1.38s/it] 54%|█████▍    | 1377/2552 [1:04:05<26:25,  1.35s/it] 54%|█████▍    | 1378/2552 [1:04:06<25:54,  1.32s/it] 54%|█████▍    | 1379/2552 [1:04:08<27:27,  1.40s/it] 54%|█████▍    | 1380/2552 [1:04:09<26:12,  1.34s/it]                                                     {'loss': 0.5914, 'grad_norm': 8.354486465454102, 'learning_rate': 2.296238244514107e-05, 'rewards/chosen': -0.9034172892570496, 'rewards/rejected': -1.8617480993270874, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.9583308100700378, 'logps/rejected': -40.03410720825195, 'logps/chosen': -24.271989822387695, 'logits/rejected': -0.6391469240188599, 'logits/chosen': -0.6323814392089844, 'epoch': 0.54}
 54%|█████▍    | 1380/2552 [1:04:09<26:12,  1.34s/it] 54%|█████▍    | 1381/2552 [1:04:10<26:06,  1.34s/it] 54%|█████▍    | 1382/2552 [1:04:11<26:01,  1.33s/it] 54%|█████▍    | 1383/2552 [1:04:13<25:28,  1.31s/it] 54%|█████▍    | 1384/2552 [1:04:14<26:51,  1.38s/it] 54%|█████▍    | 1385/2552 [1:04:16<26:43,  1.37s/it] 54%|█████▍    | 1386/2552 [1:04:17<26:24,  1.36s/it] 54%|█████▍    | 1387/2552 [1:04:18<25:19,  1.30s/it] 54%|█████▍    | 1388/2552 [1:04:19<25:01,  1.29s/it] 54%|█████▍    | 1389/2552 [1:04:21<25:38,  1.32s/it] 54%|█████▍    | 1390/2552 [1:04:22<25:56,  1.34s/it]                                                     {'loss': 0.5371, 'grad_norm': 11.64487075805664, 'learning_rate': 2.2766457680250786e-05, 'rewards/chosen': -0.33621707558631897, 'rewards/rejected': -1.9507989883422852, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.614581823348999, 'logps/rejected': -65.92393493652344, 'logps/chosen': -29.643518447875977, 'logits/rejected': -0.7327553629875183, 'logits/chosen': -0.6979554891586304, 'epoch': 0.54}
 54%|█████▍    | 1390/2552 [1:04:22<25:56,  1.34s/it] 55%|█████▍    | 1391/2552 [1:04:24<26:43,  1.38s/it] 55%|█████▍    | 1392/2552 [1:04:25<26:27,  1.37s/it] 55%|█████▍    | 1393/2552 [1:04:26<25:38,  1.33s/it] 55%|█████▍    | 1394/2552 [1:04:27<25:10,  1.30s/it] 55%|█████▍    | 1395/2552 [1:04:29<26:23,  1.37s/it] 55%|█████▍    | 1396/2552 [1:04:30<27:28,  1.43s/it] 55%|█████▍    | 1397/2552 [1:04:32<27:07,  1.41s/it] 55%|█████▍    | 1398/2552 [1:04:33<25:37,  1.33s/it] 55%|█████▍    | 1399/2552 [1:04:34<24:44,  1.29s/it] 55%|█████▍    | 1400/2552 [1:04:35<24:53,  1.30s/it]                                                     {'loss': 0.7314, 'grad_norm': 6.880593776702881, 'learning_rate': 2.2570532915360504e-05, 'rewards/chosen': -0.6220730543136597, 'rewards/rejected': -1.8114557266235352, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 1.189382791519165, 'logps/rejected': -61.1754035949707, 'logps/chosen': -26.578521728515625, 'logits/rejected': -0.7410104870796204, 'logits/chosen': -0.708070695400238, 'epoch': 0.55}
 55%|█████▍    | 1400/2552 [1:04:36<24:53,  1.30s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:04,  1.17it/s][A
  4%|▍         | 3/77 [00:02<01:15,  1.02s/it][A
  5%|▌         | 4/77 [00:04<01:22,  1.12s/it][A
  6%|▋         | 5/77 [00:06<01:41,  1.42s/it][A
  8%|▊         | 6/77 [00:07<01:32,  1.30s/it][A
  9%|▉         | 7/77 [00:08<01:32,  1.32s/it][A
 10%|█         | 8/77 [00:10<01:34,  1.37s/it][A
 12%|█▏        | 9/77 [00:11<01:38,  1.45s/it][A
 13%|█▎        | 10/77 [00:12<01:28,  1.32s/it][A
 14%|█▍        | 11/77 [00:13<01:20,  1.22s/it][A
 16%|█▌        | 12/77 [00:15<01:34,  1.46s/it][A
 17%|█▋        | 13/77 [00:17<01:28,  1.38s/it][A
 18%|█▊        | 14/77 [00:18<01:22,  1.31s/it][A
 19%|█▉        | 15/77 [00:19<01:28,  1.42s/it][A
 21%|██        | 16/77 [00:20<01:16,  1.25s/it][A
 22%|██▏       | 17/77 [00:21<01:15,  1.25s/it][A
 23%|██▎       | 18/77 [00:23<01:16,  1.30s/it][A
 25%|██▍       | 19/77 [00:25<01:24,  1.46s/it][A
 26%|██▌       | 20/77 [00:25<01:11,  1.26s/it][A
 27%|██▋       | 21/77 [00:26<01:06,  1.18s/it][A
 29%|██▊       | 22/77 [00:28<01:11,  1.29s/it][A
 30%|██▉       | 23/77 [00:30<01:19,  1.48s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.43s/it][A
 32%|███▏      | 25/77 [00:33<01:12,  1.40s/it][A
 34%|███▍      | 26/77 [00:34<01:04,  1.27s/it][A
 35%|███▌      | 27/77 [00:35<01:06,  1.33s/it][A
 36%|███▋      | 28/77 [00:36<01:01,  1.26s/it][A
 38%|███▊      | 29/77 [00:38<01:07,  1.41s/it][A
 39%|███▉      | 30/77 [00:40<01:11,  1.52s/it][A
 40%|████      | 31/77 [00:41<01:11,  1.55s/it][A
 42%|████▏     | 32/77 [00:43<01:10,  1.56s/it][A
 43%|████▎     | 33/77 [00:44<01:06,  1.52s/it][A
 44%|████▍     | 34/77 [00:46<01:05,  1.52s/it][A
 45%|████▌     | 35/77 [00:47<01:02,  1.49s/it][A
 47%|████▋     | 36/77 [00:49<01:03,  1.55s/it][A
 48%|████▊     | 37/77 [00:50<00:57,  1.45s/it][A
 49%|████▉     | 38/77 [00:51<00:52,  1.34s/it][A
 51%|█████     | 39/77 [00:53<00:57,  1.50s/it][A
 52%|█████▏    | 40/77 [00:55<00:56,  1.54s/it][A
 53%|█████▎    | 41/77 [00:56<00:50,  1.39s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.41s/it][A
 56%|█████▌    | 43/77 [00:59<00:52,  1.54s/it][A
 57%|█████▋    | 44/77 [01:00<00:46,  1.41s/it][A
 58%|█████▊    | 45/77 [01:01<00:41,  1.29s/it][A
 60%|█████▉    | 46/77 [01:03<00:40,  1.29s/it][A
 61%|██████    | 47/77 [01:04<00:38,  1.29s/it][A
 62%|██████▏   | 48/77 [01:05<00:39,  1.37s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.40s/it][A
 65%|██████▍   | 50/77 [01:08<00:38,  1.42s/it][A
 66%|██████▌   | 51/77 [01:10<00:39,  1.54s/it][A
 68%|██████▊   | 52/77 [01:12<00:38,  1.52s/it][A
 69%|██████▉   | 53/77 [01:13<00:39,  1.64s/it][A
 70%|███████   | 54/77 [01:15<00:35,  1.53s/it][A
 71%|███████▏  | 55/77 [01:16<00:32,  1.46s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.69s/it][A
 74%|███████▍  | 57/77 [01:20<00:31,  1.57s/it][A
 75%|███████▌  | 58/77 [01:21<00:30,  1.61s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.59s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.42s/it][A
 79%|███████▉  | 61/77 [01:26<00:23,  1.50s/it][A
 81%|████████  | 62/77 [01:27<00:22,  1.49s/it][A
 82%|████████▏ | 63/77 [01:29<00:21,  1.55s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.42s/it][A
 84%|████████▍ | 65/77 [01:31<00:17,  1.42s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.57s/it][A
 87%|████████▋ | 67/77 [01:34<00:12,  1.30s/it][A
 88%|████████▊ | 68/77 [01:36<00:13,  1.47s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.45s/it][A
 91%|█████████ | 70/77 [01:38<00:09,  1.38s/it][A
 92%|█████████▏| 71/77 [01:39<00:07,  1.31s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.33s/it][A
 95%|█████████▍| 73/77 [01:42<00:05,  1.42s/it][A
 96%|█████████▌| 74/77 [01:44<00:04,  1.59s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.54s/it][A
 99%|█████████▊| 76/77 [01:47<00:01,  1.49s/it][A
100%|██████████| 77/77 [01:49<00:00,  1.52s/it][A                                                     
                                               [A{'eval_loss': 0.5023719668388367, 'eval_runtime': 110.6399, 'eval_samples_per_second': 11.045, 'eval_steps_per_second': 0.696, 'eval_rewards/chosen': -0.4892151951789856, 'eval_rewards/rejected': -1.4711726903915405, 'eval_rewards/accuracies': 0.7922077775001526, 'eval_rewards/margins': 0.9819575548171997, 'eval_logps/rejected': -53.96487045288086, 'eval_logps/chosen': -43.401004791259766, 'eval_logits/rejected': -0.5493582487106323, 'eval_logits/chosen': -0.5467871427536011, 'epoch': 0.55}
 55%|█████▍    | 1400/2552 [1:06:26<24:53,  1.30s/it]
100%|██████████| 77/77 [01:49<00:00,  1.52s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 55%|█████▍    | 1401/2552 [1:06:55<13:38:24, 42.66s/it] 55%|█████▍    | 1402/2552 [1:06:56<9:39:47, 30.25s/it]  55%|█████▍    | 1403/2552 [1:06:57<6:52:21, 21.53s/it] 55%|█████▌    | 1404/2552 [1:06:58<4:55:47, 15.46s/it] 55%|█████▌    | 1405/2552 [1:07:00<3:35:55, 11.30s/it] 55%|█████▌    | 1406/2552 [1:07:01<2:38:04,  8.28s/it] 55%|█████▌    | 1407/2552 [1:07:03<1:58:13,  6.20s/it] 55%|█████▌    | 1408/2552 [1:07:04<1:31:02,  4.78s/it] 55%|█████▌    | 1409/2552 [1:07:06<1:13:25,  3.85s/it] 55%|█████▌    | 1410/2552 [1:07:07<58:40,  3.08s/it]                                                       {'loss': 0.4867, 'grad_norm': 10.07641887664795, 'learning_rate': 2.237460815047022e-05, 'rewards/chosen': -0.06248343735933304, 'rewards/rejected': -1.6029421091079712, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.5404587984085083, 'logps/rejected': -55.3656120300293, 'logps/chosen': -37.525428771972656, 'logits/rejected': -0.6354057192802429, 'logits/chosen': -0.6280685663223267, 'epoch': 0.55}
 55%|█████▌    | 1410/2552 [1:07:07<58:40,  3.08s/it] 55%|█████▌    | 1411/2552 [1:07:09<50:01,  2.63s/it] 55%|█████▌    | 1412/2552 [1:07:10<41:46,  2.20s/it] 55%|█████▌    | 1413/2552 [1:07:11<37:44,  1.99s/it] 55%|█████▌    | 1414/2552 [1:07:13<33:44,  1.78s/it] 55%|█████▌    | 1415/2552 [1:07:14<31:49,  1.68s/it] 55%|█████▌    | 1416/2552 [1:07:16<31:16,  1.65s/it] 56%|█████▌    | 1417/2552 [1:07:17<29:24,  1.55s/it] 56%|█████▌    | 1418/2552 [1:07:19<33:20,  1.76s/it] 56%|█████▌    | 1419/2552 [1:07:20<30:29,  1.61s/it] 56%|█████▌    | 1420/2552 [1:07:22<28:09,  1.49s/it]                                                     {'loss': 0.5334, 'grad_norm': 9.661849975585938, 'learning_rate': 2.2178683385579936e-05, 'rewards/chosen': 0.3090323805809021, 'rewards/rejected': -1.3265693187713623, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.6356017589569092, 'logps/rejected': -62.897239685058594, 'logps/chosen': -41.164100646972656, 'logits/rejected': -0.7424882650375366, 'logits/chosen': -0.7034773826599121, 'epoch': 0.56}
 56%|█████▌    | 1420/2552 [1:07:22<28:09,  1.49s/it] 56%|█████▌    | 1421/2552 [1:07:23<28:06,  1.49s/it] 56%|█████▌    | 1422/2552 [1:07:25<27:12,  1.44s/it] 56%|█████▌    | 1423/2552 [1:07:26<27:35,  1.47s/it] 56%|█████▌    | 1424/2552 [1:07:27<26:44,  1.42s/it] 56%|█████▌    | 1425/2552 [1:07:29<26:19,  1.40s/it] 56%|█████▌    | 1426/2552 [1:07:30<25:33,  1.36s/it] 56%|█████▌    | 1427/2552 [1:07:31<24:21,  1.30s/it] 56%|█████▌    | 1428/2552 [1:07:32<23:56,  1.28s/it] 56%|█████▌    | 1429/2552 [1:07:34<24:53,  1.33s/it] 56%|█████▌    | 1430/2552 [1:07:35<23:43,  1.27s/it]                                                     {'loss': 0.6378, 'grad_norm': 6.770880222320557, 'learning_rate': 2.1982758620689654e-05, 'rewards/chosen': -0.6213496923446655, 'rewards/rejected': -1.292027235031128, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 0.6706774234771729, 'logps/rejected': -62.87512969970703, 'logps/chosen': -34.100276947021484, 'logits/rejected': -0.6660417914390564, 'logits/chosen': -0.6214784383773804, 'epoch': 0.56}
 56%|█████▌    | 1430/2552 [1:07:35<23:43,  1.27s/it] 56%|█████▌    | 1431/2552 [1:07:36<24:25,  1.31s/it] 56%|█████▌    | 1432/2552 [1:07:38<26:15,  1.41s/it] 56%|█████▌    | 1433/2552 [1:07:40<27:11,  1.46s/it] 56%|█████▌    | 1434/2552 [1:07:41<26:20,  1.41s/it] 56%|█████▌    | 1435/2552 [1:07:42<26:13,  1.41s/it] 56%|█████▋    | 1436/2552 [1:07:44<25:25,  1.37s/it] 56%|█████▋    | 1437/2552 [1:07:45<26:02,  1.40s/it] 56%|█████▋    | 1438/2552 [1:07:46<26:07,  1.41s/it] 56%|█████▋    | 1439/2552 [1:07:48<25:40,  1.38s/it] 56%|█████▋    | 1440/2552 [1:07:49<24:49,  1.34s/it]                                                     {'loss': 0.3918, 'grad_norm': 6.81919527053833, 'learning_rate': 2.1786833855799376e-05, 'rewards/chosen': 0.0846659392118454, 'rewards/rejected': -1.8491714000701904, 'rewards/accuracies': 1.0, 'rewards/margins': 1.9338372945785522, 'logps/rejected': -85.88916778564453, 'logps/chosen': -43.68120193481445, 'logits/rejected': -0.7210794687271118, 'logits/chosen': -0.6783022880554199, 'epoch': 0.56}
 56%|█████▋    | 1440/2552 [1:07:49<24:49,  1.34s/it] 56%|█████▋    | 1441/2552 [1:07:50<25:03,  1.35s/it] 57%|█████▋    | 1442/2552 [1:07:52<26:13,  1.42s/it] 57%|█████▋    | 1443/2552 [1:07:53<25:39,  1.39s/it] 57%|█████▋    | 1444/2552 [1:07:55<26:05,  1.41s/it] 57%|█████▋    | 1445/2552 [1:07:56<25:19,  1.37s/it] 57%|█████▋    | 1446/2552 [1:07:58<26:26,  1.43s/it] 57%|█████▋    | 1447/2552 [1:07:59<25:31,  1.39s/it] 57%|█████▋    | 1448/2552 [1:08:00<26:14,  1.43s/it] 57%|█████▋    | 1449/2552 [1:08:02<26:07,  1.42s/it] 57%|█████▋    | 1450/2552 [1:08:03<26:36,  1.45s/it]                                                     {'loss': 0.6598, 'grad_norm': 19.183731079101562, 'learning_rate': 2.1590909090909093e-05, 'rewards/chosen': -0.7071553468704224, 'rewards/rejected': -1.7449910640716553, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.0378358364105225, 'logps/rejected': -67.96353912353516, 'logps/chosen': -49.39673614501953, 'logits/rejected': -0.5611798167228699, 'logits/chosen': -0.5638020634651184, 'epoch': 0.57}
 57%|█████▋    | 1450/2552 [1:08:03<26:36,  1.45s/it] 57%|█████▋    | 1451/2552 [1:08:05<27:18,  1.49s/it] 57%|█████▋    | 1452/2552 [1:08:06<27:16,  1.49s/it] 57%|█████▋    | 1453/2552 [1:08:08<28:38,  1.56s/it] 57%|█████▋    | 1454/2552 [1:08:10<28:16,  1.54s/it] 57%|█████▋    | 1455/2552 [1:08:11<27:36,  1.51s/it] 57%|█████▋    | 1456/2552 [1:08:12<25:57,  1.42s/it] 57%|█████▋    | 1457/2552 [1:08:13<24:55,  1.37s/it] 57%|█████▋    | 1458/2552 [1:08:15<24:03,  1.32s/it] 57%|█████▋    | 1459/2552 [1:08:16<25:11,  1.38s/it] 57%|█████▋    | 1460/2552 [1:08:18<27:56,  1.53s/it]                                                     {'loss': 0.5042, 'grad_norm': 8.577152252197266, 'learning_rate': 2.139498432601881e-05, 'rewards/chosen': -0.31905412673950195, 'rewards/rejected': -2.0066165924072266, 'rewards/accuracies': 1.0, 'rewards/margins': 1.687562346458435, 'logps/rejected': -76.87440490722656, 'logps/chosen': -25.909351348876953, 'logits/rejected': -0.6338919401168823, 'logits/chosen': -0.579179584980011, 'epoch': 0.57}
 57%|█████▋    | 1460/2552 [1:08:18<27:56,  1.53s/it] 57%|█████▋    | 1461/2552 [1:08:19<26:10,  1.44s/it] 57%|█████▋    | 1462/2552 [1:08:21<26:13,  1.44s/it] 57%|█████▋    | 1463/2552 [1:08:22<27:30,  1.52s/it] 57%|█████▋    | 1464/2552 [1:08:24<26:50,  1.48s/it] 57%|█████▋    | 1465/2552 [1:08:25<26:04,  1.44s/it] 57%|█████▋    | 1466/2552 [1:08:26<25:14,  1.39s/it] 57%|█████▋    | 1467/2552 [1:08:28<25:26,  1.41s/it] 58%|█████▊    | 1468/2552 [1:08:29<24:50,  1.38s/it] 58%|█████▊    | 1469/2552 [1:08:30<24:01,  1.33s/it] 58%|█████▊    | 1470/2552 [1:08:32<24:09,  1.34s/it]                                                     {'loss': 0.6886, 'grad_norm': 12.513750076293945, 'learning_rate': 2.119905956112853e-05, 'rewards/chosen': -0.4028693735599518, 'rewards/rejected': -1.3906580209732056, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.9877885580062866, 'logps/rejected': -57.66674041748047, 'logps/chosen': -65.36990356445312, 'logits/rejected': -0.6413657069206238, 'logits/chosen': -0.6311973929405212, 'epoch': 0.58}
 58%|█████▊    | 1470/2552 [1:08:32<24:09,  1.34s/it] 58%|█████▊    | 1471/2552 [1:08:33<24:41,  1.37s/it] 58%|█████▊    | 1472/2552 [1:08:35<24:24,  1.36s/it] 58%|█████▊    | 1473/2552 [1:08:36<25:08,  1.40s/it] 58%|█████▊    | 1474/2552 [1:08:37<24:54,  1.39s/it] 58%|█████▊    | 1475/2552 [1:08:39<24:58,  1.39s/it] 58%|█████▊    | 1476/2552 [1:08:40<25:31,  1.42s/it] 58%|█████▊    | 1477/2552 [1:08:42<25:57,  1.45s/it] 58%|█████▊    | 1478/2552 [1:08:43<24:48,  1.39s/it] 58%|█████▊    | 1479/2552 [1:08:45<25:34,  1.43s/it] 58%|█████▊    | 1480/2552 [1:08:46<24:54,  1.39s/it]                                                     {'loss': 0.6284, 'grad_norm': 10.190824508666992, 'learning_rate': 2.1003134796238247e-05, 'rewards/chosen': -0.8539514541625977, 'rewards/rejected': -1.1249970197677612, 'rewards/accuracies': 0.5, 'rewards/margins': 0.2710455060005188, 'logps/rejected': -45.97677230834961, 'logps/chosen': -44.077476501464844, 'logits/rejected': -0.6941965222358704, 'logits/chosen': -0.6942261457443237, 'epoch': 0.58}
 58%|█████▊    | 1480/2552 [1:08:46<24:54,  1.39s/it] 58%|█████▊    | 1481/2552 [1:08:47<24:05,  1.35s/it] 58%|█████▊    | 1482/2552 [1:08:49<24:05,  1.35s/it] 58%|█████▊    | 1483/2552 [1:08:50<23:57,  1.34s/it] 58%|█████▊    | 1484/2552 [1:08:51<23:18,  1.31s/it] 58%|█████▊    | 1485/2552 [1:08:52<22:30,  1.27s/it] 58%|█████▊    | 1486/2552 [1:08:54<22:42,  1.28s/it] 58%|█████▊    | 1487/2552 [1:08:55<22:55,  1.29s/it] 58%|█████▊    | 1488/2552 [1:08:56<22:45,  1.28s/it] 58%|█████▊    | 1489/2552 [1:08:58<24:05,  1.36s/it] 58%|█████▊    | 1490/2552 [1:08:59<25:01,  1.41s/it]                                                     {'loss': 0.5658, 'grad_norm': 6.042044639587402, 'learning_rate': 2.080721003134796e-05, 'rewards/chosen': -0.6739335060119629, 'rewards/rejected': -1.3674829006195068, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.693549394607544, 'logps/rejected': -55.73686599731445, 'logps/chosen': -51.15616989135742, 'logits/rejected': -0.6461468935012817, 'logits/chosen': -0.6475483179092407, 'epoch': 0.58}
 58%|█████▊    | 1490/2552 [1:08:59<25:01,  1.41s/it] 58%|█████▊    | 1491/2552 [1:09:01<25:32,  1.44s/it] 58%|█████▊    | 1492/2552 [1:09:02<25:17,  1.43s/it] 59%|█████▊    | 1493/2552 [1:09:03<24:40,  1.40s/it] 59%|█████▊    | 1494/2552 [1:09:05<25:22,  1.44s/it] 59%|█████▊    | 1495/2552 [1:09:07<26:07,  1.48s/it] 59%|█████▊    | 1496/2552 [1:09:08<24:32,  1.39s/it] 59%|█████▊    | 1497/2552 [1:09:09<25:05,  1.43s/it] 59%|█████▊    | 1498/2552 [1:09:11<24:15,  1.38s/it] 59%|█████▊    | 1499/2552 [1:09:12<23:48,  1.36s/it] 59%|█████▉    | 1500/2552 [1:09:13<23:57,  1.37s/it]                                                     {'loss': 0.4233, 'grad_norm': 7.5451202392578125, 'learning_rate': 2.061128526645768e-05, 'rewards/chosen': -0.3188706934452057, 'rewards/rejected': -1.5448135137557983, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.2259427309036255, 'logps/rejected': -58.55316162109375, 'logps/chosen': -50.159446716308594, 'logits/rejected': -0.6806565523147583, 'logits/chosen': -0.6690904498100281, 'epoch': 0.59}
 59%|█████▉    | 1500/2552 [1:09:13<23:57,  1.37s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:02,  1.20it/s][A
  4%|▍         | 3/77 [00:02<01:15,  1.02s/it][A
  5%|▌         | 4/77 [00:04<01:20,  1.10s/it][A
  6%|▋         | 5/77 [00:06<01:41,  1.41s/it][A
  8%|▊         | 6/77 [00:07<01:31,  1.29s/it][A
  9%|▉         | 7/77 [00:08<01:31,  1.31s/it][A
 10%|█         | 8/77 [00:10<01:34,  1.37s/it][A
 12%|█▏        | 9/77 [00:11<01:37,  1.43s/it][A
 13%|█▎        | 10/77 [00:12<01:27,  1.31s/it][A
 14%|█▍        | 11/77 [00:13<01:21,  1.23s/it][A
 16%|█▌        | 12/77 [00:15<01:34,  1.46s/it][A
 17%|█▋        | 13/77 [00:16<01:27,  1.37s/it][A
 18%|█▊        | 14/77 [00:18<01:22,  1.30s/it][A
 19%|█▉        | 15/77 [00:19<01:27,  1.42s/it][A
 21%|██        | 16/77 [00:20<01:15,  1.24s/it][A
 22%|██▏       | 17/77 [00:21<01:15,  1.26s/it][A
 23%|██▎       | 18/77 [00:23<01:17,  1.31s/it][A
 25%|██▍       | 19/77 [00:25<01:24,  1.45s/it][A
 26%|██▌       | 20/77 [00:25<01:11,  1.26s/it][A
 27%|██▋       | 21/77 [00:26<01:05,  1.17s/it][A
 29%|██▊       | 22/77 [00:28<01:11,  1.30s/it][A
 30%|██▉       | 23/77 [00:30<01:19,  1.47s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.43s/it][A
 32%|███▏      | 25/77 [00:32<01:13,  1.41s/it][A
 34%|███▍      | 26/77 [00:33<01:05,  1.28s/it][A
 35%|███▌      | 27/77 [00:35<01:05,  1.32s/it][A
 36%|███▋      | 28/77 [00:36<01:01,  1.26s/it][A
 38%|███▊      | 29/77 [00:38<01:07,  1.41s/it][A
 39%|███▉      | 30/77 [00:40<01:11,  1.52s/it][A
 40%|████      | 31/77 [00:41<01:11,  1.55s/it][A
 42%|████▏     | 32/77 [00:43<01:09,  1.55s/it][A
 43%|████▎     | 33/77 [00:44<01:07,  1.53s/it][A
 44%|████▍     | 34/77 [00:46<01:05,  1.53s/it][A
 45%|████▌     | 35/77 [00:47<01:03,  1.51s/it][A
 47%|████▋     | 36/77 [00:49<01:04,  1.57s/it][A
 48%|████▊     | 37/77 [00:50<00:57,  1.44s/it][A
 49%|████▉     | 38/77 [00:51<00:52,  1.36s/it][A
 51%|█████     | 39/77 [00:53<00:57,  1.51s/it][A
 52%|█████▏    | 40/77 [00:55<00:57,  1.55s/it][A
 53%|█████▎    | 41/77 [00:56<00:51,  1.43s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.40s/it][A
 56%|█████▌    | 43/77 [00:59<00:51,  1.52s/it][A
 57%|█████▋    | 44/77 [01:00<00:46,  1.41s/it][A
 58%|█████▊    | 45/77 [01:01<00:41,  1.28s/it][A
 60%|█████▉    | 46/77 [01:02<00:40,  1.30s/it][A
 61%|██████    | 47/77 [01:04<00:38,  1.27s/it][A
 62%|██████▏   | 48/77 [01:05<00:39,  1.37s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.40s/it][A
 65%|██████▍   | 50/77 [01:08<00:38,  1.42s/it][A
 66%|██████▌   | 51/77 [01:10<00:40,  1.54s/it][A
 68%|██████▊   | 52/77 [01:12<00:38,  1.53s/it][A
 69%|██████▉   | 53/77 [01:13<00:39,  1.63s/it][A
 70%|███████   | 54/77 [01:15<00:34,  1.51s/it][A
 71%|███████▏  | 55/77 [01:16<00:31,  1.43s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.68s/it][A
 74%|███████▍  | 57/77 [01:22<00:44,  2.20s/it][A
 75%|███████▌  | 58/77 [01:25<00:47,  2.50s/it][A
 77%|███████▋  | 59/77 [01:26<00:39,  2.22s/it][A
 78%|███████▊  | 60/77 [01:27<00:31,  1.87s/it][A
 79%|███████▉  | 61/77 [01:29<00:28,  1.81s/it][A
 81%|████████  | 62/77 [01:30<00:25,  1.67s/it][A
 82%|████████▏ | 63/77 [01:32<00:23,  1.67s/it][A
 83%|████████▎ | 64/77 [01:33<00:19,  1.52s/it][A
 84%|████████▍ | 65/77 [01:35<00:17,  1.48s/it][A
 86%|████████▌ | 66/77 [01:37<00:17,  1.63s/it][A
 87%|████████▋ | 67/77 [01:37<00:13,  1.34s/it][A
 88%|████████▊ | 68/77 [01:39<00:13,  1.49s/it][A
 90%|████████▉ | 69/77 [01:41<00:11,  1.47s/it][A
 91%|█████████ | 70/77 [01:42<00:09,  1.40s/it][A
 92%|█████████▏| 71/77 [01:43<00:07,  1.31s/it][A
 94%|█████████▎| 72/77 [01:44<00:06,  1.33s/it][A
 95%|█████████▍| 73/77 [01:46<00:05,  1.43s/it][A
 96%|█████████▌| 74/77 [01:48<00:04,  1.60s/it][A
 97%|█████████▋| 75/77 [01:49<00:03,  1.54s/it][A
 99%|█████████▊| 76/77 [01:51<00:01,  1.48s/it][A
100%|██████████| 77/77 [01:52<00:00,  1.53s/it][A                                                     
                                               [A{'eval_loss': 0.5001382827758789, 'eval_runtime': 114.142, 'eval_samples_per_second': 10.706, 'eval_steps_per_second': 0.675, 'eval_rewards/chosen': -0.4550734758377075, 'eval_rewards/rejected': -1.3506953716278076, 'eval_rewards/accuracies': 0.8051947951316833, 'eval_rewards/margins': 0.8956218361854553, 'eval_logps/rejected': -52.76009750366211, 'eval_logps/chosen': -43.059593200683594, 'eval_logits/rejected': -0.5239151120185852, 'eval_logits/chosen': -0.5204286575317383, 'epoch': 0.59}
 59%|█████▉    | 1500/2552 [1:11:08<23:57,  1.37s/it]
100%|██████████| 77/77 [01:53<00:00,  1.53s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 59%|█████▉    | 1501/2552 [1:11:38<12:59:42, 44.51s/it] 59%|█████▉    | 1502/2552 [1:11:40<9:12:00, 31.54s/it]  59%|█████▉    | 1503/2552 [1:11:41<6:32:54, 22.47s/it] 59%|█████▉    | 1504/2552 [1:11:42<4:41:07, 16.09s/it] 59%|█████▉    | 1505/2552 [1:11:43<3:23:04, 11.64s/it] 59%|█████▉    | 1506/2552 [1:11:45<2:31:06,  8.67s/it] 59%|█████▉    | 1507/2552 [1:11:47<1:53:44,  6.53s/it] 59%|█████▉    | 1508/2552 [1:11:48<1:27:12,  5.01s/it] 59%|█████▉    | 1509/2552 [1:11:49<1:07:33,  3.89s/it] 59%|█████▉    | 1510/2552 [1:11:51<55:30,  3.20s/it]                                                       {'loss': 0.556, 'grad_norm': 11.869322776794434, 'learning_rate': 2.04153605015674e-05, 'rewards/chosen': -1.0679477453231812, 'rewards/rejected': -1.8292315006256104, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.7612836360931396, 'logps/rejected': -72.79825592041016, 'logps/chosen': -48.49901580810547, 'logits/rejected': -0.6182612776756287, 'logits/chosen': -0.6056796312332153, 'epoch': 0.59}
 59%|█████▉    | 1510/2552 [1:11:51<55:30,  3.20s/it] 59%|█████▉    | 1511/2552 [1:11:53<46:43,  2.69s/it] 59%|█████▉    | 1512/2552 [1:11:54<39:03,  2.25s/it] 59%|█████▉    | 1513/2552 [1:11:55<33:46,  1.95s/it] 59%|█████▉    | 1514/2552 [1:11:56<30:15,  1.75s/it] 59%|█████▉    | 1515/2552 [1:11:58<28:09,  1.63s/it] 59%|█████▉    | 1516/2552 [1:11:59<26:11,  1.52s/it] 59%|█████▉    | 1517/2552 [1:12:00<25:01,  1.45s/it] 59%|█████▉    | 1518/2552 [1:12:01<24:01,  1.39s/it] 60%|█████▉    | 1519/2552 [1:12:03<23:51,  1.39s/it] 60%|█████▉    | 1520/2552 [1:12:04<22:54,  1.33s/it]                                                     {'loss': 0.5603, 'grad_norm': 12.455527305603027, 'learning_rate': 2.0219435736677118e-05, 'rewards/chosen': -0.7971407175064087, 'rewards/rejected': -1.126158595085144, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 0.3290180563926697, 'logps/rejected': -64.95140075683594, 'logps/chosen': -45.521156311035156, 'logits/rejected': -0.6434541940689087, 'logits/chosen': -0.6177669763565063, 'epoch': 0.6}
 60%|█████▉    | 1520/2552 [1:12:04<22:54,  1.33s/it] 60%|█████▉    | 1521/2552 [1:12:05<23:23,  1.36s/it] 60%|█████▉    | 1522/2552 [1:12:07<23:09,  1.35s/it] 60%|█████▉    | 1523/2552 [1:12:08<22:14,  1.30s/it] 60%|█████▉    | 1524/2552 [1:12:09<22:17,  1.30s/it] 60%|█████▉    | 1525/2552 [1:12:11<22:16,  1.30s/it] 60%|█████▉    | 1526/2552 [1:12:12<22:01,  1.29s/it] 60%|█████▉    | 1527/2552 [1:12:13<22:40,  1.33s/it] 60%|█████▉    | 1528/2552 [1:12:15<23:31,  1.38s/it] 60%|█████▉    | 1529/2552 [1:12:16<22:41,  1.33s/it] 60%|█████▉    | 1530/2552 [1:12:17<22:07,  1.30s/it]                                                     {'loss': 0.4553, 'grad_norm': 5.696438789367676, 'learning_rate': 2.0023510971786836e-05, 'rewards/chosen': -0.6180364489555359, 'rewards/rejected': -1.9707063436508179, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.3526700735092163, 'logps/rejected': -90.87938690185547, 'logps/chosen': -61.88829803466797, 'logits/rejected': -0.5827257037162781, 'logits/chosen': -0.5265536904335022, 'epoch': 0.6}
 60%|█████▉    | 1530/2552 [1:12:17<22:07,  1.30s/it] 60%|█████▉    | 1531/2552 [1:12:19<22:37,  1.33s/it] 60%|██████    | 1532/2552 [1:12:20<23:52,  1.40s/it] 60%|██████    | 1533/2552 [1:12:22<23:35,  1.39s/it] 60%|██████    | 1534/2552 [1:12:23<22:56,  1.35s/it] 60%|██████    | 1535/2552 [1:12:24<24:03,  1.42s/it] 60%|██████    | 1536/2552 [1:12:26<23:15,  1.37s/it] 60%|██████    | 1537/2552 [1:12:27<23:57,  1.42s/it] 60%|██████    | 1538/2552 [1:12:28<23:02,  1.36s/it] 60%|██████    | 1539/2552 [1:12:30<22:19,  1.32s/it] 60%|██████    | 1540/2552 [1:12:31<23:38,  1.40s/it]                                                     {'loss': 0.5579, 'grad_norm': 8.302268981933594, 'learning_rate': 1.9827586206896554e-05, 'rewards/chosen': -0.688517689704895, 'rewards/rejected': -1.5383843183517456, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.8498665690422058, 'logps/rejected': -58.5679931640625, 'logps/chosen': -42.830039978027344, 'logits/rejected': -0.4661211371421814, 'logits/chosen': -0.45667415857315063, 'epoch': 0.6}
 60%|██████    | 1540/2552 [1:12:31<23:38,  1.40s/it] 60%|██████    | 1541/2552 [1:12:33<24:30,  1.45s/it] 60%|██████    | 1542/2552 [1:12:34<24:18,  1.44s/it] 60%|██████    | 1543/2552 [1:12:36<23:44,  1.41s/it] 61%|██████    | 1544/2552 [1:12:37<24:04,  1.43s/it] 61%|██████    | 1545/2552 [1:12:38<22:46,  1.36s/it] 61%|██████    | 1546/2552 [1:12:40<23:51,  1.42s/it] 61%|██████    | 1547/2552 [1:12:41<22:49,  1.36s/it] 61%|██████    | 1548/2552 [1:12:42<22:10,  1.33s/it] 61%|██████    | 1549/2552 [1:12:43<21:39,  1.30s/it] 61%|██████    | 1550/2552 [1:12:45<22:10,  1.33s/it]                                                     {'loss': 0.5385, 'grad_norm': 6.223667144775391, 'learning_rate': 1.963166144200627e-05, 'rewards/chosen': -0.7453896403312683, 'rewards/rejected': -1.6313326358795166, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 0.8859429359436035, 'logps/rejected': -51.51525115966797, 'logps/chosen': -29.622289657592773, 'logits/rejected': -0.5508108139038086, 'logits/chosen': -0.5445011854171753, 'epoch': 0.61}
 61%|██████    | 1550/2552 [1:12:45<22:10,  1.33s/it] 61%|██████    | 1551/2552 [1:12:47<24:37,  1.48s/it] 61%|██████    | 1552/2552 [1:12:48<23:04,  1.38s/it] 61%|██████    | 1553/2552 [1:12:49<23:50,  1.43s/it] 61%|██████    | 1554/2552 [1:12:51<23:30,  1.41s/it] 61%|██████    | 1555/2552 [1:12:52<23:45,  1.43s/it] 61%|██████    | 1556/2552 [1:12:54<22:57,  1.38s/it] 61%|██████    | 1557/2552 [1:12:55<21:46,  1.31s/it] 61%|██████    | 1558/2552 [1:12:56<21:11,  1.28s/it] 61%|██████    | 1559/2552 [1:12:57<22:28,  1.36s/it] 61%|██████    | 1560/2552 [1:12:59<22:30,  1.36s/it]                                                     {'loss': 0.5317, 'grad_norm': 10.194462776184082, 'learning_rate': 1.9435736677115986e-05, 'rewards/chosen': -0.8604176640510559, 'rewards/rejected': -1.5236564874649048, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.6632387638092041, 'logps/rejected': -51.13851547241211, 'logps/chosen': -77.94354248046875, 'logits/rejected': -0.6702371835708618, 'logits/chosen': -0.6962875127792358, 'epoch': 0.61}
 61%|██████    | 1560/2552 [1:12:59<22:30,  1.36s/it] 61%|██████    | 1561/2552 [1:13:00<23:51,  1.44s/it] 61%|██████    | 1562/2552 [1:13:02<23:46,  1.44s/it] 61%|██████    | 1563/2552 [1:13:03<24:17,  1.47s/it] 61%|██████▏   | 1564/2552 [1:13:05<24:42,  1.50s/it] 61%|██████▏   | 1565/2552 [1:13:06<23:25,  1.42s/it] 61%|██████▏   | 1566/2552 [1:13:08<22:57,  1.40s/it] 61%|██████▏   | 1567/2552 [1:13:09<23:09,  1.41s/it] 61%|██████▏   | 1568/2552 [1:13:11<23:31,  1.43s/it] 61%|██████▏   | 1569/2552 [1:13:12<22:32,  1.38s/it] 62%|██████▏   | 1570/2552 [1:13:13<23:48,  1.45s/it]                                                     {'loss': 0.5444, 'grad_norm': 13.557341575622559, 'learning_rate': 1.9239811912225704e-05, 'rewards/chosen': -0.43729209899902344, 'rewards/rejected': -1.6686489582061768, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.2313567399978638, 'logps/rejected': -56.163719177246094, 'logps/chosen': -50.69858169555664, 'logits/rejected': -0.5408402681350708, 'logits/chosen': -0.5415801405906677, 'epoch': 0.62}
 62%|██████▏   | 1570/2552 [1:13:14<23:48,  1.45s/it] 62%|██████▏   | 1571/2552 [1:13:15<23:19,  1.43s/it] 62%|██████▏   | 1572/2552 [1:13:16<22:26,  1.37s/it] 62%|██████▏   | 1573/2552 [1:13:17<21:44,  1.33s/it] 62%|██████▏   | 1574/2552 [1:13:19<22:48,  1.40s/it] 62%|██████▏   | 1575/2552 [1:13:20<23:22,  1.44s/it] 62%|██████▏   | 1576/2552 [1:13:21<22:01,  1.35s/it] 62%|██████▏   | 1577/2552 [1:13:23<21:29,  1.32s/it] 62%|██████▏   | 1578/2552 [1:13:24<21:07,  1.30s/it] 62%|██████▏   | 1579/2552 [1:13:25<20:52,  1.29s/it] 62%|██████▏   | 1580/2552 [1:13:27<22:40,  1.40s/it]                                                     {'loss': 0.5321, 'grad_norm': 13.789149284362793, 'learning_rate': 1.9043887147335425e-05, 'rewards/chosen': -0.1595274806022644, 'rewards/rejected': -1.691509485244751, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.5319820642471313, 'logps/rejected': -43.96424102783203, 'logps/chosen': -24.559226989746094, 'logits/rejected': -0.6786002516746521, 'logits/chosen': -0.6538048982620239, 'epoch': 0.62}
 62%|██████▏   | 1580/2552 [1:13:27<22:40,  1.40s/it] 62%|██████▏   | 1581/2552 [1:13:28<22:31,  1.39s/it] 62%|██████▏   | 1582/2552 [1:13:30<21:51,  1.35s/it] 62%|██████▏   | 1583/2552 [1:13:31<21:22,  1.32s/it] 62%|██████▏   | 1584/2552 [1:13:32<20:43,  1.28s/it] 62%|██████▏   | 1585/2552 [1:13:33<20:48,  1.29s/it] 62%|██████▏   | 1586/2552 [1:13:35<20:39,  1.28s/it] 62%|██████▏   | 1587/2552 [1:13:36<20:32,  1.28s/it] 62%|██████▏   | 1588/2552 [1:13:37<20:25,  1.27s/it] 62%|██████▏   | 1589/2552 [1:13:38<20:37,  1.29s/it] 62%|██████▏   | 1590/2552 [1:13:40<20:42,  1.29s/it]                                                     {'loss': 0.6753, 'grad_norm': 11.739465713500977, 'learning_rate': 1.8847962382445143e-05, 'rewards/chosen': -0.34114545583724976, 'rewards/rejected': -0.9922876358032227, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.6511422395706177, 'logps/rejected': -45.50639724731445, 'logps/chosen': -51.42051315307617, 'logits/rejected': -0.6490933299064636, 'logits/chosen': -0.6468430757522583, 'epoch': 0.62}
 62%|██████▏   | 1590/2552 [1:13:40<20:42,  1.29s/it] 62%|██████▏   | 1591/2552 [1:13:41<20:56,  1.31s/it] 62%|██████▏   | 1592/2552 [1:13:42<20:01,  1.25s/it] 62%|██████▏   | 1593/2552 [1:13:43<19:54,  1.25s/it] 62%|██████▏   | 1594/2552 [1:13:45<20:10,  1.26s/it] 62%|██████▎   | 1595/2552 [1:13:46<21:18,  1.34s/it] 63%|██████▎   | 1596/2552 [1:13:48<21:54,  1.38s/it] 63%|██████▎   | 1597/2552 [1:13:49<20:41,  1.30s/it] 63%|██████▎   | 1598/2552 [1:13:50<20:21,  1.28s/it] 63%|██████▎   | 1599/2552 [1:13:51<19:48,  1.25s/it] 63%|██████▎   | 1600/2552 [1:13:52<19:27,  1.23s/it]                                                     {'loss': 0.4259, 'grad_norm': 7.588730335235596, 'learning_rate': 1.865203761755486e-05, 'rewards/chosen': -0.7410287261009216, 'rewards/rejected': -2.1157052516937256, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.3746765851974487, 'logps/rejected': -72.98164367675781, 'logps/chosen': -40.38715362548828, 'logits/rejected': -0.6626008152961731, 'logits/chosen': -0.6193375587463379, 'epoch': 0.63}
 63%|██████▎   | 1600/2552 [1:13:52<19:27,  1.23s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:04,  1.17it/s][A
  4%|▍         | 3/77 [00:02<01:16,  1.03s/it][A
  5%|▌         | 4/77 [00:04<01:22,  1.12s/it][A
  6%|▋         | 5/77 [00:06<01:42,  1.43s/it][A
  8%|▊         | 6/77 [00:07<01:32,  1.31s/it][A
  9%|▉         | 7/77 [00:08<01:32,  1.32s/it][A
 10%|█         | 8/77 [00:10<01:34,  1.37s/it][A
 12%|█▏        | 9/77 [00:11<01:38,  1.45s/it][A
 13%|█▎        | 10/77 [00:12<01:27,  1.31s/it][A
 14%|█▍        | 11/77 [00:13<01:22,  1.25s/it][A
 16%|█▌        | 12/77 [00:15<01:34,  1.46s/it][A
 17%|█▋        | 13/77 [00:17<01:28,  1.38s/it][A
 18%|█▊        | 14/77 [00:18<01:22,  1.31s/it][A
 19%|█▉        | 15/77 [00:19<01:27,  1.41s/it][A
 21%|██        | 16/77 [00:20<01:15,  1.24s/it][A
 22%|██▏       | 17/77 [00:21<01:15,  1.26s/it][A
 23%|██▎       | 18/77 [00:23<01:16,  1.30s/it][A
 25%|██▍       | 19/77 [00:25<01:24,  1.45s/it][A
 26%|██▌       | 20/77 [00:26<01:12,  1.27s/it][A
 27%|██▋       | 21/77 [00:26<01:05,  1.17s/it][A
 29%|██▊       | 22/77 [00:28<01:10,  1.29s/it][A
 30%|██▉       | 23/77 [00:30<01:19,  1.46s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.43s/it][A
 32%|███▏      | 25/77 [00:33<01:12,  1.40s/it][A
 34%|███▍      | 26/77 [00:34<01:05,  1.28s/it][A
 35%|███▌      | 27/77 [00:35<01:06,  1.33s/it][A
 36%|███▋      | 28/77 [00:36<01:02,  1.27s/it][A
 38%|███▊      | 29/77 [00:38<01:07,  1.41s/it][A
 39%|███▉      | 30/77 [00:40<01:11,  1.52s/it][A
 40%|████      | 31/77 [00:41<01:11,  1.55s/it][A
 42%|████▏     | 32/77 [00:43<01:09,  1.56s/it][A
 43%|████▎     | 33/77 [00:44<01:07,  1.54s/it][A
 44%|████▍     | 34/77 [00:46<01:06,  1.54s/it][A
 45%|████▌     | 35/77 [00:47<01:03,  1.50s/it][A
 47%|████▋     | 36/77 [00:49<01:03,  1.56s/it][A
 48%|████▊     | 37/77 [00:50<00:57,  1.43s/it][A
 49%|████▉     | 38/77 [00:51<00:52,  1.34s/it][A
 51%|█████     | 39/77 [00:53<00:57,  1.51s/it][A
 52%|█████▏    | 40/77 [00:55<00:57,  1.55s/it][A
 53%|█████▎    | 41/77 [00:56<00:50,  1.40s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.41s/it][A
 56%|█████▌    | 43/77 [00:59<00:52,  1.55s/it][A
 57%|█████▋    | 44/77 [01:00<00:46,  1.42s/it][A
 58%|█████▊    | 45/77 [01:01<00:41,  1.29s/it][A
 60%|█████▉    | 46/77 [01:03<00:42,  1.36s/it][A
 61%|██████    | 47/77 [01:04<00:38,  1.27s/it][A
 62%|██████▏   | 48/77 [01:05<00:40,  1.38s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.40s/it][A
 65%|██████▍   | 50/77 [01:08<00:38,  1.42s/it][A
 66%|██████▌   | 51/77 [01:10<00:39,  1.53s/it][A
 68%|██████▊   | 52/77 [01:12<00:38,  1.53s/it][A
 69%|██████▉   | 53/77 [01:14<00:39,  1.64s/it][A
 70%|███████   | 54/77 [01:15<00:35,  1.53s/it][A
 71%|███████▏  | 55/77 [01:16<00:31,  1.44s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.68s/it][A
 74%|███████▍  | 57/77 [01:20<00:31,  1.57s/it][A
 75%|███████▌  | 58/77 [01:21<00:30,  1.59s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.58s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.42s/it][A
 79%|███████▉  | 61/77 [01:26<00:23,  1.49s/it][A
 81%|████████  | 62/77 [01:27<00:21,  1.46s/it][A
 82%|████████▏ | 63/77 [01:29<00:21,  1.52s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.41s/it][A
 84%|████████▍ | 65/77 [01:31<00:16,  1.40s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.56s/it][A
 87%|████████▋ | 67/77 [01:34<00:12,  1.30s/it][A
 88%|████████▊ | 68/77 [01:36<00:13,  1.47s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.44s/it][A
 91%|█████████ | 70/77 [01:38<00:09,  1.37s/it][A
 92%|█████████▏| 71/77 [01:39<00:07,  1.29s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.33s/it][A
 95%|█████████▍| 73/77 [01:42<00:05,  1.43s/it][A
 96%|█████████▌| 74/77 [01:44<00:04,  1.61s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.54s/it][A
 99%|█████████▊| 76/77 [01:47<00:01,  1.48s/it][A
100%|██████████| 77/77 [01:49<00:00,  1.53s/it][A                                                     
                                               [A{'eval_loss': 0.49746787548065186, 'eval_runtime': 110.7713, 'eval_samples_per_second': 11.032, 'eval_steps_per_second': 0.695, 'eval_rewards/chosen': -0.5074564218521118, 'eval_rewards/rejected': -1.576514482498169, 'eval_rewards/accuracies': 0.7792207598686218, 'eval_rewards/margins': 1.0690580606460571, 'eval_logps/rejected': -55.018287658691406, 'eval_logps/chosen': -43.58341979980469, 'eval_logits/rejected': -0.5091453194618225, 'eval_logits/chosen': -0.5073233842849731, 'epoch': 0.63}
 63%|██████▎   | 1600/2552 [1:15:43<19:27,  1.23s/it]
100%|██████████| 77/77 [01:49<00:00,  1.53s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 63%|██████▎   | 1601/2552 [1:16:11<11:15:03, 42.59s/it] 63%|██████▎   | 1602/2552 [1:16:13<7:58:12, 30.20s/it]  63%|██████▎   | 1603/2552 [1:16:14<5:40:57, 21.56s/it] 63%|██████▎   | 1604/2552 [1:16:15<4:04:23, 15.47s/it] 63%|██████▎   | 1605/2552 [1:16:17<2:56:59, 11.21s/it] 63%|██████▎   | 1606/2552 [1:16:18<2:10:59,  8.31s/it] 63%|██████▎   | 1607/2552 [1:16:20<1:38:23,  6.25s/it] 63%|██████▎   | 1608/2552 [1:16:21<1:14:30,  4.74s/it] 63%|██████▎   | 1609/2552 [1:16:22<58:10,  3.70s/it]   63%|██████▎   | 1610/2552 [1:16:24<47:29,  3.03s/it]                                                     {'loss': 0.3954, 'grad_norm': 8.04891300201416, 'learning_rate': 1.845611285266458e-05, 'rewards/chosen': -0.3584117293357849, 'rewards/rejected': -1.6374304294586182, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.2790186405181885, 'logps/rejected': -61.64655303955078, 'logps/chosen': -32.74290466308594, 'logits/rejected': -0.6003066301345825, 'logits/chosen': -0.5916370153427124, 'epoch': 0.63}
 63%|██████▎   | 1610/2552 [1:16:24<47:29,  3.03s/it] 63%|██████▎   | 1611/2552 [1:16:25<40:05,  2.56s/it] 63%|██████▎   | 1612/2552 [1:16:27<35:35,  2.27s/it] 63%|██████▎   | 1613/2552 [1:16:28<32:21,  2.07s/it] 63%|██████▎   | 1614/2552 [1:16:29<28:12,  1.80s/it] 63%|██████▎   | 1615/2552 [1:16:31<25:55,  1.66s/it] 63%|██████▎   | 1616/2552 [1:16:32<24:43,  1.59s/it] 63%|██████▎   | 1617/2552 [1:16:34<23:44,  1.52s/it] 63%|██████▎   | 1618/2552 [1:16:35<23:50,  1.53s/it] 63%|██████▎   | 1619/2552 [1:16:36<22:31,  1.45s/it] 63%|██████▎   | 1620/2552 [1:16:38<21:29,  1.38s/it]                                                     {'loss': 0.5114, 'grad_norm': 9.3778657913208, 'learning_rate': 1.8260188087774296e-05, 'rewards/chosen': -0.8535858988761902, 'rewards/rejected': -2.562148094177246, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.7085621356964111, 'logps/rejected': -58.80200958251953, 'logps/chosen': -43.89142608642578, 'logits/rejected': -0.592787504196167, 'logits/chosen': -0.5585038065910339, 'epoch': 0.63}
 63%|██████▎   | 1620/2552 [1:16:38<21:29,  1.38s/it] 64%|██████▎   | 1621/2552 [1:16:39<22:25,  1.45s/it] 64%|██████▎   | 1622/2552 [1:16:41<23:37,  1.52s/it] 64%|██████▎   | 1623/2552 [1:16:42<23:25,  1.51s/it] 64%|██████▎   | 1624/2552 [1:16:44<22:17,  1.44s/it] 64%|██████▎   | 1625/2552 [1:16:45<22:03,  1.43s/it] 64%|██████▎   | 1626/2552 [1:16:46<20:53,  1.35s/it] 64%|██████▍   | 1627/2552 [1:16:48<20:24,  1.32s/it] 64%|██████▍   | 1628/2552 [1:16:49<20:18,  1.32s/it] 64%|██████▍   | 1629/2552 [1:16:50<21:14,  1.38s/it] 64%|██████▍   | 1630/2552 [1:16:52<20:28,  1.33s/it]                                                     {'loss': 0.6573, 'grad_norm': 17.902048110961914, 'learning_rate': 1.8064263322884014e-05, 'rewards/chosen': -1.4950907230377197, 'rewards/rejected': -2.0908443927764893, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.5957537293434143, 'logps/rejected': -58.968017578125, 'logps/chosen': -51.526031494140625, 'logits/rejected': -0.5939004421234131, 'logits/chosen': -0.5861007571220398, 'epoch': 0.64}
 64%|██████▍   | 1630/2552 [1:16:52<20:28,  1.33s/it] 64%|██████▍   | 1631/2552 [1:16:53<20:38,  1.34s/it] 64%|██████▍   | 1632/2552 [1:16:54<20:15,  1.32s/it] 64%|██████▍   | 1633/2552 [1:16:56<20:34,  1.34s/it] 64%|██████▍   | 1634/2552 [1:16:57<20:28,  1.34s/it] 64%|██████▍   | 1635/2552 [1:16:58<21:32,  1.41s/it] 64%|██████▍   | 1636/2552 [1:17:00<22:30,  1.47s/it] 64%|██████▍   | 1637/2552 [1:17:01<21:57,  1.44s/it] 64%|██████▍   | 1638/2552 [1:17:03<20:59,  1.38s/it] 64%|██████▍   | 1639/2552 [1:17:04<21:47,  1.43s/it] 64%|██████▍   | 1640/2552 [1:17:06<22:11,  1.46s/it]                                                     {'loss': 0.5023, 'grad_norm': 9.366289138793945, 'learning_rate': 1.786833855799373e-05, 'rewards/chosen': -0.21315622329711914, 'rewards/rejected': -2.522808313369751, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 2.309652090072632, 'logps/rejected': -76.8636703491211, 'logps/chosen': -29.938385009765625, 'logits/rejected': -0.6027891635894775, 'logits/chosen': -0.5477989315986633, 'epoch': 0.64}
 64%|██████▍   | 1640/2552 [1:17:06<22:11,  1.46s/it] 64%|██████▍   | 1641/2552 [1:17:07<21:09,  1.39s/it] 64%|██████▍   | 1642/2552 [1:17:08<20:59,  1.38s/it] 64%|██████▍   | 1643/2552 [1:17:10<20:33,  1.36s/it] 64%|██████▍   | 1644/2552 [1:17:11<19:56,  1.32s/it] 64%|██████▍   | 1645/2552 [1:17:12<20:13,  1.34s/it] 64%|██████▍   | 1646/2552 [1:17:14<20:28,  1.36s/it] 65%|██████▍   | 1647/2552 [1:17:15<19:46,  1.31s/it] 65%|██████▍   | 1648/2552 [1:17:16<20:37,  1.37s/it] 65%|██████▍   | 1649/2552 [1:17:18<19:55,  1.32s/it] 65%|██████▍   | 1650/2552 [1:17:19<19:17,  1.28s/it]                                                     {'loss': 0.4731, 'grad_norm': 11.847957611083984, 'learning_rate': 1.767241379310345e-05, 'rewards/chosen': -0.48229271173477173, 'rewards/rejected': -1.7461951971054077, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.2639026641845703, 'logps/rejected': -76.45035552978516, 'logps/chosen': -32.172752380371094, 'logits/rejected': -0.7519286870956421, 'logits/chosen': -0.7125516533851624, 'epoch': 0.65}
 65%|██████▍   | 1650/2552 [1:17:19<19:17,  1.28s/it] 65%|██████▍   | 1651/2552 [1:17:20<19:43,  1.31s/it] 65%|██████▍   | 1652/2552 [1:17:22<19:40,  1.31s/it] 65%|██████▍   | 1653/2552 [1:17:23<20:17,  1.35s/it] 65%|██████▍   | 1654/2552 [1:17:24<19:46,  1.32s/it] 65%|██████▍   | 1655/2552 [1:17:25<19:00,  1.27s/it] 65%|██████▍   | 1656/2552 [1:17:27<18:55,  1.27s/it] 65%|██████▍   | 1657/2552 [1:17:28<18:54,  1.27s/it] 65%|██████▍   | 1658/2552 [1:17:29<18:21,  1.23s/it] 65%|██████▌   | 1659/2552 [1:17:30<18:29,  1.24s/it] 65%|██████▌   | 1660/2552 [1:17:32<19:34,  1.32s/it]                                                     {'loss': 0.5064, 'grad_norm': 9.255239486694336, 'learning_rate': 1.7476489028213168e-05, 'rewards/chosen': -0.9446396827697754, 'rewards/rejected': -1.9275836944580078, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 0.9829440116882324, 'logps/rejected': -66.39732360839844, 'logps/chosen': -53.6368522644043, 'logits/rejected': -0.6829014420509338, 'logits/chosen': -0.6857248544692993, 'epoch': 0.65}
 65%|██████▌   | 1660/2552 [1:17:32<19:34,  1.32s/it] 65%|██████▌   | 1661/2552 [1:17:33<19:25,  1.31s/it] 65%|██████▌   | 1662/2552 [1:17:34<19:02,  1.28s/it] 65%|██████▌   | 1663/2552 [1:17:36<20:03,  1.35s/it] 65%|██████▌   | 1664/2552 [1:17:37<19:25,  1.31s/it] 65%|██████▌   | 1665/2552 [1:17:39<20:37,  1.39s/it] 65%|██████▌   | 1666/2552 [1:17:40<21:01,  1.42s/it] 65%|██████▌   | 1667/2552 [1:17:42<21:12,  1.44s/it] 65%|██████▌   | 1668/2552 [1:17:43<20:52,  1.42s/it] 65%|██████▌   | 1669/2552 [1:17:44<21:09,  1.44s/it] 65%|██████▌   | 1670/2552 [1:17:46<20:06,  1.37s/it]                                                     {'loss': 0.5695, 'grad_norm': 10.107370376586914, 'learning_rate': 1.7280564263322885e-05, 'rewards/chosen': -1.1093146800994873, 'rewards/rejected': -1.288709282875061, 'rewards/accuracies': 0.5, 'rewards/margins': 0.17939439415931702, 'logps/rejected': -59.211631774902344, 'logps/chosen': -48.35974884033203, 'logits/rejected': -0.765326738357544, 'logits/chosen': -0.7601714134216309, 'epoch': 0.65}
 65%|██████▌   | 1670/2552 [1:17:46<20:06,  1.37s/it] 65%|██████▌   | 1671/2552 [1:17:47<19:46,  1.35s/it] 66%|██████▌   | 1672/2552 [1:17:48<19:42,  1.34s/it] 66%|██████▌   | 1673/2552 [1:17:50<19:40,  1.34s/it] 66%|██████▌   | 1674/2552 [1:17:51<18:51,  1.29s/it] 66%|██████▌   | 1675/2552 [1:17:52<19:11,  1.31s/it] 66%|██████▌   | 1676/2552 [1:17:54<20:35,  1.41s/it] 66%|██████▌   | 1677/2552 [1:17:55<20:29,  1.41s/it] 66%|██████▌   | 1678/2552 [1:17:56<19:37,  1.35s/it] 66%|██████▌   | 1679/2552 [1:17:58<19:09,  1.32s/it] 66%|██████▌   | 1680/2552 [1:17:59<19:42,  1.36s/it]                                                     {'loss': 0.4488, 'grad_norm': 10.529500961303711, 'learning_rate': 1.7084639498432603e-05, 'rewards/chosen': -0.9617034792900085, 'rewards/rejected': -1.9732580184936523, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.0115545988082886, 'logps/rejected': -76.50321197509766, 'logps/chosen': -40.20845031738281, 'logits/rejected': -0.5864880084991455, 'logits/chosen': -0.5678396821022034, 'epoch': 0.66}
 66%|██████▌   | 1680/2552 [1:17:59<19:42,  1.36s/it] 66%|██████▌   | 1681/2552 [1:18:01<20:11,  1.39s/it] 66%|██████▌   | 1682/2552 [1:18:02<19:17,  1.33s/it] 66%|██████▌   | 1683/2552 [1:18:03<18:50,  1.30s/it] 66%|██████▌   | 1684/2552 [1:18:05<19:53,  1.38s/it] 66%|██████▌   | 1685/2552 [1:18:06<18:56,  1.31s/it] 66%|██████▌   | 1686/2552 [1:18:07<20:02,  1.39s/it] 66%|██████▌   | 1687/2552 [1:18:09<19:36,  1.36s/it] 66%|██████▌   | 1688/2552 [1:18:10<19:36,  1.36s/it] 66%|██████▌   | 1689/2552 [1:18:11<20:21,  1.41s/it] 66%|██████▌   | 1690/2552 [1:18:13<20:58,  1.46s/it]                                                     {'loss': 0.3706, 'grad_norm': 7.348731994628906, 'learning_rate': 1.688871473354232e-05, 'rewards/chosen': -0.5181698203086853, 'rewards/rejected': -2.4232850074768066, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.9051148891448975, 'logps/rejected': -68.32707214355469, 'logps/chosen': -32.95945358276367, 'logits/rejected': -0.6903882026672363, 'logits/chosen': -0.6646559238433838, 'epoch': 0.66}
 66%|██████▌   | 1690/2552 [1:18:13<20:58,  1.46s/it] 66%|██████▋   | 1691/2552 [1:18:15<21:17,  1.48s/it] 66%|██████▋   | 1692/2552 [1:18:16<20:48,  1.45s/it] 66%|██████▋   | 1693/2552 [1:18:17<20:05,  1.40s/it] 66%|██████▋   | 1694/2552 [1:18:19<20:52,  1.46s/it] 66%|██████▋   | 1695/2552 [1:18:20<20:01,  1.40s/it] 66%|██████▋   | 1696/2552 [1:18:22<20:00,  1.40s/it] 66%|██████▋   | 1697/2552 [1:18:23<19:19,  1.36s/it] 67%|██████▋   | 1698/2552 [1:18:24<19:42,  1.38s/it] 67%|██████▋   | 1699/2552 [1:18:26<20:39,  1.45s/it] 67%|██████▋   | 1700/2552 [1:18:27<20:45,  1.46s/it]                                                     {'loss': 0.5668, 'grad_norm': 4.494090557098389, 'learning_rate': 1.669278996865204e-05, 'rewards/chosen': -1.3863509893417358, 'rewards/rejected': -1.1317259073257446, 'rewards/accuracies': 0.5, 'rewards/margins': -0.25462526082992554, 'logps/rejected': -67.53923034667969, 'logps/chosen': -84.85006713867188, 'logits/rejected': -0.6754884719848633, 'logits/chosen': -0.7119725346565247, 'epoch': 0.67}
 67%|██████▋   | 1700/2552 [1:18:27<20:45,  1.46s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:04,  1.16it/s][A
  4%|▍         | 3/77 [00:02<01:15,  1.02s/it][A
  5%|▌         | 4/77 [00:04<01:21,  1.12s/it][A
  6%|▋         | 5/77 [00:06<01:41,  1.42s/it][A
  8%|▊         | 6/77 [00:07<01:32,  1.30s/it][A
  9%|▉         | 7/77 [00:08<01:32,  1.32s/it][A
 10%|█         | 8/77 [00:10<01:34,  1.37s/it][A
 12%|█▏        | 9/77 [00:11<01:37,  1.43s/it][A
 13%|█▎        | 10/77 [00:12<01:28,  1.32s/it][A
 14%|█▍        | 11/77 [00:13<01:20,  1.22s/it][A
 16%|█▌        | 12/77 [00:15<01:33,  1.44s/it][A
 17%|█▋        | 13/77 [00:16<01:27,  1.37s/it][A
 18%|█▊        | 14/77 [00:18<01:22,  1.31s/it][A
 19%|█▉        | 15/77 [00:19<01:27,  1.41s/it][A
 21%|██        | 16/77 [00:20<01:15,  1.24s/it][A
 22%|██▏       | 17/77 [00:21<01:16,  1.27s/it][A
 23%|██▎       | 18/77 [00:23<01:18,  1.33s/it][A
 25%|██▍       | 19/77 [00:25<01:23,  1.44s/it][A
 26%|██▌       | 20/77 [00:25<01:11,  1.25s/it][A
 27%|██▋       | 21/77 [00:26<01:05,  1.17s/it][A
 29%|██▊       | 22/77 [00:28<01:10,  1.29s/it][A
 30%|██▉       | 23/77 [00:30<01:19,  1.47s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.43s/it][A
 32%|███▏      | 25/77 [00:32<01:12,  1.39s/it][A
 34%|███▍      | 26/77 [00:34<01:05,  1.29s/it][A
 35%|███▌      | 27/77 [00:35<01:06,  1.34s/it][A
 36%|███▋      | 28/77 [00:36<01:01,  1.27s/it][A
 38%|███▊      | 29/77 [00:38<01:07,  1.41s/it][A
 39%|███▉      | 30/77 [00:40<01:11,  1.53s/it][A
 40%|████      | 31/77 [00:41<01:11,  1.55s/it][A
 42%|████▏     | 32/77 [00:43<01:09,  1.55s/it][A
 43%|████▎     | 33/77 [00:44<01:07,  1.53s/it][A
 44%|████▍     | 34/77 [00:46<01:06,  1.54s/it][A
 45%|████▌     | 35/77 [00:47<01:03,  1.50s/it][A
 47%|████▋     | 36/77 [00:49<01:04,  1.57s/it][A
 48%|████▊     | 37/77 [00:50<00:57,  1.45s/it][A
 49%|████▉     | 38/77 [00:51<00:52,  1.36s/it][A
 51%|█████     | 39/77 [00:53<00:57,  1.52s/it][A
 52%|█████▏    | 40/77 [00:55<00:57,  1.55s/it][A
 53%|█████▎    | 41/77 [00:56<00:50,  1.41s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.41s/it][A
 56%|█████▌    | 43/77 [00:59<00:52,  1.53s/it][A
 57%|█████▋    | 44/77 [01:00<00:46,  1.42s/it][A
 58%|█████▊    | 45/77 [01:01<00:41,  1.29s/it][A
 60%|█████▉    | 46/77 [01:03<00:40,  1.30s/it][A
 61%|██████    | 47/77 [01:04<00:38,  1.28s/it][A
 62%|██████▏   | 48/77 [01:05<00:40,  1.40s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.41s/it][A
 65%|██████▍   | 50/77 [01:08<00:38,  1.42s/it][A
 66%|██████▌   | 51/77 [01:10<00:39,  1.54s/it][A
 68%|██████▊   | 52/77 [01:12<00:38,  1.53s/it][A
 69%|██████▉   | 53/77 [01:14<00:39,  1.64s/it][A
 70%|███████   | 54/77 [01:15<00:35,  1.54s/it][A
 71%|███████▏  | 55/77 [01:16<00:31,  1.44s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.69s/it][A
 74%|███████▍  | 57/77 [01:20<00:31,  1.58s/it][A
 75%|███████▌  | 58/77 [01:21<00:30,  1.60s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.59s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.43s/it][A
 79%|███████▉  | 61/77 [01:26<00:23,  1.49s/it][A
 81%|████████  | 62/77 [01:27<00:22,  1.47s/it][A
 82%|████████▏ | 63/77 [01:29<00:21,  1.54s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.42s/it][A
 84%|████████▍ | 65/77 [01:31<00:16,  1.41s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.57s/it][A
 87%|████████▋ | 67/77 [01:34<00:13,  1.30s/it][A
 88%|████████▊ | 68/77 [01:36<00:13,  1.47s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.44s/it][A
 91%|█████████ | 70/77 [01:38<00:09,  1.41s/it][A
 92%|█████████▏| 71/77 [01:39<00:07,  1.30s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.31s/it][A
 95%|█████████▍| 73/77 [01:43<00:05,  1.43s/it][A
 96%|█████████▌| 74/77 [01:44<00:04,  1.58s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.54s/it][A
 99%|█████████▊| 76/77 [01:47<00:01,  1.47s/it][A
100%|██████████| 77/77 [01:49<00:00,  1.52s/it][A                                                     
                                               [A{'eval_loss': 0.4946013391017914, 'eval_runtime': 110.6684, 'eval_samples_per_second': 11.042, 'eval_steps_per_second': 0.696, 'eval_rewards/chosen': -0.7695315480232239, 'eval_rewards/rejected': -1.986219882965088, 'eval_rewards/accuracies': 0.7662337422370911, 'eval_rewards/margins': 1.2166881561279297, 'eval_logps/rejected': -59.11534118652344, 'eval_logps/chosen': -46.20417022705078, 'eval_logits/rejected': -0.5283317565917969, 'eval_logits/chosen': -0.526620090007782, 'epoch': 0.67}
 67%|██████▋   | 1700/2552 [1:20:18<20:45,  1.46s/it]
100%|██████████| 77/77 [01:49<00:00,  1.52s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 67%|██████▋   | 1701/2552 [1:20:46<10:05:14, 42.67s/it] 67%|██████▋   | 1702/2552 [1:20:48<7:10:05, 30.36s/it]  67%|██████▋   | 1703/2552 [1:20:49<5:05:50, 21.61s/it] 67%|██████▋   | 1704/2552 [1:20:50<3:39:05, 15.50s/it] 67%|██████▋   | 1705/2552 [1:20:51<2:38:27, 11.23s/it] 67%|██████▋   | 1706/2552 [1:20:53<1:55:48,  8.21s/it] 67%|██████▋   | 1707/2552 [1:20:54<1:25:56,  6.10s/it] 67%|██████▋   | 1708/2552 [1:20:55<1:05:08,  4.63s/it] 67%|██████▋   | 1709/2552 [1:20:56<51:24,  3.66s/it]   67%|██████▋   | 1710/2552 [1:20:58<41:13,  2.94s/it]                                                     {'loss': 0.4526, 'grad_norm': 8.817753791809082, 'learning_rate': 1.6496865203761753e-05, 'rewards/chosen': -1.019742488861084, 'rewards/rejected': -1.9232736825942993, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.9035312533378601, 'logps/rejected': -57.21765899658203, 'logps/chosen': -30.849517822265625, 'logits/rejected': -0.6605080366134644, 'logits/chosen': -0.6347244381904602, 'epoch': 0.67}
 67%|██████▋   | 1710/2552 [1:20:58<41:13,  2.94s/it] 67%|██████▋   | 1711/2552 [1:20:59<33:46,  2.41s/it] 67%|██████▋   | 1712/2552 [1:21:00<28:51,  2.06s/it] 67%|██████▋   | 1713/2552 [1:21:01<25:35,  1.83s/it] 67%|██████▋   | 1714/2552 [1:21:03<23:56,  1.71s/it] 67%|██████▋   | 1715/2552 [1:21:04<23:03,  1.65s/it] 67%|██████▋   | 1716/2552 [1:21:06<22:37,  1.62s/it] 67%|██████▋   | 1717/2552 [1:21:07<21:59,  1.58s/it] 67%|██████▋   | 1718/2552 [1:21:09<20:20,  1.46s/it] 67%|██████▋   | 1719/2552 [1:21:10<19:28,  1.40s/it] 67%|██████▋   | 1720/2552 [1:21:11<19:51,  1.43s/it]                                                     {'loss': 0.5498, 'grad_norm': 12.578004837036133, 'learning_rate': 1.6300940438871475e-05, 'rewards/chosen': -0.6277481317520142, 'rewards/rejected': -1.682448387145996, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.054700255393982, 'logps/rejected': -54.6773681640625, 'logps/chosen': -40.61315155029297, 'logits/rejected': -0.7007662057876587, 'logits/chosen': -0.671338677406311, 'epoch': 0.67}
 67%|██████▋   | 1720/2552 [1:21:11<19:51,  1.43s/it] 67%|██████▋   | 1721/2552 [1:21:13<19:30,  1.41s/it] 67%|██████▋   | 1722/2552 [1:21:14<19:13,  1.39s/it] 68%|██████▊   | 1723/2552 [1:21:16<19:48,  1.43s/it] 68%|██████▊   | 1724/2552 [1:21:17<19:16,  1.40s/it] 68%|██████▊   | 1725/2552 [1:21:18<19:05,  1.38s/it] 68%|██████▊   | 1726/2552 [1:21:20<19:07,  1.39s/it] 68%|██████▊   | 1727/2552 [1:21:21<19:09,  1.39s/it] 68%|██████▊   | 1728/2552 [1:21:22<18:57,  1.38s/it] 68%|██████▊   | 1729/2552 [1:21:24<19:40,  1.43s/it] 68%|██████▊   | 1730/2552 [1:21:25<19:46,  1.44s/it]                                                     {'loss': 0.4809, 'grad_norm': 15.02635383605957, 'learning_rate': 1.6105015673981192e-05, 'rewards/chosen': -0.6613777279853821, 'rewards/rejected': -1.83970046043396, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 1.1783225536346436, 'logps/rejected': -41.90513229370117, 'logps/chosen': -11.351800918579102, 'logits/rejected': -0.8264524340629578, 'logits/chosen': -0.7780724167823792, 'epoch': 0.68}
 68%|██████▊   | 1730/2552 [1:21:25<19:46,  1.44s/it] 68%|██████▊   | 1731/2552 [1:21:27<20:02,  1.46s/it] 68%|██████▊   | 1732/2552 [1:21:28<19:10,  1.40s/it] 68%|██████▊   | 1733/2552 [1:21:30<19:22,  1.42s/it] 68%|██████▊   | 1734/2552 [1:21:31<20:00,  1.47s/it] 68%|██████▊   | 1735/2552 [1:21:33<19:28,  1.43s/it] 68%|██████▊   | 1736/2552 [1:21:34<19:01,  1.40s/it] 68%|██████▊   | 1737/2552 [1:21:35<18:33,  1.37s/it] 68%|██████▊   | 1738/2552 [1:21:36<18:22,  1.35s/it] 68%|██████▊   | 1739/2552 [1:21:38<17:49,  1.32s/it] 68%|██████▊   | 1740/2552 [1:21:39<17:40,  1.31s/it]                                                     {'loss': 0.5214, 'grad_norm': 18.195484161376953, 'learning_rate': 1.590909090909091e-05, 'rewards/chosen': -0.6658511161804199, 'rewards/rejected': -2.3895695209503174, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.723718285560608, 'logps/rejected': -56.71140670776367, 'logps/chosen': -35.96780014038086, 'logits/rejected': -0.7096840739250183, 'logits/chosen': -0.6954620480537415, 'epoch': 0.68}
 68%|██████▊   | 1740/2552 [1:21:39<17:40,  1.31s/it] 68%|██████▊   | 1741/2552 [1:21:40<18:20,  1.36s/it] 68%|██████▊   | 1742/2552 [1:21:42<17:52,  1.32s/it] 68%|██████▊   | 1743/2552 [1:21:43<17:56,  1.33s/it] 68%|██████▊   | 1744/2552 [1:21:45<18:51,  1.40s/it] 68%|██████▊   | 1745/2552 [1:21:46<18:27,  1.37s/it] 68%|██████▊   | 1746/2552 [1:21:47<18:48,  1.40s/it] 68%|██████▊   | 1747/2552 [1:21:49<19:39,  1.47s/it] 68%|██████▊   | 1748/2552 [1:21:51<19:46,  1.48s/it] 69%|██████▊   | 1749/2552 [1:21:52<18:38,  1.39s/it] 69%|██████▊   | 1750/2552 [1:21:53<18:01,  1.35s/it]                                                     {'loss': 0.479, 'grad_norm': 11.62049388885498, 'learning_rate': 1.5713166144200628e-05, 'rewards/chosen': -0.8171582221984863, 'rewards/rejected': -1.9369096755981445, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.1197513341903687, 'logps/rejected': -84.51425170898438, 'logps/chosen': -66.8203353881836, 'logits/rejected': -0.6678341031074524, 'logits/chosen': -0.6751941442489624, 'epoch': 0.69}
 69%|██████▊   | 1750/2552 [1:21:53<18:01,  1.35s/it] 69%|██████▊   | 1751/2552 [1:21:54<17:50,  1.34s/it] 69%|██████▊   | 1752/2552 [1:21:56<18:30,  1.39s/it] 69%|██████▊   | 1753/2552 [1:21:57<17:51,  1.34s/it] 69%|██████▊   | 1754/2552 [1:21:58<17:33,  1.32s/it] 69%|██████▉   | 1755/2552 [1:22:00<17:25,  1.31s/it] 69%|██████▉   | 1756/2552 [1:22:01<18:20,  1.38s/it] 69%|██████▉   | 1757/2552 [1:22:03<18:49,  1.42s/it] 69%|██████▉   | 1758/2552 [1:22:04<17:48,  1.35s/it] 69%|██████▉   | 1759/2552 [1:22:05<17:18,  1.31s/it] 69%|██████▉   | 1760/2552 [1:22:06<17:07,  1.30s/it]                                                     {'loss': 0.5755, 'grad_norm': 10.886038780212402, 'learning_rate': 1.5517241379310346e-05, 'rewards/chosen': -0.335028737783432, 'rewards/rejected': -1.984113335609436, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.649084448814392, 'logps/rejected': -52.678428649902344, 'logps/chosen': -25.09694480895996, 'logits/rejected': -0.6412389874458313, 'logits/chosen': -0.5969690084457397, 'epoch': 0.69}
 69%|██████▉   | 1760/2552 [1:22:06<17:07,  1.30s/it] 69%|██████▉   | 1761/2552 [1:22:08<17:59,  1.36s/it] 69%|██████▉   | 1762/2552 [1:22:09<17:31,  1.33s/it] 69%|██████▉   | 1763/2552 [1:22:11<18:49,  1.43s/it] 69%|██████▉   | 1764/2552 [1:22:12<18:43,  1.43s/it] 69%|██████▉   | 1765/2552 [1:22:13<18:08,  1.38s/it] 69%|██████▉   | 1766/2552 [1:22:15<17:32,  1.34s/it] 69%|██████▉   | 1767/2552 [1:22:16<18:05,  1.38s/it] 69%|██████▉   | 1768/2552 [1:22:18<18:30,  1.42s/it] 69%|██████▉   | 1769/2552 [1:22:19<18:14,  1.40s/it] 69%|██████▉   | 1770/2552 [1:22:20<17:59,  1.38s/it]                                                     {'loss': 0.5129, 'grad_norm': 8.189070701599121, 'learning_rate': 1.5321316614420064e-05, 'rewards/chosen': -0.7183161973953247, 'rewards/rejected': -2.250009536743164, 'rewards/accuracies': 1.0, 'rewards/margins': 1.5316932201385498, 'logps/rejected': -72.58818817138672, 'logps/chosen': -37.913448333740234, 'logits/rejected': -0.8296847343444824, 'logits/chosen': -0.7738953828811646, 'epoch': 0.69}
 69%|██████▉   | 1770/2552 [1:22:20<17:59,  1.38s/it] 69%|██████▉   | 1771/2552 [1:22:22<17:25,  1.34s/it] 69%|██████▉   | 1772/2552 [1:22:23<16:54,  1.30s/it] 69%|██████▉   | 1773/2552 [1:22:24<17:50,  1.37s/it] 70%|██████▉   | 1774/2552 [1:22:26<17:58,  1.39s/it] 70%|██████▉   | 1775/2552 [1:22:27<17:31,  1.35s/it] 70%|██████▉   | 1776/2552 [1:22:28<17:47,  1.38s/it] 70%|██████▉   | 1777/2552 [1:22:30<18:24,  1.43s/it] 70%|██████▉   | 1778/2552 [1:22:32<18:58,  1.47s/it] 70%|██████▉   | 1779/2552 [1:22:33<17:46,  1.38s/it] 70%|██████▉   | 1780/2552 [1:22:34<18:02,  1.40s/it]                                                     {'loss': 0.4717, 'grad_norm': 9.028419494628906, 'learning_rate': 1.5125391849529783e-05, 'rewards/chosen': -1.183308720588684, 'rewards/rejected': -1.692467451095581, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.5091588497161865, 'logps/rejected': -44.731727600097656, 'logps/chosen': -71.35426330566406, 'logits/rejected': -0.5666407942771912, 'logits/chosen': -0.6098384857177734, 'epoch': 0.7}
 70%|██████▉   | 1780/2552 [1:22:34<18:02,  1.40s/it] 70%|██████▉   | 1781/2552 [1:22:36<18:20,  1.43s/it] 70%|██████▉   | 1782/2552 [1:22:37<17:36,  1.37s/it] 70%|██████▉   | 1783/2552 [1:22:38<17:52,  1.39s/it] 70%|██████▉   | 1784/2552 [1:22:40<17:09,  1.34s/it] 70%|██████▉   | 1785/2552 [1:22:41<17:07,  1.34s/it] 70%|██████▉   | 1786/2552 [1:22:42<17:10,  1.34s/it] 70%|███████   | 1787/2552 [1:22:44<17:47,  1.40s/it] 70%|███████   | 1788/2552 [1:22:45<18:17,  1.44s/it] 70%|███████   | 1789/2552 [1:22:47<17:16,  1.36s/it] 70%|███████   | 1790/2552 [1:22:48<16:43,  1.32s/it]                                                     {'loss': 0.5015, 'grad_norm': 5.145111560821533, 'learning_rate': 1.4929467084639498e-05, 'rewards/chosen': -1.0737911462783813, 'rewards/rejected': -1.954490303993225, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 0.8806989789009094, 'logps/rejected': -63.06342697143555, 'logps/chosen': -49.70081329345703, 'logits/rejected': -0.7611239552497864, 'logits/chosen': -0.7605448365211487, 'epoch': 0.7}
 70%|███████   | 1790/2552 [1:22:48<16:43,  1.32s/it] 70%|███████   | 1791/2552 [1:22:49<17:47,  1.40s/it] 70%|███████   | 1792/2552 [1:22:50<16:46,  1.32s/it] 70%|███████   | 1793/2552 [1:22:52<16:47,  1.33s/it] 70%|███████   | 1794/2552 [1:22:53<17:18,  1.37s/it] 70%|███████   | 1795/2552 [1:22:54<16:27,  1.31s/it] 70%|███████   | 1796/2552 [1:22:56<16:07,  1.28s/it] 70%|███████   | 1797/2552 [1:22:57<15:52,  1.26s/it] 70%|███████   | 1798/2552 [1:22:58<16:14,  1.29s/it] 70%|███████   | 1799/2552 [1:23:00<17:09,  1.37s/it] 71%|███████   | 1800/2552 [1:23:01<17:04,  1.36s/it]                                                     {'loss': 0.4326, 'grad_norm': 16.919239044189453, 'learning_rate': 1.4733542319749215e-05, 'rewards/chosen': -0.756280779838562, 'rewards/rejected': -2.089956760406494, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.333675742149353, 'logps/rejected': -80.2296142578125, 'logps/chosen': -56.51676559448242, 'logits/rejected': -0.7062538862228394, 'logits/chosen': -0.6379669904708862, 'epoch': 0.71}
 71%|███████   | 1800/2552 [1:23:01<17:04,  1.36s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:03,  1.18it/s][A
  4%|▍         | 3/77 [00:02<01:13,  1.00it/s][A
  5%|▌         | 4/77 [00:04<01:19,  1.09s/it][A
  6%|▋         | 5/77 [00:06<01:39,  1.39s/it][A
  8%|▊         | 6/77 [00:07<01:30,  1.28s/it][A
  9%|▉         | 7/77 [00:08<01:31,  1.31s/it][A
 10%|█         | 8/77 [00:09<01:33,  1.36s/it][A
 12%|█▏        | 9/77 [00:11<01:36,  1.42s/it][A
 13%|█▎        | 10/77 [00:12<01:28,  1.32s/it][A
 14%|█▍        | 11/77 [00:13<01:21,  1.24s/it][A
 16%|█▌        | 12/77 [00:15<01:34,  1.45s/it][A
 17%|█▋        | 13/77 [00:16<01:27,  1.37s/it][A
 18%|█▊        | 14/77 [00:17<01:22,  1.30s/it][A
 19%|█▉        | 15/77 [00:19<01:28,  1.43s/it][A
 21%|██        | 16/77 [00:20<01:16,  1.25s/it][A
 22%|██▏       | 17/77 [00:21<01:16,  1.27s/it][A
 23%|██▎       | 18/77 [00:23<01:17,  1.31s/it][A
 25%|██▍       | 19/77 [00:25<01:24,  1.46s/it][A
 26%|██▌       | 20/77 [00:25<01:11,  1.26s/it][A
 27%|██▋       | 21/77 [00:26<01:05,  1.17s/it][A
 29%|██▊       | 22/77 [00:28<01:10,  1.28s/it][A
 30%|██▉       | 23/77 [00:30<01:19,  1.47s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.43s/it][A
 32%|███▏      | 25/77 [00:32<01:12,  1.39s/it][A
 34%|███▍      | 26/77 [00:33<01:05,  1.29s/it][A
 35%|███▌      | 27/77 [00:35<01:06,  1.34s/it][A
 36%|███▋      | 28/77 [00:36<01:02,  1.27s/it][A
 38%|███▊      | 29/77 [00:38<01:08,  1.42s/it][A
 39%|███▉      | 30/77 [00:40<01:11,  1.53s/it][A
 40%|████      | 31/77 [00:41<01:11,  1.55s/it][A
 42%|████▏     | 32/77 [00:43<01:09,  1.55s/it][A
 43%|████▎     | 33/77 [00:44<01:07,  1.52s/it][A
 44%|████▍     | 34/77 [00:46<01:05,  1.52s/it][A
 45%|████▌     | 35/77 [00:47<01:02,  1.50s/it][A
 47%|████▋     | 36/77 [00:49<01:03,  1.55s/it][A
 48%|████▊     | 37/77 [00:50<00:57,  1.44s/it][A
 49%|████▉     | 38/77 [00:51<00:52,  1.34s/it][A
 51%|█████     | 39/77 [00:53<00:57,  1.50s/it][A
 52%|█████▏    | 40/77 [00:55<00:57,  1.54s/it][A
 53%|█████▎    | 41/77 [00:56<00:50,  1.39s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.41s/it][A
 56%|█████▌    | 43/77 [00:59<00:52,  1.53s/it][A
 57%|█████▋    | 44/77 [01:00<00:46,  1.40s/it][A
 58%|█████▊    | 45/77 [01:01<00:41,  1.28s/it][A
 60%|█████▉    | 46/77 [01:02<00:39,  1.28s/it][A
 61%|██████    | 47/77 [01:04<00:37,  1.27s/it][A
 62%|██████▏   | 48/77 [01:05<00:39,  1.38s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.40s/it][A
 65%|██████▍   | 50/77 [01:08<00:38,  1.42s/it][A
 66%|██████▌   | 51/77 [01:10<00:39,  1.54s/it][A
 68%|██████▊   | 52/77 [01:11<00:38,  1.54s/it][A
 69%|██████▉   | 53/77 [01:13<00:39,  1.63s/it][A
 70%|███████   | 54/77 [01:15<00:35,  1.53s/it][A
 71%|███████▏  | 55/77 [01:16<00:31,  1.44s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.69s/it][A
 74%|███████▍  | 57/77 [01:19<00:31,  1.57s/it][A
 75%|███████▌  | 58/77 [01:21<00:30,  1.60s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.59s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.43s/it][A
 79%|███████▉  | 61/77 [01:25<00:23,  1.49s/it][A
 81%|████████  | 62/77 [01:27<00:22,  1.47s/it][A
 82%|████████▏ | 63/77 [01:28<00:21,  1.53s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.42s/it][A
 84%|████████▍ | 65/77 [01:31<00:16,  1.40s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.55s/it][A
 87%|████████▋ | 67/77 [01:33<00:12,  1.29s/it][A
 88%|████████▊ | 68/77 [01:35<00:13,  1.45s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.45s/it][A
 91%|█████████ | 70/77 [01:38<00:09,  1.39s/it][A
 92%|█████████▏| 71/77 [01:39<00:07,  1.30s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.33s/it][A
 95%|█████████▍| 73/77 [01:42<00:05,  1.43s/it][A
 96%|█████████▌| 74/77 [01:44<00:04,  1.60s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.54s/it][A
 99%|█████████▊| 76/77 [01:47<00:01,  1.49s/it][A
100%|██████████| 77/77 [01:49<00:00,  1.54s/it][A                                                     
                                               [A{'eval_loss': 0.4887430667877197, 'eval_runtime': 110.4395, 'eval_samples_per_second': 11.065, 'eval_steps_per_second': 0.697, 'eval_rewards/chosen': -0.80069899559021, 'eval_rewards/rejected': -1.967313528060913, 'eval_rewards/accuracies': 0.7922077775001526, 'eval_rewards/margins': 1.1666145324707031, 'eval_logps/rejected': -58.9262809753418, 'eval_logps/chosen': -46.51584243774414, 'eval_logits/rejected': -0.5554212331771851, 'eval_logits/chosen': -0.5534085035324097, 'epoch': 0.71}
 71%|███████   | 1800/2552 [1:24:52<17:04,  1.36s/it]
100%|██████████| 77/77 [01:49<00:00,  1.54s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 71%|███████   | 1801/2552 [1:25:20<8:52:43, 42.56s/it] 71%|███████   | 1802/2552 [1:25:21<6:16:47, 30.14s/it] 71%|███████   | 1803/2552 [1:25:22<4:28:17, 21.49s/it] 71%|███████   | 1804/2552 [1:25:24<3:12:14, 15.42s/it] 71%|███████   | 1805/2552 [1:25:25<2:19:00, 11.16s/it] 71%|███████   | 1806/2552 [1:25:26<1:42:42,  8.26s/it] 71%|███████   | 1807/2552 [1:25:28<1:17:57,  6.28s/it] 71%|███████   | 1808/2552 [1:25:29<58:42,  4.73s/it]   71%|███████   | 1809/2552 [1:25:30<46:23,  3.75s/it] 71%|███████   | 1810/2552 [1:25:32<37:33,  3.04s/it]                                                     {'loss': 0.4519, 'grad_norm': 5.877049446105957, 'learning_rate': 1.4537617554858935e-05, 'rewards/chosen': -1.1518758535385132, 'rewards/rejected': -1.990055799484253, 'rewards/accuracies': 0.5, 'rewards/margins': 0.8381801843643188, 'logps/rejected': -71.77580261230469, 'logps/chosen': -58.783935546875, 'logits/rejected': -0.6961594223976135, 'logits/chosen': -0.6873670816421509, 'epoch': 0.71}
 71%|███████   | 1810/2552 [1:25:32<37:33,  3.04s/it] 71%|███████   | 1811/2552 [1:25:33<31:16,  2.53s/it] 71%|███████   | 1812/2552 [1:25:34<26:15,  2.13s/it] 71%|███████   | 1813/2552 [1:25:36<23:07,  1.88s/it] 71%|███████   | 1814/2552 [1:25:37<20:51,  1.70s/it] 71%|███████   | 1815/2552 [1:25:38<18:54,  1.54s/it] 71%|███████   | 1816/2552 [1:25:39<18:00,  1.47s/it] 71%|███████   | 1817/2552 [1:25:41<17:09,  1.40s/it] 71%|███████   | 1818/2552 [1:25:42<16:16,  1.33s/it] 71%|███████▏  | 1819/2552 [1:25:43<16:01,  1.31s/it] 71%|███████▏  | 1820/2552 [1:25:44<15:55,  1.31s/it]                                                     {'loss': 0.4795, 'grad_norm': 8.285621643066406, 'learning_rate': 1.4341692789968653e-05, 'rewards/chosen': -0.4636554718017578, 'rewards/rejected': -1.9808557033538818, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.517200231552124, 'logps/rejected': -80.7288818359375, 'logps/chosen': -56.5040283203125, 'logits/rejected': -0.701138436794281, 'logits/chosen': -0.6819905042648315, 'epoch': 0.71}
 71%|███████▏  | 1820/2552 [1:25:44<15:55,  1.31s/it] 71%|███████▏  | 1821/2552 [1:25:46<15:38,  1.28s/it] 71%|███████▏  | 1822/2552 [1:25:47<15:14,  1.25s/it] 71%|███████▏  | 1823/2552 [1:25:48<14:59,  1.23s/it] 71%|███████▏  | 1824/2552 [1:25:49<15:49,  1.30s/it] 72%|███████▏  | 1825/2552 [1:25:51<15:29,  1.28s/it] 72%|███████▏  | 1826/2552 [1:25:52<15:23,  1.27s/it] 72%|███████▏  | 1827/2552 [1:25:53<15:43,  1.30s/it] 72%|███████▏  | 1828/2552 [1:25:55<15:15,  1.26s/it] 72%|███████▏  | 1829/2552 [1:25:56<14:49,  1.23s/it] 72%|███████▏  | 1830/2552 [1:25:57<15:10,  1.26s/it]                                                     {'loss': 0.4853, 'grad_norm': 15.496526718139648, 'learning_rate': 1.414576802507837e-05, 'rewards/chosen': -0.7855960130691528, 'rewards/rejected': -1.9851105213165283, 'rewards/accuracies': 0.5, 'rewards/margins': 1.199514389038086, 'logps/rejected': -58.94841384887695, 'logps/chosen': -39.68269348144531, 'logits/rejected': -0.6963822245597839, 'logits/chosen': -0.7010326385498047, 'epoch': 0.72}
 72%|███████▏  | 1830/2552 [1:25:57<15:10,  1.26s/it] 72%|███████▏  | 1831/2552 [1:25:58<15:05,  1.26s/it] 72%|███████▏  | 1832/2552 [1:26:00<16:14,  1.35s/it] 72%|███████▏  | 1833/2552 [1:26:01<15:55,  1.33s/it] 72%|███████▏  | 1834/2552 [1:26:03<17:00,  1.42s/it] 72%|███████▏  | 1835/2552 [1:26:04<16:34,  1.39s/it] 72%|███████▏  | 1836/2552 [1:26:06<17:00,  1.42s/it] 72%|███████▏  | 1837/2552 [1:26:07<16:22,  1.37s/it] 72%|███████▏  | 1838/2552 [1:26:08<15:56,  1.34s/it] 72%|███████▏  | 1839/2552 [1:26:10<16:42,  1.41s/it] 72%|███████▏  | 1840/2552 [1:26:11<15:59,  1.35s/it]                                                     {'loss': 0.6413, 'grad_norm': 12.766284942626953, 'learning_rate': 1.3949843260188088e-05, 'rewards/chosen': -0.7274037599563599, 'rewards/rejected': -1.8650147914886475, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 1.137610912322998, 'logps/rejected': -38.61410140991211, 'logps/chosen': -37.30708312988281, 'logits/rejected': -0.6989399194717407, 'logits/chosen': -0.7299249172210693, 'epoch': 0.72}
 72%|███████▏  | 1840/2552 [1:26:11<15:59,  1.35s/it] 72%|███████▏  | 1841/2552 [1:26:12<16:30,  1.39s/it] 72%|███████▏  | 1842/2552 [1:26:14<16:36,  1.40s/it] 72%|███████▏  | 1843/2552 [1:26:15<16:03,  1.36s/it] 72%|███████▏  | 1844/2552 [1:26:16<15:29,  1.31s/it] 72%|███████▏  | 1845/2552 [1:26:17<15:07,  1.28s/it] 72%|███████▏  | 1846/2552 [1:26:19<14:39,  1.25s/it] 72%|███████▏  | 1847/2552 [1:26:20<15:26,  1.31s/it] 72%|███████▏  | 1848/2552 [1:26:21<15:41,  1.34s/it] 72%|███████▏  | 1849/2552 [1:26:23<15:18,  1.31s/it] 72%|███████▏  | 1850/2552 [1:26:24<15:04,  1.29s/it]                                                     {'loss': 0.4552, 'grad_norm': 12.081693649291992, 'learning_rate': 1.3753918495297808e-05, 'rewards/chosen': -0.8041387796401978, 'rewards/rejected': -2.1296489238739014, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.3255102634429932, 'logps/rejected': -62.28236770629883, 'logps/chosen': -28.96311378479004, 'logits/rejected': -0.670724093914032, 'logits/chosen': -0.6298679113388062, 'epoch': 0.72}
 72%|███████▏  | 1850/2552 [1:26:24<15:04,  1.29s/it] 73%|███████▎  | 1851/2552 [1:26:25<14:39,  1.25s/it] 73%|███████▎  | 1852/2552 [1:26:26<14:59,  1.29s/it] 73%|███████▎  | 1853/2552 [1:26:28<14:47,  1.27s/it] 73%|███████▎  | 1854/2552 [1:26:29<15:33,  1.34s/it] 73%|███████▎  | 1855/2552 [1:26:31<15:59,  1.38s/it] 73%|███████▎  | 1856/2552 [1:26:32<16:34,  1.43s/it] 73%|███████▎  | 1857/2552 [1:26:34<16:50,  1.45s/it] 73%|███████▎  | 1858/2552 [1:26:35<16:15,  1.41s/it] 73%|███████▎  | 1859/2552 [1:26:36<15:18,  1.32s/it] 73%|███████▎  | 1860/2552 [1:26:38<16:11,  1.40s/it]                                                     {'loss': 0.6578, 'grad_norm': 8.526337623596191, 'learning_rate': 1.3557993730407526e-05, 'rewards/chosen': -0.8130523562431335, 'rewards/rejected': -1.5673307180404663, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.7542784214019775, 'logps/rejected': -34.77808380126953, 'logps/chosen': -28.721622467041016, 'logits/rejected': -0.7029118537902832, 'logits/chosen': -0.6960673928260803, 'epoch': 0.73}
 73%|███████▎  | 1860/2552 [1:26:38<16:11,  1.40s/it] 73%|███████▎  | 1861/2552 [1:26:39<15:34,  1.35s/it] 73%|███████▎  | 1862/2552 [1:26:40<15:36,  1.36s/it] 73%|███████▎  | 1863/2552 [1:26:42<15:27,  1.35s/it] 73%|███████▎  | 1864/2552 [1:26:43<15:00,  1.31s/it] 73%|███████▎  | 1865/2552 [1:26:44<15:54,  1.39s/it] 73%|███████▎  | 1866/2552 [1:26:46<16:01,  1.40s/it] 73%|███████▎  | 1867/2552 [1:26:47<15:58,  1.40s/it] 73%|███████▎  | 1868/2552 [1:26:49<16:15,  1.43s/it] 73%|███████▎  | 1869/2552 [1:26:50<15:37,  1.37s/it] 73%|███████▎  | 1870/2552 [1:26:51<15:46,  1.39s/it]                                                     {'loss': 0.5985, 'grad_norm': 9.320330619812012, 'learning_rate': 1.336206896551724e-05, 'rewards/chosen': -0.6872285604476929, 'rewards/rejected': -1.7607786655426025, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.0735499858856201, 'logps/rejected': -78.56718444824219, 'logps/chosen': -46.56907272338867, 'logits/rejected': -0.6379753351211548, 'logits/chosen': -0.6041934490203857, 'epoch': 0.73}
 73%|███████▎  | 1870/2552 [1:26:52<15:46,  1.39s/it] 73%|███████▎  | 1871/2552 [1:26:53<15:46,  1.39s/it] 73%|███████▎  | 1872/2552 [1:26:54<15:04,  1.33s/it] 73%|███████▎  | 1873/2552 [1:26:55<14:23,  1.27s/it] 73%|███████▎  | 1874/2552 [1:26:56<14:06,  1.25s/it] 73%|███████▎  | 1875/2552 [1:26:58<14:33,  1.29s/it] 74%|███████▎  | 1876/2552 [1:26:59<15:20,  1.36s/it] 74%|███████▎  | 1877/2552 [1:27:01<15:04,  1.34s/it] 74%|███████▎  | 1878/2552 [1:27:02<14:30,  1.29s/it] 74%|███████▎  | 1879/2552 [1:27:03<15:00,  1.34s/it] 74%|███████▎  | 1880/2552 [1:27:04<14:35,  1.30s/it]                                                     {'loss': 0.4851, 'grad_norm': 5.486893177032471, 'learning_rate': 1.316614420062696e-05, 'rewards/chosen': -1.0819036960601807, 'rewards/rejected': -2.0729153156280518, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.9910117387771606, 'logps/rejected': -62.2864990234375, 'logps/chosen': -68.3836898803711, 'logits/rejected': -0.8080612421035767, 'logits/chosen': -0.8185656666755676, 'epoch': 0.74}
 74%|███████▎  | 1880/2552 [1:27:04<14:35,  1.30s/it] 74%|███████▎  | 1881/2552 [1:27:06<14:23,  1.29s/it] 74%|███████▎  | 1882/2552 [1:27:07<14:17,  1.28s/it] 74%|███████▍  | 1883/2552 [1:27:08<14:38,  1.31s/it] 74%|███████▍  | 1884/2552 [1:27:10<15:12,  1.37s/it] 74%|███████▍  | 1885/2552 [1:27:11<15:07,  1.36s/it] 74%|███████▍  | 1886/2552 [1:27:12<14:50,  1.34s/it] 74%|███████▍  | 1887/2552 [1:27:14<15:35,  1.41s/it] 74%|███████▍  | 1888/2552 [1:27:15<14:42,  1.33s/it] 74%|███████▍  | 1889/2552 [1:27:17<15:14,  1.38s/it] 74%|███████▍  | 1890/2552 [1:27:18<16:07,  1.46s/it]                                                     {'loss': 0.6096, 'grad_norm': 8.329216003417969, 'learning_rate': 1.2970219435736677e-05, 'rewards/chosen': -0.4369317591190338, 'rewards/rejected': -1.5209782123565674, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.0840462446212769, 'logps/rejected': -55.07417678833008, 'logps/chosen': -33.12864303588867, 'logits/rejected': -0.6382247805595398, 'logits/chosen': -0.6108843684196472, 'epoch': 0.74}
 74%|███████▍  | 1890/2552 [1:27:18<16:07,  1.46s/it] 74%|███████▍  | 1891/2552 [1:27:20<16:17,  1.48s/it] 74%|███████▍  | 1892/2552 [1:27:21<15:12,  1.38s/it] 74%|███████▍  | 1893/2552 [1:27:22<14:36,  1.33s/it] 74%|███████▍  | 1894/2552 [1:27:24<15:15,  1.39s/it] 74%|███████▍  | 1895/2552 [1:27:25<15:43,  1.44s/it] 74%|███████▍  | 1896/2552 [1:27:27<15:56,  1.46s/it] 74%|███████▍  | 1897/2552 [1:27:28<15:30,  1.42s/it] 74%|███████▍  | 1898/2552 [1:27:29<14:57,  1.37s/it] 74%|███████▍  | 1899/2552 [1:27:31<14:26,  1.33s/it] 74%|███████▍  | 1900/2552 [1:27:32<14:33,  1.34s/it]                                                     {'loss': 0.4664, 'grad_norm': 8.283550262451172, 'learning_rate': 1.2774294670846395e-05, 'rewards/chosen': -0.24431400001049042, 'rewards/rejected': -2.319007635116577, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 2.0746936798095703, 'logps/rejected': -67.0178451538086, 'logps/chosen': -40.171485900878906, 'logits/rejected': -0.7211002111434937, 'logits/chosen': -0.6986876726150513, 'epoch': 0.74}
 74%|███████▍  | 1900/2552 [1:27:32<14:33,  1.34s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:02,  1.21it/s][A
  4%|▍         | 3/77 [00:02<01:15,  1.02s/it][A
  5%|▌         | 4/77 [00:04<01:20,  1.10s/it][A
  6%|▋         | 5/77 [00:06<01:41,  1.41s/it][A
  8%|▊         | 6/77 [00:07<01:32,  1.30s/it][A
  9%|▉         | 7/77 [00:08<01:32,  1.32s/it][A
 10%|█         | 8/77 [00:10<01:34,  1.37s/it][A
 12%|█▏        | 9/77 [00:11<01:37,  1.44s/it][A
 13%|█▎        | 10/77 [00:12<01:28,  1.31s/it][A
 14%|█▍        | 11/77 [00:13<01:20,  1.22s/it][A
 16%|█▌        | 12/77 [00:15<01:34,  1.45s/it][A
 17%|█▋        | 13/77 [00:16<01:28,  1.38s/it][A
 18%|█▊        | 14/77 [00:18<01:22,  1.31s/it][A
 19%|█▉        | 15/77 [00:19<01:27,  1.41s/it][A
 21%|██        | 16/77 [00:20<01:15,  1.24s/it][A
 22%|██▏       | 17/77 [00:21<01:15,  1.27s/it][A
 23%|██▎       | 18/77 [00:23<01:15,  1.29s/it][A
 25%|██▍       | 19/77 [00:25<01:24,  1.45s/it][A
 26%|██▌       | 20/77 [00:25<01:12,  1.27s/it][A
 27%|██▋       | 21/77 [00:26<01:05,  1.18s/it][A
 29%|██▊       | 22/77 [00:28<01:10,  1.28s/it][A
 30%|██▉       | 23/77 [00:30<01:19,  1.48s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.43s/it][A
 32%|███▏      | 25/77 [00:32<01:12,  1.40s/it][A
 34%|███▍      | 26/77 [00:33<01:05,  1.28s/it][A
 35%|███▌      | 27/77 [00:35<01:05,  1.32s/it][A
 36%|███▋      | 28/77 [00:36<01:01,  1.26s/it][A
 38%|███▊      | 29/77 [00:38<01:07,  1.41s/it][A
 39%|███▉      | 30/77 [00:40<01:11,  1.51s/it][A
 40%|████      | 31/77 [00:41<01:11,  1.54s/it][A
 42%|████▏     | 32/77 [00:43<01:10,  1.56s/it][A
 43%|████▎     | 33/77 [00:44<01:07,  1.53s/it][A
 44%|████▍     | 34/77 [00:46<01:05,  1.53s/it][A
 45%|████▌     | 35/77 [00:47<01:02,  1.49s/it][A
 47%|████▋     | 36/77 [00:49<01:04,  1.56s/it][A
 48%|████▊     | 37/77 [00:50<00:58,  1.45s/it][A
 49%|████▉     | 38/77 [00:51<00:52,  1.35s/it][A
 51%|█████     | 39/77 [00:53<00:57,  1.51s/it][A
 52%|█████▏    | 40/77 [00:55<00:57,  1.54s/it][A
 53%|█████▎    | 41/77 [00:56<00:50,  1.39s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.42s/it][A
 56%|█████▌    | 43/77 [00:59<00:51,  1.52s/it][A
 57%|█████▋    | 44/77 [01:00<00:46,  1.40s/it][A
 58%|█████▊    | 45/77 [01:01<00:40,  1.27s/it][A
 60%|█████▉    | 46/77 [01:02<00:40,  1.29s/it][A
 61%|██████    | 47/77 [01:04<00:38,  1.27s/it][A
 62%|██████▏   | 48/77 [01:05<00:40,  1.38s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.40s/it][A
 65%|██████▍   | 50/77 [01:08<00:38,  1.42s/it][A
 66%|██████▌   | 51/77 [01:10<00:40,  1.55s/it][A
 68%|██████▊   | 52/77 [01:11<00:38,  1.54s/it][A
 69%|██████▉   | 53/77 [01:13<00:39,  1.64s/it][A
 70%|███████   | 54/77 [01:15<00:35,  1.53s/it][A
 71%|███████▏  | 55/77 [01:16<00:31,  1.45s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.70s/it][A
 74%|███████▍  | 57/77 [01:19<00:31,  1.58s/it][A
 75%|███████▌  | 58/77 [01:21<00:30,  1.60s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.59s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.43s/it][A
 79%|███████▉  | 61/77 [01:25<00:23,  1.48s/it][A
 81%|████████  | 62/77 [01:27<00:21,  1.46s/it][A
 82%|████████▏ | 63/77 [01:29<00:21,  1.54s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.43s/it][A
 84%|████████▍ | 65/77 [01:31<00:16,  1.41s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.56s/it][A
 87%|████████▋ | 67/77 [01:34<00:13,  1.30s/it][A
 88%|████████▊ | 68/77 [01:35<00:13,  1.45s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.44s/it][A
 91%|█████████ | 70/77 [01:38<00:09,  1.38s/it][A
 92%|█████████▏| 71/77 [01:39<00:07,  1.29s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.32s/it][A
 95%|█████████▍| 73/77 [01:42<00:05,  1.43s/it][A
 96%|█████████▌| 74/77 [01:44<00:04,  1.60s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.55s/it][A
 99%|█████████▊| 76/77 [01:47<00:01,  1.50s/it][A
100%|██████████| 77/77 [01:49<00:00,  1.53s/it][A                                                     
                                               [A{'eval_loss': 0.48708003759384155, 'eval_runtime': 110.5343, 'eval_samples_per_second': 11.055, 'eval_steps_per_second': 0.697, 'eval_rewards/chosen': -0.6098482012748718, 'eval_rewards/rejected': -1.6462786197662354, 'eval_rewards/accuracies': 0.7857142686843872, 'eval_rewards/margins': 1.0364304780960083, 'eval_logps/rejected': -55.71593475341797, 'eval_logps/chosen': -44.607337951660156, 'eval_logits/rejected': -0.5431244969367981, 'eval_logits/chosen': -0.5412354469299316, 'epoch': 0.74}
 74%|███████▍  | 1900/2552 [1:29:23<14:33,  1.34s/it]
100%|██████████| 77/77 [01:49<00:00,  1.53s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 74%|███████▍  | 1901/2552 [1:29:51<7:43:01, 42.68s/it] 75%|███████▍  | 1902/2552 [1:29:53<5:28:31, 30.33s/it] 75%|███████▍  | 1903/2552 [1:29:54<3:53:49, 21.62s/it] 75%|███████▍  | 1904/2552 [1:29:55<2:47:40, 15.53s/it] 75%|███████▍  | 1905/2552 [1:29:56<2:00:51, 11.21s/it] 75%|███████▍  | 1906/2552 [1:29:58<1:29:36,  8.32s/it] 75%|███████▍  | 1907/2552 [1:29:59<1:07:26,  6.27s/it] 75%|███████▍  | 1908/2552 [1:30:01<50:53,  4.74s/it]   75%|███████▍  | 1909/2552 [1:30:02<39:52,  3.72s/it] 75%|███████▍  | 1910/2552 [1:30:03<32:33,  3.04s/it]                                                     {'loss': 0.4833, 'grad_norm': 6.897651195526123, 'learning_rate': 1.2578369905956113e-05, 'rewards/chosen': -0.01781841740012169, 'rewards/rejected': -2.1037518978118896, 'rewards/accuracies': 1.0, 'rewards/margins': 2.0859336853027344, 'logps/rejected': -47.885948181152344, 'logps/chosen': -22.80441665649414, 'logits/rejected': -0.7684923410415649, 'logits/chosen': -0.7610191702842712, 'epoch': 0.75}
 75%|███████▍  | 1910/2552 [1:30:03<32:33,  3.04s/it] 75%|███████▍  | 1911/2552 [1:30:05<27:45,  2.60s/it] 75%|███████▍  | 1912/2552 [1:30:06<23:55,  2.24s/it] 75%|███████▍  | 1913/2552 [1:30:08<20:43,  1.95s/it] 75%|███████▌  | 1914/2552 [1:30:09<19:30,  1.83s/it] 75%|███████▌  | 1915/2552 [1:30:10<17:28,  1.65s/it] 75%|███████▌  | 1916/2552 [1:30:12<16:14,  1.53s/it] 75%|███████▌  | 1917/2552 [1:30:13<14:55,  1.41s/it] 75%|███████▌  | 1918/2552 [1:30:14<14:14,  1.35s/it] 75%|███████▌  | 1919/2552 [1:30:15<14:26,  1.37s/it] 75%|███████▌  | 1920/2552 [1:30:17<15:14,  1.45s/it]                                                     {'loss': 0.4632, 'grad_norm': 13.053764343261719, 'learning_rate': 1.2382445141065831e-05, 'rewards/chosen': -1.1255637407302856, 'rewards/rejected': -2.2773985862731934, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.1518347263336182, 'logps/rejected': -55.446266174316406, 'logps/chosen': -35.17192077636719, 'logits/rejected': -0.6182888746261597, 'logits/chosen': -0.6171746253967285, 'epoch': 0.75}
 75%|███████▌  | 1920/2552 [1:30:17<15:14,  1.45s/it] 75%|███████▌  | 1921/2552 [1:30:19<15:27,  1.47s/it] 75%|███████▌  | 1922/2552 [1:30:20<15:26,  1.47s/it] 75%|███████▌  | 1923/2552 [1:30:22<15:26,  1.47s/it] 75%|███████▌  | 1924/2552 [1:30:23<14:47,  1.41s/it] 75%|███████▌  | 1925/2552 [1:30:24<15:08,  1.45s/it] 75%|███████▌  | 1926/2552 [1:30:26<15:31,  1.49s/it] 76%|███████▌  | 1927/2552 [1:30:27<14:30,  1.39s/it] 76%|███████▌  | 1928/2552 [1:30:29<14:46,  1.42s/it] 76%|███████▌  | 1929/2552 [1:30:30<14:13,  1.37s/it] 76%|███████▌  | 1930/2552 [1:30:31<14:02,  1.35s/it]                                                     {'loss': 0.4928, 'grad_norm': 8.379809379577637, 'learning_rate': 1.2186520376175549e-05, 'rewards/chosen': -0.8918741345405579, 'rewards/rejected': -1.5285625457763672, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.6366883516311646, 'logps/rejected': -62.156005859375, 'logps/chosen': -41.06255340576172, 'logits/rejected': -0.5635321736335754, 'logits/chosen': -0.5416730046272278, 'epoch': 0.76}
 76%|███████▌  | 1930/2552 [1:30:31<14:02,  1.35s/it] 76%|███████▌  | 1931/2552 [1:30:33<14:39,  1.42s/it] 76%|███████▌  | 1932/2552 [1:30:34<14:00,  1.36s/it] 76%|███████▌  | 1933/2552 [1:30:35<13:41,  1.33s/it] 76%|███████▌  | 1934/2552 [1:30:37<14:06,  1.37s/it] 76%|███████▌  | 1935/2552 [1:30:38<13:50,  1.35s/it] 76%|███████▌  | 1936/2552 [1:30:39<13:46,  1.34s/it] 76%|███████▌  | 1937/2552 [1:30:41<13:26,  1.31s/it] 76%|███████▌  | 1938/2552 [1:30:42<12:59,  1.27s/it] 76%|███████▌  | 1939/2552 [1:30:43<13:43,  1.34s/it] 76%|███████▌  | 1940/2552 [1:30:44<13:16,  1.30s/it]                                                     {'loss': 0.428, 'grad_norm': 6.724841594696045, 'learning_rate': 1.1990595611285267e-05, 'rewards/chosen': -0.31747227907180786, 'rewards/rejected': -1.7632725238800049, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.4458001852035522, 'logps/rejected': -67.17095184326172, 'logps/chosen': -32.35943603515625, 'logits/rejected': -0.6386250257492065, 'logits/chosen': -0.6123499870300293, 'epoch': 0.76}
 76%|███████▌  | 1940/2552 [1:30:44<13:16,  1.30s/it] 76%|███████▌  | 1941/2552 [1:30:46<13:09,  1.29s/it] 76%|███████▌  | 1942/2552 [1:30:47<13:52,  1.36s/it] 76%|███████▌  | 1943/2552 [1:30:49<13:43,  1.35s/it] 76%|███████▌  | 1944/2552 [1:30:50<13:01,  1.29s/it] 76%|███████▌  | 1945/2552 [1:30:51<13:51,  1.37s/it] 76%|███████▋  | 1946/2552 [1:30:52<12:57,  1.28s/it] 76%|███████▋  | 1947/2552 [1:30:54<12:54,  1.28s/it] 76%|███████▋  | 1948/2552 [1:30:55<13:39,  1.36s/it] 76%|███████▋  | 1949/2552 [1:30:56<13:06,  1.30s/it] 76%|███████▋  | 1950/2552 [1:30:58<12:54,  1.29s/it]                                                     {'loss': 0.51, 'grad_norm': 5.207116603851318, 'learning_rate': 1.1794670846394986e-05, 'rewards/chosen': -0.10885147750377655, 'rewards/rejected': -1.1748063564300537, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.0659549236297607, 'logps/rejected': -32.98923873901367, 'logps/chosen': -38.65074157714844, 'logits/rejected': -0.6857184767723083, 'logits/chosen': -0.6913133859634399, 'epoch': 0.76}
 76%|███████▋  | 1950/2552 [1:30:58<12:54,  1.29s/it] 76%|███████▋  | 1951/2552 [1:30:59<12:42,  1.27s/it] 76%|███████▋  | 1952/2552 [1:31:00<13:21,  1.34s/it] 77%|███████▋  | 1953/2552 [1:31:02<13:53,  1.39s/it] 77%|███████▋  | 1954/2552 [1:31:03<13:14,  1.33s/it] 77%|███████▋  | 1955/2552 [1:31:04<13:30,  1.36s/it] 77%|███████▋  | 1956/2552 [1:31:06<13:03,  1.31s/it] 77%|███████▋  | 1957/2552 [1:31:07<12:32,  1.27s/it] 77%|███████▋  | 1958/2552 [1:31:08<12:32,  1.27s/it] 77%|███████▋  | 1959/2552 [1:31:10<13:16,  1.34s/it] 77%|███████▋  | 1960/2552 [1:31:11<12:51,  1.30s/it]                                                     {'loss': 0.6303, 'grad_norm': 18.4202938079834, 'learning_rate': 1.1598746081504702e-05, 'rewards/chosen': -0.7061818242073059, 'rewards/rejected': -1.6180610656738281, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.9118793606758118, 'logps/rejected': -60.731590270996094, 'logps/chosen': -40.98162841796875, 'logits/rejected': -0.8122249841690063, 'logits/chosen': -0.8149788975715637, 'epoch': 0.77}
 77%|███████▋  | 1960/2552 [1:31:11<12:51,  1.30s/it] 77%|███████▋  | 1961/2552 [1:31:12<12:58,  1.32s/it] 77%|███████▋  | 1962/2552 [1:31:14<13:18,  1.35s/it] 77%|███████▋  | 1963/2552 [1:31:15<13:37,  1.39s/it] 77%|███████▋  | 1964/2552 [1:31:16<12:59,  1.33s/it] 77%|███████▋  | 1965/2552 [1:31:17<12:44,  1.30s/it] 77%|███████▋  | 1966/2552 [1:31:19<12:13,  1.25s/it] 77%|███████▋  | 1967/2552 [1:31:20<12:29,  1.28s/it] 77%|███████▋  | 1968/2552 [1:31:21<13:01,  1.34s/it] 77%|███████▋  | 1969/2552 [1:31:23<12:43,  1.31s/it] 77%|███████▋  | 1970/2552 [1:31:24<12:24,  1.28s/it]                                                     {'loss': 0.4989, 'grad_norm': 6.823774814605713, 'learning_rate': 1.140282131661442e-05, 'rewards/chosen': -1.0781261920928955, 'rewards/rejected': -1.4078291654586792, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.32970306277275085, 'logps/rejected': -48.64152145385742, 'logps/chosen': -57.6644287109375, 'logits/rejected': -0.7192139029502869, 'logits/chosen': -0.7318277955055237, 'epoch': 0.77}
 77%|███████▋  | 1970/2552 [1:31:24<12:24,  1.28s/it] 77%|███████▋  | 1971/2552 [1:31:25<13:18,  1.37s/it] 77%|███████▋  | 1972/2552 [1:31:27<13:35,  1.41s/it] 77%|███████▋  | 1973/2552 [1:31:28<13:13,  1.37s/it] 77%|███████▋  | 1974/2552 [1:31:29<12:42,  1.32s/it] 77%|███████▋  | 1975/2552 [1:31:31<13:20,  1.39s/it] 77%|███████▋  | 1976/2552 [1:31:33<13:46,  1.43s/it] 77%|███████▋  | 1977/2552 [1:31:34<13:47,  1.44s/it] 78%|███████▊  | 1978/2552 [1:31:35<13:12,  1.38s/it] 78%|███████▊  | 1979/2552 [1:31:37<13:05,  1.37s/it] 78%|███████▊  | 1980/2552 [1:31:38<13:27,  1.41s/it]                                                     {'loss': 0.4998, 'grad_norm': 9.688830375671387, 'learning_rate': 1.1206896551724138e-05, 'rewards/chosen': -0.8724192380905151, 'rewards/rejected': -1.6256154775619507, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.7531961798667908, 'logps/rejected': -42.76534652709961, 'logps/chosen': -34.608795166015625, 'logits/rejected': -0.6982467770576477, 'logits/chosen': -0.6810592412948608, 'epoch': 0.78}
 78%|███████▊  | 1980/2552 [1:31:38<13:27,  1.41s/it] 78%|███████▊  | 1981/2552 [1:31:39<13:18,  1.40s/it] 78%|███████▊  | 1982/2552 [1:31:41<12:40,  1.33s/it] 78%|███████▊  | 1983/2552 [1:31:42<13:16,  1.40s/it] 78%|███████▊  | 1984/2552 [1:31:44<13:41,  1.45s/it] 78%|███████▊  | 1985/2552 [1:31:45<13:54,  1.47s/it] 78%|███████▊  | 1986/2552 [1:31:47<13:20,  1.41s/it] 78%|███████▊  | 1987/2552 [1:31:48<13:25,  1.43s/it] 78%|███████▊  | 1988/2552 [1:31:49<12:51,  1.37s/it] 78%|███████▊  | 1989/2552 [1:31:50<12:13,  1.30s/it] 78%|███████▊  | 1990/2552 [1:31:52<12:09,  1.30s/it]                                                     {'loss': 0.4815, 'grad_norm': 12.42419147491455, 'learning_rate': 1.1010971786833857e-05, 'rewards/chosen': -0.4815010130405426, 'rewards/rejected': -2.0359926223754883, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.5544915199279785, 'logps/rejected': -53.04932403564453, 'logps/chosen': -28.078882217407227, 'logits/rejected': -0.5762780904769897, 'logits/chosen': -0.5636094808578491, 'epoch': 0.78}
 78%|███████▊  | 1990/2552 [1:31:52<12:09,  1.30s/it] 78%|███████▊  | 1991/2552 [1:31:53<12:18,  1.32s/it] 78%|███████▊  | 1992/2552 [1:31:54<12:24,  1.33s/it] 78%|███████▊  | 1993/2552 [1:31:56<11:57,  1.28s/it] 78%|███████▊  | 1994/2552 [1:31:57<12:25,  1.34s/it] 78%|███████▊  | 1995/2552 [1:31:58<12:21,  1.33s/it] 78%|███████▊  | 1996/2552 [1:31:59<11:52,  1.28s/it] 78%|███████▊  | 1997/2552 [1:32:01<11:44,  1.27s/it] 78%|███████▊  | 1998/2552 [1:32:02<12:17,  1.33s/it] 78%|███████▊  | 1999/2552 [1:32:04<12:40,  1.37s/it] 78%|███████▊  | 2000/2552 [1:32:05<13:03,  1.42s/it]                                                     {'loss': 0.5073, 'grad_norm': 9.108036994934082, 'learning_rate': 1.0815047021943574e-05, 'rewards/chosen': -0.8250465393066406, 'rewards/rejected': -1.6759824752807617, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 0.8509360551834106, 'logps/rejected': -41.80743408203125, 'logps/chosen': -35.709598541259766, 'logits/rejected': -0.678313136100769, 'logits/chosen': -0.6818062663078308, 'epoch': 0.78}
 78%|███████▊  | 2000/2552 [1:32:05<13:03,  1.42s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:04,  1.17it/s][A
  4%|▍         | 3/77 [00:02<01:15,  1.03s/it][A
  5%|▌         | 4/77 [00:04<01:21,  1.11s/it][A
  6%|▋         | 5/77 [00:06<01:42,  1.42s/it][A
  8%|▊         | 6/77 [00:07<01:33,  1.31s/it][A
  9%|▉         | 7/77 [00:08<01:31,  1.31s/it][A
 10%|█         | 8/77 [00:10<01:33,  1.36s/it][A
 12%|█▏        | 9/77 [00:11<01:36,  1.42s/it][A
 13%|█▎        | 10/77 [00:12<01:27,  1.31s/it][A
 14%|█▍        | 11/77 [00:13<01:20,  1.21s/it][A
 16%|█▌        | 12/77 [00:15<01:34,  1.45s/it][A
 17%|█▋        | 13/77 [00:17<01:33,  1.46s/it][A
 18%|█▊        | 14/77 [00:18<01:24,  1.33s/it][A
 19%|█▉        | 15/77 [00:19<01:28,  1.42s/it][A
 21%|██        | 16/77 [00:20<01:16,  1.26s/it][A
 22%|██▏       | 17/77 [00:22<01:16,  1.27s/it][A
 23%|██▎       | 18/77 [00:23<01:17,  1.31s/it][A
 25%|██▍       | 19/77 [00:25<01:24,  1.45s/it][A
 26%|██▌       | 20/77 [00:26<01:12,  1.27s/it][A
 27%|██▋       | 21/77 [00:26<01:05,  1.17s/it][A
 29%|██▊       | 22/77 [00:28<01:09,  1.27s/it][A
 30%|██▉       | 23/77 [00:30<01:18,  1.45s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.43s/it][A
 32%|███▏      | 25/77 [00:33<01:12,  1.40s/it][A
 34%|███▍      | 26/77 [00:34<01:04,  1.27s/it][A
 35%|███▌      | 27/77 [00:35<01:06,  1.33s/it][A
 36%|███▋      | 28/77 [00:36<01:02,  1.27s/it][A
 38%|███▊      | 29/77 [00:38<01:08,  1.42s/it][A
 39%|███▉      | 30/77 [00:40<01:11,  1.52s/it][A
 40%|████      | 31/77 [00:41<01:11,  1.55s/it][A
 42%|████▏     | 32/77 [00:43<01:10,  1.56s/it][A
 43%|████▎     | 33/77 [00:44<01:06,  1.52s/it][A
 44%|████▍     | 34/77 [00:46<01:06,  1.54s/it][A
 45%|████▌     | 35/77 [00:47<01:02,  1.49s/it][A
 47%|████▋     | 36/77 [00:49<01:03,  1.56s/it][A
 48%|████▊     | 37/77 [00:50<00:57,  1.44s/it][A
 49%|████▉     | 38/77 [00:51<00:54,  1.39s/it][A
 51%|█████     | 39/77 [00:53<00:57,  1.51s/it][A
 52%|█████▏    | 40/77 [00:55<00:56,  1.54s/it][A
 53%|█████▎    | 41/77 [00:56<00:49,  1.39s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.41s/it][A
 56%|█████▌    | 43/77 [00:59<00:52,  1.54s/it][A
 57%|█████▋    | 44/77 [01:00<00:46,  1.42s/it][A
 58%|█████▊    | 45/77 [01:01<00:41,  1.29s/it][A
 60%|█████▉    | 46/77 [01:03<00:40,  1.29s/it][A
 61%|██████    | 47/77 [01:04<00:38,  1.28s/it][A
 62%|██████▏   | 48/77 [01:05<00:40,  1.38s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.42s/it][A
 65%|██████▍   | 50/77 [01:08<00:38,  1.43s/it][A
 66%|██████▌   | 51/77 [01:10<00:40,  1.54s/it][A
 68%|██████▊   | 52/77 [01:12<00:38,  1.54s/it][A
 69%|██████▉   | 53/77 [01:14<00:39,  1.64s/it][A
 70%|███████   | 54/77 [01:15<00:35,  1.54s/it][A
 71%|███████▏  | 55/77 [01:17<00:34,  1.58s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.67s/it][A
 74%|███████▍  | 57/77 [01:20<00:31,  1.56s/it][A
 75%|███████▌  | 58/77 [01:21<00:29,  1.58s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.57s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.42s/it][A
 79%|███████▉  | 61/77 [01:26<00:23,  1.50s/it][A
 81%|████████  | 62/77 [01:27<00:22,  1.47s/it][A
 82%|████████▏ | 63/77 [01:29<00:21,  1.53s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.41s/it][A
 84%|████████▍ | 65/77 [01:31<00:16,  1.41s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.56s/it][A
 87%|████████▋ | 67/77 [01:34<00:12,  1.30s/it][A
 88%|████████▊ | 68/77 [01:36<00:13,  1.47s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.44s/it][A
 91%|█████████ | 70/77 [01:38<00:09,  1.38s/it][A
 92%|█████████▏| 71/77 [01:39<00:07,  1.29s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.32s/it][A
 95%|█████████▍| 73/77 [01:43<00:05,  1.43s/it][A
 96%|█████████▌| 74/77 [01:45<00:04,  1.60s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.53s/it][A
 99%|█████████▊| 76/77 [01:47<00:01,  1.48s/it][A
100%|██████████| 77/77 [01:49<00:00,  1.53s/it][A                                                     
                                               [A{'eval_loss': 0.48396578431129456, 'eval_runtime': 110.7125, 'eval_samples_per_second': 11.038, 'eval_steps_per_second': 0.695, 'eval_rewards/chosen': -0.6369295120239258, 'eval_rewards/rejected': -1.7324167490005493, 'eval_rewards/accuracies': 0.7792207598686218, 'eval_rewards/margins': 1.095487117767334, 'eval_logps/rejected': -56.577308654785156, 'eval_logps/chosen': -44.87814712524414, 'eval_logits/rejected': -0.5216988921165466, 'eval_logits/chosen': -0.5205057859420776, 'epoch': 0.78}
 78%|███████▊  | 2000/2552 [1:33:56<13:03,  1.42s/it]
100%|██████████| 77/77 [01:49<00:00,  1.53s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 78%|███████▊  | 2001/2552 [1:34:24<6:32:14, 42.71s/it] 78%|███████▊  | 2002/2552 [1:34:26<4:37:44, 30.30s/it] 78%|███████▊  | 2003/2552 [1:34:27<3:17:55, 21.63s/it] 79%|███████▊  | 2004/2552 [1:34:28<2:21:46, 15.52s/it] 79%|███████▊  | 2005/2552 [1:34:30<1:42:41, 11.26s/it] 79%|███████▊  | 2006/2552 [1:34:31<1:15:36,  8.31s/it] 79%|███████▊  | 2007/2552 [1:34:32<56:45,  6.25s/it]   79%|███████▊  | 2008/2552 [1:34:34<43:38,  4.81s/it] 79%|███████▊  | 2009/2552 [1:34:36<34:59,  3.87s/it] 79%|███████▉  | 2010/2552 [1:34:37<28:34,  3.16s/it]                                                     {'loss': 0.4701, 'grad_norm': 6.734731674194336, 'learning_rate': 1.0619122257053291e-05, 'rewards/chosen': -0.9493027925491333, 'rewards/rejected': -2.276052951812744, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.3267500400543213, 'logps/rejected': -48.44223403930664, 'logps/chosen': -48.0244255065918, 'logits/rejected': -0.4872257709503174, 'logits/chosen': -0.48404765129089355, 'epoch': 0.79}
 79%|███████▉  | 2010/2552 [1:34:37<28:34,  3.16s/it] 79%|███████▉  | 2011/2552 [1:34:39<24:17,  2.69s/it] 79%|███████▉  | 2012/2552 [1:34:40<20:40,  2.30s/it] 79%|███████▉  | 2013/2552 [1:34:41<17:45,  1.98s/it] 79%|███████▉  | 2014/2552 [1:34:43<15:38,  1.74s/it] 79%|███████▉  | 2015/2552 [1:34:44<15:07,  1.69s/it] 79%|███████▉  | 2016/2552 [1:34:46<14:26,  1.62s/it] 79%|███████▉  | 2017/2552 [1:34:47<14:10,  1.59s/it] 79%|███████▉  | 2018/2552 [1:34:49<14:14,  1.60s/it] 79%|███████▉  | 2019/2552 [1:34:50<13:09,  1.48s/it] 79%|███████▉  | 2020/2552 [1:34:51<12:49,  1.45s/it]                                                     {'loss': 0.4608, 'grad_norm': 9.705517768859863, 'learning_rate': 1.0423197492163011e-05, 'rewards/chosen': -0.9276559948921204, 'rewards/rejected': -1.2365620136260986, 'rewards/accuracies': 0.5, 'rewards/margins': 0.30890607833862305, 'logps/rejected': -36.465946197509766, 'logps/chosen': -46.73169708251953, 'logits/rejected': -0.5825018286705017, 'logits/chosen': -0.5939195156097412, 'epoch': 0.79}
 79%|███████▉  | 2020/2552 [1:34:51<12:49,  1.45s/it] 79%|███████▉  | 2021/2552 [1:34:52<12:17,  1.39s/it] 79%|███████▉  | 2022/2552 [1:34:54<11:39,  1.32s/it] 79%|███████▉  | 2023/2552 [1:34:55<11:35,  1.31s/it] 79%|███████▉  | 2024/2552 [1:34:56<11:15,  1.28s/it] 79%|███████▉  | 2025/2552 [1:34:57<11:19,  1.29s/it] 79%|███████▉  | 2026/2552 [1:34:59<11:16,  1.29s/it] 79%|███████▉  | 2027/2552 [1:35:00<12:00,  1.37s/it] 79%|███████▉  | 2028/2552 [1:35:02<11:54,  1.36s/it] 80%|███████▉  | 2029/2552 [1:35:03<12:19,  1.41s/it] 80%|███████▉  | 2030/2552 [1:35:05<12:37,  1.45s/it]                                                     {'loss': 0.5049, 'grad_norm': 12.557828903198242, 'learning_rate': 1.0227272727272729e-05, 'rewards/chosen': -0.511530876159668, 'rewards/rejected': -2.333726167678833, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.822195291519165, 'logps/rejected': -92.77751159667969, 'logps/chosen': -36.34046173095703, 'logits/rejected': -0.5450008511543274, 'logits/chosen': -0.5089372992515564, 'epoch': 0.8}
 80%|███████▉  | 2030/2552 [1:35:05<12:37,  1.45s/it] 80%|███████▉  | 2031/2552 [1:35:06<12:03,  1.39s/it] 80%|███████▉  | 2032/2552 [1:35:07<11:40,  1.35s/it] 80%|███████▉  | 2033/2552 [1:35:08<11:28,  1.33s/it] 80%|███████▉  | 2034/2552 [1:35:10<11:13,  1.30s/it] 80%|███████▉  | 2035/2552 [1:35:11<10:54,  1.27s/it] 80%|███████▉  | 2036/2552 [1:35:12<11:25,  1.33s/it] 80%|███████▉  | 2037/2552 [1:35:14<11:11,  1.30s/it] 80%|███████▉  | 2038/2552 [1:35:15<11:02,  1.29s/it] 80%|███████▉  | 2039/2552 [1:35:16<10:40,  1.25s/it] 80%|███████▉  | 2040/2552 [1:35:17<10:26,  1.22s/it]                                                     {'loss': 0.4904, 'grad_norm': 8.87597370147705, 'learning_rate': 1.0031347962382445e-05, 'rewards/chosen': -1.237693428993225, 'rewards/rejected': -1.7498213052749634, 'rewards/accuracies': 0.5, 'rewards/margins': 0.5121278166770935, 'logps/rejected': -68.7200927734375, 'logps/chosen': -75.58656311035156, 'logits/rejected': -0.6304465532302856, 'logits/chosen': -0.6476927995681763, 'epoch': 0.8}
 80%|███████▉  | 2040/2552 [1:35:17<10:26,  1.22s/it] 80%|███████▉  | 2041/2552 [1:35:19<11:01,  1.29s/it] 80%|████████  | 2042/2552 [1:35:20<10:57,  1.29s/it] 80%|████████  | 2043/2552 [1:35:22<11:40,  1.38s/it] 80%|████████  | 2044/2552 [1:35:23<11:24,  1.35s/it] 80%|████████  | 2045/2552 [1:35:24<11:47,  1.40s/it] 80%|████████  | 2046/2552 [1:35:26<11:24,  1.35s/it] 80%|████████  | 2047/2552 [1:35:27<11:41,  1.39s/it] 80%|████████  | 2048/2552 [1:35:29<11:58,  1.42s/it] 80%|████████  | 2049/2552 [1:35:30<11:59,  1.43s/it] 80%|████████  | 2050/2552 [1:35:31<12:03,  1.44s/it]                                                     {'loss': 0.6097, 'grad_norm': 9.332906723022461, 'learning_rate': 9.835423197492163e-06, 'rewards/chosen': -0.4017787575721741, 'rewards/rejected': -1.058042287826538, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.6562634706497192, 'logps/rejected': -58.73334884643555, 'logps/chosen': -42.212547302246094, 'logits/rejected': -0.7403817176818848, 'logits/chosen': -0.7152398824691772, 'epoch': 0.8}
 80%|████████  | 2050/2552 [1:35:32<12:03,  1.44s/it] 80%|████████  | 2051/2552 [1:35:33<11:25,  1.37s/it] 80%|████████  | 2052/2552 [1:35:34<11:27,  1.37s/it] 80%|████████  | 2053/2552 [1:35:35<11:07,  1.34s/it] 80%|████████  | 2054/2552 [1:35:37<11:42,  1.41s/it] 81%|████████  | 2055/2552 [1:35:38<11:04,  1.34s/it] 81%|████████  | 2056/2552 [1:35:40<11:31,  1.39s/it] 81%|████████  | 2057/2552 [1:35:41<11:18,  1.37s/it] 81%|████████  | 2058/2552 [1:35:42<10:45,  1.31s/it] 81%|████████  | 2059/2552 [1:35:44<11:29,  1.40s/it] 81%|████████  | 2060/2552 [1:35:45<11:11,  1.36s/it]                                                     {'loss': 0.4289, 'grad_norm': 8.636527061462402, 'learning_rate': 9.639498432601882e-06, 'rewards/chosen': -0.29839032888412476, 'rewards/rejected': -1.7158807516098022, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.4174906015396118, 'logps/rejected': -41.49070358276367, 'logps/chosen': -26.029613494873047, 'logits/rejected': -0.6279075741767883, 'logits/chosen': -0.606092095375061, 'epoch': 0.81}
 81%|████████  | 2060/2552 [1:35:45<11:11,  1.36s/it] 81%|████████  | 2061/2552 [1:35:46<10:53,  1.33s/it] 81%|████████  | 2062/2552 [1:35:47<10:35,  1.30s/it] 81%|████████  | 2063/2552 [1:35:49<10:42,  1.31s/it] 81%|████████  | 2064/2552 [1:35:50<10:20,  1.27s/it] 81%|████████  | 2065/2552 [1:35:51<10:11,  1.26s/it] 81%|████████  | 2066/2552 [1:35:53<10:51,  1.34s/it] 81%|████████  | 2067/2552 [1:35:54<10:18,  1.27s/it] 81%|████████  | 2068/2552 [1:35:55<10:28,  1.30s/it] 81%|████████  | 2069/2552 [1:35:56<10:17,  1.28s/it] 81%|████████  | 2070/2552 [1:35:58<10:15,  1.28s/it]                                                     {'loss': 0.5085, 'grad_norm': 11.991693496704102, 'learning_rate': 9.443573667711598e-06, 'rewards/chosen': -1.1208807229995728, 'rewards/rejected': -1.9580011367797852, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.8371206521987915, 'logps/rejected': -70.44801330566406, 'logps/chosen': -53.29645538330078, 'logits/rejected': -0.6532113552093506, 'logits/chosen': -0.6308668851852417, 'epoch': 0.81}
 81%|████████  | 2070/2552 [1:35:58<10:15,  1.28s/it] 81%|████████  | 2071/2552 [1:35:59<10:57,  1.37s/it] 81%|████████  | 2072/2552 [1:36:01<11:10,  1.40s/it] 81%|████████  | 2073/2552 [1:36:02<10:35,  1.33s/it] 81%|████████▏ | 2074/2552 [1:36:03<10:13,  1.28s/it] 81%|████████▏ | 2075/2552 [1:36:04<09:52,  1.24s/it] 81%|████████▏ | 2076/2552 [1:36:05<09:54,  1.25s/it] 81%|████████▏ | 2077/2552 [1:36:07<09:49,  1.24s/it] 81%|████████▏ | 2078/2552 [1:36:08<09:50,  1.25s/it] 81%|████████▏ | 2079/2552 [1:36:09<09:46,  1.24s/it] 82%|████████▏ | 2080/2552 [1:36:11<10:31,  1.34s/it]                                                     {'loss': 0.5961, 'grad_norm': 11.753193855285645, 'learning_rate': 9.247648902821316e-06, 'rewards/chosen': -1.186538815498352, 'rewards/rejected': -1.8761574029922485, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.6896184682846069, 'logps/rejected': -87.610107421875, 'logps/chosen': -73.81684112548828, 'logits/rejected': -0.6738007664680481, 'logits/chosen': -0.6813929677009583, 'epoch': 0.82}
 82%|████████▏ | 2080/2552 [1:36:11<10:31,  1.34s/it] 82%|████████▏ | 2081/2552 [1:36:12<10:19,  1.32s/it] 82%|████████▏ | 2082/2552 [1:36:13<10:12,  1.30s/it] 82%|████████▏ | 2083/2552 [1:36:14<09:49,  1.26s/it] 82%|████████▏ | 2084/2552 [1:36:16<09:57,  1.28s/it] 82%|████████▏ | 2085/2552 [1:36:17<09:40,  1.24s/it] 82%|████████▏ | 2086/2552 [1:36:18<09:38,  1.24s/it] 82%|████████▏ | 2087/2552 [1:36:20<10:29,  1.35s/it] 82%|████████▏ | 2088/2552 [1:36:21<10:24,  1.35s/it] 82%|████████▏ | 2089/2552 [1:36:22<10:13,  1.32s/it] 82%|████████▏ | 2090/2552 [1:36:24<10:33,  1.37s/it]                                                     {'loss': 0.5198, 'grad_norm': 8.595417976379395, 'learning_rate': 9.051724137931036e-06, 'rewards/chosen': -0.3534954786300659, 'rewards/rejected': -1.6063604354858398, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.2528650760650635, 'logps/rejected': -56.42805099487305, 'logps/chosen': -51.551002502441406, 'logits/rejected': -0.666223406791687, 'logits/chosen': -0.6729666590690613, 'epoch': 0.82}
 82%|████████▏ | 2090/2552 [1:36:24<10:33,  1.37s/it] 82%|████████▏ | 2091/2552 [1:36:25<10:26,  1.36s/it] 82%|████████▏ | 2092/2552 [1:36:26<09:59,  1.30s/it] 82%|████████▏ | 2093/2552 [1:36:28<09:58,  1.30s/it] 82%|████████▏ | 2094/2552 [1:36:29<09:51,  1.29s/it] 82%|████████▏ | 2095/2552 [1:36:30<10:20,  1.36s/it] 82%|████████▏ | 2096/2552 [1:36:32<09:52,  1.30s/it] 82%|████████▏ | 2097/2552 [1:36:33<10:24,  1.37s/it] 82%|████████▏ | 2098/2552 [1:36:35<10:31,  1.39s/it] 82%|████████▏ | 2099/2552 [1:36:36<10:57,  1.45s/it] 82%|████████▏ | 2100/2552 [1:36:38<11:10,  1.48s/it]                                                     {'loss': 0.5364, 'grad_norm': 7.657257556915283, 'learning_rate': 8.855799373040753e-06, 'rewards/chosen': -0.727817714214325, 'rewards/rejected': -1.3932929039001465, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.6654751896858215, 'logps/rejected': -51.38917922973633, 'logps/chosen': -45.790836334228516, 'logits/rejected': -0.7026714086532593, 'logits/chosen': -0.7038886547088623, 'epoch': 0.82}
 82%|████████▏ | 2100/2552 [1:36:38<11:10,  1.48s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:01,  1.21it/s][A
  4%|▍         | 3/77 [00:02<01:14,  1.00s/it][A
  5%|▌         | 4/77 [00:04<01:20,  1.11s/it][A
  6%|▋         | 5/77 [00:06<01:40,  1.39s/it][A
  8%|▊         | 6/77 [00:07<01:31,  1.29s/it][A
  9%|▉         | 7/77 [00:08<01:32,  1.32s/it][A
 10%|█         | 8/77 [00:10<01:34,  1.38s/it][A
 12%|█▏        | 9/77 [00:11<01:37,  1.43s/it][A
 13%|█▎        | 10/77 [00:12<01:28,  1.33s/it][A
 14%|█▍        | 11/77 [00:13<01:21,  1.23s/it][A
 16%|█▌        | 12/77 [00:15<01:34,  1.46s/it][A
 17%|█▋        | 13/77 [00:16<01:27,  1.37s/it][A
 18%|█▊        | 14/77 [00:18<01:22,  1.31s/it][A
 19%|█▉        | 15/77 [00:19<01:28,  1.43s/it][A
 21%|██        | 16/77 [00:20<01:16,  1.25s/it][A
 22%|██▏       | 17/77 [00:21<01:15,  1.26s/it][A
 23%|██▎       | 18/77 [00:23<01:16,  1.30s/it][A
 25%|██▍       | 19/77 [00:25<01:24,  1.46s/it][A
 26%|██▌       | 20/77 [00:25<01:11,  1.26s/it][A
 27%|██▋       | 21/77 [00:26<01:05,  1.18s/it][A
 29%|██▊       | 22/77 [00:28<01:11,  1.30s/it][A
 30%|██▉       | 23/77 [00:30<01:19,  1.47s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.43s/it][A
 32%|███▏      | 25/77 [00:32<01:12,  1.40s/it][A
 34%|███▍      | 26/77 [00:34<01:05,  1.29s/it][A
 35%|███▌      | 27/77 [00:35<01:06,  1.34s/it][A
 36%|███▋      | 28/77 [00:36<01:01,  1.27s/it][A
 38%|███▊      | 29/77 [00:38<01:07,  1.40s/it][A
 39%|███▉      | 30/77 [00:40<01:11,  1.51s/it][A
 40%|████      | 31/77 [00:41<01:11,  1.55s/it][A
 42%|████▏     | 32/77 [00:43<01:09,  1.55s/it][A
 43%|████▎     | 33/77 [00:44<01:07,  1.53s/it][A
 44%|████▍     | 34/77 [00:46<01:05,  1.53s/it][A
 45%|████▌     | 35/77 [00:47<01:02,  1.49s/it][A
 47%|████▋     | 36/77 [00:49<01:03,  1.55s/it][A
 48%|████▊     | 37/77 [00:50<00:57,  1.43s/it][A
 49%|████▉     | 38/77 [00:51<00:51,  1.32s/it][A
 51%|█████     | 39/77 [00:53<00:57,  1.51s/it][A
 52%|█████▏    | 40/77 [00:55<00:57,  1.54s/it][A
 53%|█████▎    | 41/77 [00:56<00:50,  1.39s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.41s/it][A
 56%|█████▌    | 43/77 [00:59<00:52,  1.54s/it][A
 57%|█████▋    | 44/77 [01:00<00:46,  1.41s/it][A
 58%|█████▊    | 45/77 [01:01<00:40,  1.28s/it][A
 60%|█████▉    | 46/77 [01:02<00:40,  1.30s/it][A
 61%|██████    | 47/77 [01:04<00:38,  1.28s/it][A
 62%|██████▏   | 48/77 [01:05<00:40,  1.38s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.41s/it][A
 65%|██████▍   | 50/77 [01:08<00:38,  1.43s/it][A
 66%|██████▌   | 51/77 [01:10<00:40,  1.54s/it][A
 68%|██████▊   | 52/77 [01:12<00:38,  1.52s/it][A
 69%|██████▉   | 53/77 [01:13<00:39,  1.63s/it][A
 70%|███████   | 54/77 [01:15<00:35,  1.53s/it][A
 71%|███████▏  | 55/77 [01:16<00:31,  1.44s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.67s/it][A
 74%|███████▍  | 57/77 [01:19<00:31,  1.56s/it][A
 75%|███████▌  | 58/77 [01:21<00:30,  1.59s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.58s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.42s/it][A
 79%|███████▉  | 61/77 [01:25<00:23,  1.49s/it][A
 81%|████████  | 62/77 [01:27<00:21,  1.46s/it][A
 82%|████████▏ | 63/77 [01:28<00:21,  1.54s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.42s/it][A
 84%|████████▍ | 65/77 [01:31<00:16,  1.40s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.56s/it][A
 87%|████████▋ | 67/77 [01:34<00:13,  1.34s/it][A
 88%|████████▊ | 68/77 [01:35<00:13,  1.44s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.43s/it][A
 91%|█████████ | 70/77 [01:38<00:09,  1.37s/it][A
 92%|█████████▏| 71/77 [01:39<00:07,  1.29s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.32s/it][A
 95%|█████████▍| 73/77 [01:42<00:05,  1.42s/it][A
 96%|█████████▌| 74/77 [01:44<00:04,  1.59s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.53s/it][A
 99%|█████████▊| 76/77 [01:47<00:01,  1.48s/it][A
100%|██████████| 77/77 [01:48<00:00,  1.51s/it][A                                                     
                                               [A{'eval_loss': 0.48718512058258057, 'eval_runtime': 110.3182, 'eval_samples_per_second': 11.077, 'eval_steps_per_second': 0.698, 'eval_rewards/chosen': -0.5518440008163452, 'eval_rewards/rejected': -1.7242461442947388, 'eval_rewards/accuracies': 0.7727272510528564, 'eval_rewards/margins': 1.172402262687683, 'eval_logps/rejected': -56.49560546875, 'eval_logps/chosen': -44.02729415893555, 'eval_logits/rejected': -0.5184546113014221, 'eval_logits/chosen': -0.5183764100074768, 'epoch': 0.82}
 82%|████████▏ | 2100/2552 [1:38:28<11:10,  1.48s/it]
100%|██████████| 77/77 [01:49<00:00,  1.51s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 82%|████████▏ | 2101/2552 [1:38:56<5:20:26, 42.63s/it] 82%|████████▏ | 2102/2552 [1:38:58<3:47:14, 30.30s/it] 82%|████████▏ | 2103/2552 [1:39:00<2:43:09, 21.80s/it] 82%|████████▏ | 2104/2552 [1:39:01<1:57:28, 15.73s/it] 82%|████████▏ | 2105/2552 [1:39:03<1:25:07, 11.43s/it] 83%|████████▎ | 2106/2552 [1:39:04<1:01:59,  8.34s/it] 83%|████████▎ | 2107/2552 [1:39:05<46:14,  6.23s/it]   83%|████████▎ | 2108/2552 [1:39:06<34:50,  4.71s/it] 83%|████████▎ | 2109/2552 [1:39:08<26:57,  3.65s/it] 83%|████████▎ | 2110/2552 [1:39:09<21:59,  2.99s/it]                                                     {'loss': 0.3937, 'grad_norm': 7.260590076446533, 'learning_rate': 8.65987460815047e-06, 'rewards/chosen': -0.6557151079177856, 'rewards/rejected': -2.2947535514831543, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.6390384435653687, 'logps/rejected': -59.71506881713867, 'logps/chosen': -41.775901794433594, 'logits/rejected': -0.6415303945541382, 'logits/chosen': -0.6246462464332581, 'epoch': 0.83}
 83%|████████▎ | 2110/2552 [1:39:09<21:59,  2.99s/it] 83%|████████▎ | 2111/2552 [1:39:10<18:08,  2.47s/it] 83%|████████▎ | 2112/2552 [1:39:12<16:07,  2.20s/it] 83%|████████▎ | 2113/2552 [1:39:14<14:51,  2.03s/it] 83%|████████▎ | 2114/2552 [1:39:15<13:44,  1.88s/it] 83%|████████▎ | 2115/2552 [1:39:17<12:53,  1.77s/it] 83%|████████▎ | 2116/2552 [1:39:18<11:36,  1.60s/it] 83%|████████▎ | 2117/2552 [1:39:19<10:42,  1.48s/it] 83%|████████▎ | 2118/2552 [1:39:20<10:02,  1.39s/it] 83%|████████▎ | 2119/2552 [1:39:22<10:23,  1.44s/it] 83%|████████▎ | 2120/2552 [1:39:23<10:04,  1.40s/it]                                                     {'loss': 0.5946, 'grad_norm': 25.34031867980957, 'learning_rate': 8.463949843260189e-06, 'rewards/chosen': -0.3517124652862549, 'rewards/rejected': -1.9658334255218506, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.614121437072754, 'logps/rejected': -38.59661102294922, 'logps/chosen': -19.947187423706055, 'logits/rejected': -0.604767918586731, 'logits/chosen': -0.5973657369613647, 'epoch': 0.83}
 83%|████████▎ | 2120/2552 [1:39:23<10:04,  1.40s/it] 83%|████████▎ | 2121/2552 [1:39:24<09:46,  1.36s/it] 83%|████████▎ | 2122/2552 [1:39:26<09:45,  1.36s/it] 83%|████████▎ | 2123/2552 [1:39:27<10:04,  1.41s/it] 83%|████████▎ | 2124/2552 [1:39:29<10:11,  1.43s/it] 83%|████████▎ | 2125/2552 [1:39:30<09:41,  1.36s/it] 83%|████████▎ | 2126/2552 [1:39:31<09:15,  1.30s/it] 83%|████████▎ | 2127/2552 [1:39:32<08:55,  1.26s/it] 83%|████████▎ | 2128/2552 [1:39:34<09:40,  1.37s/it] 83%|████████▎ | 2129/2552 [1:39:35<09:54,  1.40s/it] 83%|████████▎ | 2130/2552 [1:39:37<10:08,  1.44s/it]                                                     {'loss': 0.5159, 'grad_norm': 3.527116060256958, 'learning_rate': 8.268025078369907e-06, 'rewards/chosen': -0.4771220088005066, 'rewards/rejected': -2.5336291790008545, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 2.056507110595703, 'logps/rejected': -69.18486022949219, 'logps/chosen': -36.69293975830078, 'logits/rejected': -0.6871333718299866, 'logits/chosen': -0.6586402654647827, 'epoch': 0.83}
 83%|████████▎ | 2130/2552 [1:39:37<10:08,  1.44s/it] 84%|████████▎ | 2131/2552 [1:39:38<09:43,  1.39s/it] 84%|████████▎ | 2132/2552 [1:39:39<09:26,  1.35s/it] 84%|████████▎ | 2133/2552 [1:39:41<09:40,  1.38s/it] 84%|████████▎ | 2134/2552 [1:39:42<09:25,  1.35s/it] 84%|████████▎ | 2135/2552 [1:39:44<09:58,  1.43s/it] 84%|████████▎ | 2136/2552 [1:39:45<09:55,  1.43s/it] 84%|████████▎ | 2137/2552 [1:39:46<09:38,  1.39s/it] 84%|████████▍ | 2138/2552 [1:39:48<09:18,  1.35s/it] 84%|████████▍ | 2139/2552 [1:39:49<09:07,  1.33s/it] 84%|████████▍ | 2140/2552 [1:39:50<09:07,  1.33s/it]                                                     {'loss': 0.5509, 'grad_norm': 21.356502532958984, 'learning_rate': 8.072100313479625e-06, 'rewards/chosen': -0.312280535697937, 'rewards/rejected': -1.7034294605255127, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.3911488056182861, 'logps/rejected': -80.22886657714844, 'logps/chosen': -59.948402404785156, 'logits/rejected': -0.6291585564613342, 'logits/chosen': -0.6220086216926575, 'epoch': 0.84}
 84%|████████▍ | 2140/2552 [1:39:50<09:07,  1.33s/it] 84%|████████▍ | 2141/2552 [1:39:52<09:00,  1.32s/it] 84%|████████▍ | 2142/2552 [1:39:53<08:40,  1.27s/it] 84%|████████▍ | 2143/2552 [1:39:54<08:53,  1.31s/it] 84%|████████▍ | 2144/2552 [1:39:55<08:37,  1.27s/it] 84%|████████▍ | 2145/2552 [1:39:56<08:20,  1.23s/it] 84%|████████▍ | 2146/2552 [1:39:58<08:08,  1.20s/it] 84%|████████▍ | 2147/2552 [1:39:59<08:46,  1.30s/it] 84%|████████▍ | 2148/2552 [1:40:01<09:18,  1.38s/it] 84%|████████▍ | 2149/2552 [1:40:02<08:56,  1.33s/it] 84%|████████▍ | 2150/2552 [1:40:03<08:37,  1.29s/it]                                                     {'loss': 0.5761, 'grad_norm': 9.147590637207031, 'learning_rate': 7.876175548589341e-06, 'rewards/chosen': -0.5046472549438477, 'rewards/rejected': -1.5393221378326416, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.0346747636795044, 'logps/rejected': -47.354732513427734, 'logps/chosen': -30.698034286499023, 'logits/rejected': -0.5902795791625977, 'logits/chosen': -0.569160521030426, 'epoch': 0.84}
 84%|████████▍ | 2150/2552 [1:40:03<08:37,  1.29s/it] 84%|████████▍ | 2151/2552 [1:40:04<08:33,  1.28s/it] 84%|████████▍ | 2152/2552 [1:40:06<09:08,  1.37s/it] 84%|████████▍ | 2153/2552 [1:40:07<08:50,  1.33s/it] 84%|████████▍ | 2154/2552 [1:40:09<09:11,  1.39s/it] 84%|████████▍ | 2155/2552 [1:40:10<08:48,  1.33s/it] 84%|████████▍ | 2156/2552 [1:40:11<08:31,  1.29s/it] 85%|████████▍ | 2157/2552 [1:40:13<09:04,  1.38s/it] 85%|████████▍ | 2158/2552 [1:40:14<08:42,  1.33s/it] 85%|████████▍ | 2159/2552 [1:40:15<08:44,  1.33s/it] 85%|████████▍ | 2160/2552 [1:40:16<08:20,  1.28s/it]                                                     {'loss': 0.4863, 'grad_norm': 8.915047645568848, 'learning_rate': 7.68025078369906e-06, 'rewards/chosen': -0.025830984115600586, 'rewards/rejected': -2.2999823093414307, 'rewards/accuracies': 1.0, 'rewards/margins': 2.27415132522583, 'logps/rejected': -72.06941986083984, 'logps/chosen': -33.933204650878906, 'logits/rejected': -0.616572380065918, 'logits/chosen': -0.5921934247016907, 'epoch': 0.85}
 85%|████████▍ | 2160/2552 [1:40:16<08:20,  1.28s/it] 85%|████████▍ | 2161/2552 [1:40:18<09:01,  1.39s/it] 85%|████████▍ | 2162/2552 [1:40:19<09:05,  1.40s/it] 85%|████████▍ | 2163/2552 [1:40:21<08:36,  1.33s/it] 85%|████████▍ | 2164/2552 [1:40:22<08:19,  1.29s/it] 85%|████████▍ | 2165/2552 [1:40:23<08:36,  1.33s/it] 85%|████████▍ | 2166/2552 [1:40:24<08:22,  1.30s/it] 85%|████████▍ | 2167/2552 [1:40:26<08:46,  1.37s/it] 85%|████████▍ | 2168/2552 [1:40:27<08:33,  1.34s/it] 85%|████████▍ | 2169/2552 [1:40:29<09:01,  1.41s/it] 85%|████████▌ | 2170/2552 [1:40:30<08:41,  1.37s/it]                                                     {'loss': 0.5817, 'grad_norm': 8.40466022491455, 'learning_rate': 7.484326018808778e-06, 'rewards/chosen': -0.2870278060436249, 'rewards/rejected': -1.7203738689422607, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.433346152305603, 'logps/rejected': -58.2672119140625, 'logps/chosen': -43.09931945800781, 'logits/rejected': -0.6281402111053467, 'logits/chosen': -0.6292527318000793, 'epoch': 0.85}
 85%|████████▌ | 2170/2552 [1:40:30<08:41,  1.37s/it] 85%|████████▌ | 2171/2552 [1:40:31<08:36,  1.35s/it] 85%|████████▌ | 2172/2552 [1:40:33<08:29,  1.34s/it] 85%|████████▌ | 2173/2552 [1:40:34<08:30,  1.35s/it] 85%|████████▌ | 2174/2552 [1:40:35<08:15,  1.31s/it] 85%|████████▌ | 2175/2552 [1:40:37<08:07,  1.29s/it] 85%|████████▌ | 2176/2552 [1:40:38<08:15,  1.32s/it] 85%|████████▌ | 2177/2552 [1:40:39<08:35,  1.37s/it] 85%|████████▌ | 2178/2552 [1:40:41<08:04,  1.30s/it] 85%|████████▌ | 2179/2552 [1:40:42<08:10,  1.31s/it] 85%|████████▌ | 2180/2552 [1:40:43<07:55,  1.28s/it]                                                     {'loss': 0.5698, 'grad_norm': 9.438746452331543, 'learning_rate': 7.288401253918496e-06, 'rewards/chosen': -0.43789300322532654, 'rewards/rejected': -1.436198115348816, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.9983050227165222, 'logps/rejected': -39.98088455200195, 'logps/chosen': -44.27411651611328, 'logits/rejected': -0.6849751472473145, 'logits/chosen': -0.6918038129806519, 'epoch': 0.85}
 85%|████████▌ | 2180/2552 [1:40:43<07:55,  1.28s/it] 85%|████████▌ | 2181/2552 [1:40:45<08:10,  1.32s/it] 86%|████████▌ | 2182/2552 [1:40:46<07:53,  1.28s/it] 86%|████████▌ | 2183/2552 [1:40:47<07:38,  1.24s/it] 86%|████████▌ | 2184/2552 [1:40:48<07:30,  1.23s/it] 86%|████████▌ | 2185/2552 [1:40:49<07:24,  1.21s/it] 86%|████████▌ | 2186/2552 [1:40:51<07:55,  1.30s/it] 86%|████████▌ | 2187/2552 [1:40:52<08:16,  1.36s/it] 86%|████████▌ | 2188/2552 [1:40:54<08:42,  1.43s/it] 86%|████████▌ | 2189/2552 [1:40:55<08:21,  1.38s/it] 86%|████████▌ | 2190/2552 [1:40:57<08:32,  1.42s/it]                                                     {'loss': 0.4142, 'grad_norm': 10.347599983215332, 'learning_rate': 7.092476489028213e-06, 'rewards/chosen': -0.6360945701599121, 'rewards/rejected': -1.5721807479858398, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.9360860586166382, 'logps/rejected': -53.72588348388672, 'logps/chosen': -50.44180679321289, 'logits/rejected': -0.539162278175354, 'logits/chosen': -0.5249221920967102, 'epoch': 0.86}
 86%|████████▌ | 2190/2552 [1:40:57<08:32,  1.42s/it] 86%|████████▌ | 2191/2552 [1:40:58<08:41,  1.44s/it] 86%|████████▌ | 2192/2552 [1:40:59<08:19,  1.39s/it] 86%|████████▌ | 2193/2552 [1:41:01<08:42,  1.46s/it] 86%|████████▌ | 2194/2552 [1:41:02<08:18,  1.39s/it] 86%|████████▌ | 2195/2552 [1:41:04<08:58,  1.51s/it] 86%|████████▌ | 2196/2552 [1:41:05<08:19,  1.40s/it] 86%|████████▌ | 2197/2552 [1:41:06<07:48,  1.32s/it] 86%|████████▌ | 2198/2552 [1:41:08<07:37,  1.29s/it] 86%|████████▌ | 2199/2552 [1:41:09<07:36,  1.29s/it] 86%|████████▌ | 2200/2552 [1:41:10<07:24,  1.26s/it]                                                     {'loss': 0.5522, 'grad_norm': 8.830509185791016, 'learning_rate': 6.896551724137932e-06, 'rewards/chosen': -1.1043343544006348, 'rewards/rejected': -1.8283212184906006, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.7239869236946106, 'logps/rejected': -86.2942123413086, 'logps/chosen': -46.03215408325195, 'logits/rejected': -0.6495814919471741, 'logits/chosen': -0.627419650554657, 'epoch': 0.86}
 86%|████████▌ | 2200/2552 [1:41:10<07:24,  1.26s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:04,  1.16it/s][A
  4%|▍         | 3/77 [00:02<01:15,  1.02s/it][A
  5%|▌         | 4/77 [00:04<01:20,  1.10s/it][A
  6%|▋         | 5/77 [00:06<01:41,  1.42s/it][A
  8%|▊         | 6/77 [00:07<01:32,  1.30s/it][A
  9%|▉         | 7/77 [00:08<01:31,  1.31s/it][A
 10%|█         | 8/77 [00:10<01:34,  1.36s/it][A
 12%|█▏        | 9/77 [00:11<01:37,  1.44s/it][A
 13%|█▎        | 10/77 [00:12<01:28,  1.32s/it][A
 14%|█▍        | 11/77 [00:13<01:22,  1.24s/it][A
 16%|█▌        | 12/77 [00:15<01:33,  1.44s/it][A
 17%|█▋        | 13/77 [00:16<01:27,  1.37s/it][A
 18%|█▊        | 14/77 [00:18<01:21,  1.30s/it][A
 19%|█▉        | 15/77 [00:19<01:28,  1.42s/it][A
 21%|██        | 16/77 [00:20<01:16,  1.25s/it][A
 22%|██▏       | 17/77 [00:21<01:15,  1.26s/it][A
 23%|██▎       | 18/77 [00:23<01:16,  1.30s/it][A
 25%|██▍       | 19/77 [00:25<01:23,  1.45s/it][A
 26%|██▌       | 20/77 [00:25<01:11,  1.25s/it][A
 27%|██▋       | 21/77 [00:27<01:09,  1.24s/it][A
 29%|██▊       | 22/77 [00:28<01:09,  1.27s/it][A
 30%|██▉       | 23/77 [00:30<01:18,  1.46s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.42s/it][A
 32%|███▏      | 25/77 [00:32<01:12,  1.39s/it][A
 34%|███▍      | 26/77 [00:34<01:05,  1.28s/it][A
 35%|███▌      | 27/77 [00:35<01:06,  1.33s/it][A
 36%|███▋      | 28/77 [00:36<01:02,  1.27s/it][A
 38%|███▊      | 29/77 [00:38<01:07,  1.41s/it][A
 39%|███▉      | 30/77 [00:40<01:11,  1.52s/it][A
 40%|████      | 31/77 [00:41<01:11,  1.55s/it][A
 42%|████▏     | 32/77 [00:43<01:10,  1.56s/it][A
 43%|████▎     | 33/77 [00:44<01:07,  1.53s/it][A
 44%|████▍     | 34/77 [00:46<01:05,  1.53s/it][A
 45%|████▌     | 35/77 [00:47<01:03,  1.50s/it][A
 47%|████▋     | 36/77 [00:49<01:04,  1.57s/it][A
 48%|████▊     | 37/77 [00:50<00:57,  1.44s/it][A
 49%|████▉     | 38/77 [00:51<00:52,  1.34s/it][A
 51%|█████     | 39/77 [00:53<00:56,  1.50s/it][A
 52%|█████▏    | 40/77 [00:55<00:57,  1.54s/it][A
 53%|█████▎    | 41/77 [00:56<00:50,  1.39s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.41s/it][A
 56%|█████▌    | 43/77 [00:59<00:51,  1.52s/it][A
 57%|█████▋    | 44/77 [01:00<00:46,  1.40s/it][A
 58%|█████▊    | 45/77 [01:01<00:40,  1.28s/it][A
 60%|█████▉    | 46/77 [01:02<00:39,  1.29s/it][A
 61%|██████    | 47/77 [01:04<00:38,  1.27s/it][A
 62%|██████▏   | 48/77 [01:05<00:40,  1.38s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.41s/it][A
 65%|██████▍   | 50/77 [01:08<00:38,  1.43s/it][A
 66%|██████▌   | 51/77 [01:10<00:39,  1.53s/it][A
 68%|██████▊   | 52/77 [01:12<00:38,  1.53s/it][A
 69%|██████▉   | 53/77 [01:13<00:39,  1.63s/it][A
 70%|███████   | 54/77 [01:15<00:35,  1.52s/it][A
 71%|███████▏  | 55/77 [01:16<00:31,  1.43s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.68s/it][A
 74%|███████▍  | 57/77 [01:19<00:31,  1.57s/it][A
 75%|███████▌  | 58/77 [01:21<00:30,  1.59s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.58s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.42s/it][A
 79%|███████▉  | 61/77 [01:25<00:23,  1.49s/it][A
 81%|████████  | 62/77 [01:27<00:22,  1.47s/it][A
 82%|████████▏ | 63/77 [01:29<00:21,  1.55s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.42s/it][A
 84%|████████▍ | 65/77 [01:31<00:16,  1.41s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.56s/it][A
 87%|████████▋ | 67/77 [01:34<00:12,  1.29s/it][A
 88%|████████▊ | 68/77 [01:35<00:13,  1.47s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.45s/it][A
 91%|█████████ | 70/77 [01:38<00:09,  1.39s/it][A
 92%|█████████▏| 71/77 [01:39<00:07,  1.31s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.34s/it][A
 95%|█████████▍| 73/77 [01:42<00:05,  1.44s/it][A
 96%|█████████▌| 74/77 [01:44<00:04,  1.60s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.54s/it][A
 99%|█████████▊| 76/77 [01:47<00:01,  1.48s/it][A
100%|██████████| 77/77 [01:49<00:00,  1.53s/it][A                                                     
                                               [A{'eval_loss': 0.4842411279678345, 'eval_runtime': 110.5321, 'eval_samples_per_second': 11.056, 'eval_steps_per_second': 0.697, 'eval_rewards/chosen': -0.5664440989494324, 'eval_rewards/rejected': -1.710507869720459, 'eval_rewards/accuracies': 0.7792207598686218, 'eval_rewards/margins': 1.1440638303756714, 'eval_logps/rejected': -56.358219146728516, 'eval_logps/chosen': -44.17329406738281, 'eval_logits/rejected': -0.5191959142684937, 'eval_logits/chosen': -0.518050491809845, 'epoch': 0.86}
 86%|████████▌ | 2200/2552 [1:43:01<07:24,  1.26s/it]
100%|██████████| 77/77 [01:49<00:00,  1.53s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 86%|████████▌ | 2201/2552 [1:43:29<4:08:23, 42.46s/it] 86%|████████▋ | 2202/2552 [1:43:30<2:55:45, 30.13s/it] 86%|████████▋ | 2203/2552 [1:43:31<2:04:45, 21.45s/it] 86%|████████▋ | 2204/2552 [1:43:32<1:29:10, 15.37s/it] 86%|████████▋ | 2205/2552 [1:43:33<1:04:11, 11.10s/it] 86%|████████▋ | 2206/2552 [1:43:35<46:58,  8.15s/it]   86%|████████▋ | 2207/2552 [1:43:36<35:08,  6.11s/it] 87%|████████▋ | 2208/2552 [1:43:37<26:29,  4.62s/it] 87%|████████▋ | 2209/2552 [1:43:38<20:37,  3.61s/it] 87%|████████▋ | 2210/2552 [1:43:40<16:30,  2.90s/it]                                                     {'loss': 0.4426, 'grad_norm': 6.854462146759033, 'learning_rate': 6.7006269592476495e-06, 'rewards/chosen': -0.5680701732635498, 'rewards/rejected': -2.1734611988067627, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.6053907871246338, 'logps/rejected': -39.95553970336914, 'logps/chosen': -35.32553482055664, 'logits/rejected': -0.6542628407478333, 'logits/chosen': -0.6617400050163269, 'epoch': 0.87}
 87%|████████▋ | 2210/2552 [1:43:40<16:30,  2.90s/it] 87%|████████▋ | 2211/2552 [1:43:41<13:47,  2.43s/it] 87%|████████▋ | 2212/2552 [1:43:42<11:48,  2.08s/it] 87%|████████▋ | 2213/2552 [1:43:44<10:34,  1.87s/it] 87%|████████▋ | 2214/2552 [1:43:45<09:34,  1.70s/it] 87%|████████▋ | 2215/2552 [1:43:46<09:01,  1.61s/it] 87%|████████▋ | 2216/2552 [1:43:48<08:19,  1.49s/it] 87%|████████▋ | 2217/2552 [1:43:49<07:49,  1.40s/it] 87%|████████▋ | 2218/2552 [1:43:50<08:01,  1.44s/it] 87%|████████▋ | 2219/2552 [1:43:51<07:27,  1.35s/it] 87%|████████▋ | 2220/2552 [1:43:53<07:05,  1.28s/it]                                                     {'loss': 0.502, 'grad_norm': 9.433772087097168, 'learning_rate': 6.504702194357367e-06, 'rewards/chosen': -0.904791533946991, 'rewards/rejected': -1.627488374710083, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.7226966023445129, 'logps/rejected': -62.26079559326172, 'logps/chosen': -60.763427734375, 'logits/rejected': -0.6374775171279907, 'logits/chosen': -0.6465730667114258, 'epoch': 0.87}
 87%|████████▋ | 2220/2552 [1:43:53<07:05,  1.28s/it] 87%|████████▋ | 2221/2552 [1:43:54<07:36,  1.38s/it] 87%|████████▋ | 2222/2552 [1:43:56<07:36,  1.38s/it] 87%|████████▋ | 2223/2552 [1:43:57<07:24,  1.35s/it] 87%|████████▋ | 2224/2552 [1:43:58<07:07,  1.30s/it] 87%|████████▋ | 2225/2552 [1:43:59<07:06,  1.30s/it] 87%|████████▋ | 2226/2552 [1:44:01<07:19,  1.35s/it] 87%|████████▋ | 2227/2552 [1:44:02<07:31,  1.39s/it] 87%|████████▋ | 2228/2552 [1:44:04<07:43,  1.43s/it] 87%|████████▋ | 2229/2552 [1:44:05<07:18,  1.36s/it] 87%|████████▋ | 2230/2552 [1:44:06<06:59,  1.30s/it]                                                     {'loss': 0.4329, 'grad_norm': 6.7187628746032715, 'learning_rate': 6.308777429467084e-06, 'rewards/chosen': -0.20758111774921417, 'rewards/rejected': -2.2313148975372314, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 2.023733615875244, 'logps/rejected': -44.5223388671875, 'logps/chosen': -38.06739807128906, 'logits/rejected': -0.5561436414718628, 'logits/chosen': -0.5663458704948425, 'epoch': 0.87}
 87%|████████▋ | 2230/2552 [1:44:06<06:59,  1.30s/it] 87%|████████▋ | 2231/2552 [1:44:08<07:29,  1.40s/it] 87%|████████▋ | 2232/2552 [1:44:09<07:11,  1.35s/it] 88%|████████▊ | 2233/2552 [1:44:11<07:34,  1.43s/it] 88%|████████▊ | 2234/2552 [1:44:12<07:27,  1.41s/it] 88%|████████▊ | 2235/2552 [1:44:14<07:37,  1.44s/it] 88%|████████▊ | 2236/2552 [1:44:15<07:25,  1.41s/it] 88%|████████▊ | 2237/2552 [1:44:16<07:33,  1.44s/it] 88%|████████▊ | 2238/2552 [1:44:18<07:27,  1.43s/it] 88%|████████▊ | 2239/2552 [1:44:19<07:33,  1.45s/it] 88%|████████▊ | 2240/2552 [1:44:21<07:42,  1.48s/it]                                                     {'loss': 0.4136, 'grad_norm': 4.639883995056152, 'learning_rate': 6.112852664576803e-06, 'rewards/chosen': -0.3448373079299927, 'rewards/rejected': -1.9513137340545654, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.6064765453338623, 'logps/rejected': -56.46722412109375, 'logps/chosen': -40.55085754394531, 'logits/rejected': -0.6822345852851868, 'logits/chosen': -0.6619223356246948, 'epoch': 0.88}
 88%|████████▊ | 2240/2552 [1:44:21<07:42,  1.48s/it] 88%|████████▊ | 2241/2552 [1:44:22<07:28,  1.44s/it] 88%|████████▊ | 2242/2552 [1:44:23<07:00,  1.36s/it] 88%|████████▊ | 2243/2552 [1:44:25<06:59,  1.36s/it] 88%|████████▊ | 2244/2552 [1:44:26<06:50,  1.33s/it] 88%|████████▊ | 2245/2552 [1:44:27<07:01,  1.37s/it] 88%|████████▊ | 2246/2552 [1:44:29<06:48,  1.33s/it] 88%|████████▊ | 2247/2552 [1:44:30<06:47,  1.34s/it] 88%|████████▊ | 2248/2552 [1:44:31<06:46,  1.34s/it] 88%|████████▊ | 2249/2552 [1:44:33<06:37,  1.31s/it] 88%|████████▊ | 2250/2552 [1:44:34<06:33,  1.30s/it]                                                     {'loss': 0.5593, 'grad_norm': 13.9695405960083, 'learning_rate': 5.916927899686521e-06, 'rewards/chosen': -0.6793861985206604, 'rewards/rejected': -1.7955936193466187, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.1162073612213135, 'logps/rejected': -71.84556579589844, 'logps/chosen': -31.340179443359375, 'logits/rejected': -0.7536908984184265, 'logits/chosen': -0.7315123677253723, 'epoch': 0.88}
 88%|████████▊ | 2250/2552 [1:44:34<06:33,  1.30s/it] 88%|████████▊ | 2251/2552 [1:44:35<06:23,  1.28s/it] 88%|████████▊ | 2252/2552 [1:44:36<06:12,  1.24s/it] 88%|████████▊ | 2253/2552 [1:44:38<06:34,  1.32s/it] 88%|████████▊ | 2254/2552 [1:44:39<06:25,  1.29s/it] 88%|████████▊ | 2255/2552 [1:44:40<06:16,  1.27s/it] 88%|████████▊ | 2256/2552 [1:44:41<06:09,  1.25s/it] 88%|████████▊ | 2257/2552 [1:44:43<05:59,  1.22s/it] 88%|████████▊ | 2258/2552 [1:44:44<06:01,  1.23s/it] 89%|████████▊ | 2259/2552 [1:44:45<06:03,  1.24s/it] 89%|████████▊ | 2260/2552 [1:44:46<05:54,  1.21s/it]                                                     {'loss': 0.6786, 'grad_norm': 14.227153778076172, 'learning_rate': 5.721003134796239e-06, 'rewards/chosen': -0.7559880018234253, 'rewards/rejected': -1.8487584590911865, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 1.0927704572677612, 'logps/rejected': -62.55107498168945, 'logps/chosen': -47.12348937988281, 'logits/rejected': -0.6214005351066589, 'logits/chosen': -0.6134835481643677, 'epoch': 0.89}
 89%|████████▊ | 2260/2552 [1:44:47<05:54,  1.21s/it] 89%|████████▊ | 2261/2552 [1:44:48<06:07,  1.26s/it] 89%|████████▊ | 2262/2552 [1:44:49<06:22,  1.32s/it] 89%|████████▊ | 2263/2552 [1:44:50<06:04,  1.26s/it] 89%|████████▊ | 2264/2552 [1:44:51<05:56,  1.24s/it] 89%|████████▉ | 2265/2552 [1:44:53<06:24,  1.34s/it] 89%|████████▉ | 2266/2552 [1:44:54<06:18,  1.32s/it] 89%|████████▉ | 2267/2552 [1:44:56<06:24,  1.35s/it] 89%|████████▉ | 2268/2552 [1:44:57<06:26,  1.36s/it] 89%|████████▉ | 2269/2552 [1:44:58<06:09,  1.31s/it] 89%|████████▉ | 2270/2552 [1:44:59<05:58,  1.27s/it]                                                     {'loss': 0.5384, 'grad_norm': 9.231587409973145, 'learning_rate': 5.525078369905956e-06, 'rewards/chosen': -0.22075214982032776, 'rewards/rejected': -1.933084487915039, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.7123321294784546, 'logps/rejected': -82.09843444824219, 'logps/chosen': -29.680212020874023, 'logits/rejected': -0.7018603682518005, 'logits/chosen': -0.6542036533355713, 'epoch': 0.89}
 89%|████████▉ | 2270/2552 [1:44:59<05:58,  1.27s/it] 89%|████████▉ | 2271/2552 [1:45:01<06:15,  1.34s/it] 89%|████████▉ | 2272/2552 [1:45:02<06:29,  1.39s/it] 89%|████████▉ | 2273/2552 [1:45:04<06:12,  1.34s/it] 89%|████████▉ | 2274/2552 [1:45:05<06:12,  1.34s/it] 89%|████████▉ | 2275/2552 [1:45:06<05:59,  1.30s/it] 89%|████████▉ | 2276/2552 [1:45:08<06:09,  1.34s/it] 89%|████████▉ | 2277/2552 [1:45:09<06:08,  1.34s/it] 89%|████████▉ | 2278/2552 [1:45:10<06:21,  1.39s/it] 89%|████████▉ | 2279/2552 [1:45:12<06:10,  1.36s/it] 89%|████████▉ | 2280/2552 [1:45:13<06:08,  1.35s/it]                                                     {'loss': 0.5073, 'grad_norm': 10.520657539367676, 'learning_rate': 5.329153605015674e-06, 'rewards/chosen': -0.6408119797706604, 'rewards/rejected': -2.525228977203369, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.8844168186187744, 'logps/rejected': -69.05696105957031, 'logps/chosen': -52.24663162231445, 'logits/rejected': -0.6881890892982483, 'logits/chosen': -0.6753007769584656, 'epoch': 0.89}
 89%|████████▉ | 2280/2552 [1:45:13<06:08,  1.35s/it] 89%|████████▉ | 2281/2552 [1:45:14<06:10,  1.37s/it] 89%|████████▉ | 2282/2552 [1:45:16<05:52,  1.30s/it] 89%|████████▉ | 2283/2552 [1:45:17<05:42,  1.27s/it] 89%|████████▉ | 2284/2552 [1:45:18<06:05,  1.36s/it] 90%|████████▉ | 2285/2552 [1:45:20<05:57,  1.34s/it] 90%|████████▉ | 2286/2552 [1:45:21<05:41,  1.28s/it] 90%|████████▉ | 2287/2552 [1:45:22<05:44,  1.30s/it] 90%|████████▉ | 2288/2552 [1:45:23<05:34,  1.27s/it] 90%|████████▉ | 2289/2552 [1:45:25<05:23,  1.23s/it] 90%|████████▉ | 2290/2552 [1:45:26<05:29,  1.26s/it]                                                     {'loss': 0.4574, 'grad_norm': 6.559695720672607, 'learning_rate': 5.133228840125392e-06, 'rewards/chosen': -0.43355029821395874, 'rewards/rejected': -1.878196120262146, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 1.4446460008621216, 'logps/rejected': -48.92830276489258, 'logps/chosen': -20.803346633911133, 'logits/rejected': -0.5784512758255005, 'logits/chosen': -0.5626078248023987, 'epoch': 0.9}
 90%|████████▉ | 2290/2552 [1:45:26<05:29,  1.26s/it] 90%|████████▉ | 2291/2552 [1:45:27<05:47,  1.33s/it] 90%|████████▉ | 2292/2552 [1:45:29<05:55,  1.37s/it] 90%|████████▉ | 2293/2552 [1:45:30<05:44,  1.33s/it] 90%|████████▉ | 2294/2552 [1:45:31<05:32,  1.29s/it] 90%|████████▉ | 2295/2552 [1:45:33<05:47,  1.35s/it] 90%|████████▉ | 2296/2552 [1:45:34<05:45,  1.35s/it] 90%|█████████ | 2297/2552 [1:45:35<05:29,  1.29s/it] 90%|█████████ | 2298/2552 [1:45:36<05:25,  1.28s/it] 90%|█████████ | 2299/2552 [1:45:38<05:22,  1.28s/it] 90%|█████████ | 2300/2552 [1:45:39<05:41,  1.35s/it]                                                     {'loss': 0.4912, 'grad_norm': 12.018324851989746, 'learning_rate': 4.93730407523511e-06, 'rewards/chosen': -0.28993722796440125, 'rewards/rejected': -1.6059671640396118, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.3160300254821777, 'logps/rejected': -74.20514678955078, 'logps/chosen': -48.590755462646484, 'logits/rejected': -0.6579269170761108, 'logits/chosen': -0.6335003972053528, 'epoch': 0.9}
 90%|█████████ | 2300/2552 [1:45:39<05:41,  1.35s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:06,  1.13it/s][A
  4%|▍         | 3/77 [00:02<01:16,  1.03s/it][A
  5%|▌         | 4/77 [00:04<01:21,  1.11s/it][A
  6%|▋         | 5/77 [00:06<01:42,  1.42s/it][A
  8%|▊         | 6/77 [00:07<01:32,  1.31s/it][A
  9%|▉         | 7/77 [00:08<01:33,  1.34s/it][A
 10%|█         | 8/77 [00:10<01:34,  1.38s/it][A
 12%|█▏        | 9/77 [00:11<01:38,  1.44s/it][A
 13%|█▎        | 10/77 [00:12<01:28,  1.32s/it][A
 14%|█▍        | 11/77 [00:13<01:21,  1.24s/it][A
 16%|█▌        | 12/77 [00:15<01:34,  1.46s/it][A
 17%|█▋        | 13/77 [00:17<01:28,  1.38s/it][A
 18%|█▊        | 14/77 [00:18<01:22,  1.31s/it][A
 19%|█▉        | 15/77 [00:19<01:28,  1.42s/it][A
 21%|██        | 16/77 [00:20<01:15,  1.24s/it][A
 22%|██▏       | 17/77 [00:22<01:15,  1.27s/it][A
 23%|██▎       | 18/77 [00:23<01:16,  1.30s/it][A
 25%|██▍       | 19/77 [00:25<01:24,  1.46s/it][A
 26%|██▌       | 20/77 [00:26<01:12,  1.27s/it][A
 27%|██▋       | 21/77 [00:27<01:05,  1.17s/it][A
 29%|██▊       | 22/77 [00:28<01:11,  1.29s/it][A
 30%|██▉       | 23/77 [00:30<01:19,  1.47s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.43s/it][A
 32%|███▏      | 25/77 [00:33<01:12,  1.40s/it][A
 34%|███▍      | 26/77 [00:34<01:05,  1.28s/it][A
 35%|███▌      | 27/77 [00:35<01:06,  1.33s/it][A
 36%|███▋      | 28/77 [00:36<01:01,  1.26s/it][A
 38%|███▊      | 29/77 [00:38<01:07,  1.41s/it][A
 39%|███▉      | 30/77 [00:40<01:10,  1.51s/it][A
 40%|████      | 31/77 [00:41<01:10,  1.54s/it][A
 42%|████▏     | 32/77 [00:43<01:09,  1.54s/it][A
 43%|████▎     | 33/77 [00:44<01:06,  1.52s/it][A
 44%|████▍     | 34/77 [00:46<01:05,  1.53s/it][A
 45%|████▌     | 35/77 [00:47<01:02,  1.49s/it][A
 47%|████▋     | 36/77 [00:49<01:03,  1.55s/it][A
 48%|████▊     | 37/77 [00:50<00:57,  1.43s/it][A
 49%|████▉     | 38/77 [00:51<00:52,  1.35s/it][A
 51%|█████     | 39/77 [00:53<00:57,  1.52s/it][A
 52%|█████▏    | 40/77 [00:55<00:57,  1.55s/it][A
 53%|█████▎    | 41/77 [00:56<00:50,  1.39s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.41s/it][A
 56%|█████▌    | 43/77 [00:59<00:52,  1.54s/it][A
 57%|█████▋    | 44/77 [01:00<00:46,  1.41s/it][A
 58%|█████▊    | 45/77 [01:01<00:41,  1.28s/it][A
 60%|█████▉    | 46/77 [01:03<00:40,  1.29s/it][A
 61%|██████    | 47/77 [01:04<00:38,  1.28s/it][A
 62%|██████▏   | 48/77 [01:05<00:40,  1.38s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.41s/it][A
 65%|██████▍   | 50/77 [01:08<00:38,  1.42s/it][A
 66%|██████▌   | 51/77 [01:10<00:40,  1.54s/it][A
 68%|██████▊   | 52/77 [01:12<00:38,  1.54s/it][A
 69%|██████▉   | 53/77 [01:14<00:39,  1.64s/it][A
 70%|███████   | 54/77 [01:15<00:34,  1.52s/it][A
 71%|███████▏  | 55/77 [01:16<00:31,  1.43s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.69s/it][A
 74%|███████▍  | 57/77 [01:20<00:31,  1.58s/it][A
 75%|███████▌  | 58/77 [01:21<00:30,  1.60s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.58s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.42s/it][A
 79%|███████▉  | 61/77 [01:26<00:23,  1.49s/it][A
 81%|████████  | 62/77 [01:27<00:21,  1.47s/it][A
 82%|████████▏ | 63/77 [01:29<00:21,  1.54s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.42s/it][A
 84%|████████▍ | 65/77 [01:31<00:16,  1.40s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.55s/it][A
 87%|████████▋ | 67/77 [01:34<00:12,  1.29s/it][A
 88%|████████▊ | 68/77 [01:36<00:13,  1.46s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.44s/it][A
 91%|█████████ | 70/77 [01:38<00:09,  1.37s/it][A
 92%|█████████▏| 71/77 [01:39<00:07,  1.29s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.33s/it][A
 95%|█████████▍| 73/77 [01:42<00:05,  1.44s/it][A
 96%|█████████▌| 74/77 [01:44<00:04,  1.59s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.54s/it][A
 99%|█████████▊| 76/77 [01:47<00:01,  1.48s/it][A
100%|██████████| 77/77 [01:49<00:00,  1.52s/it][A                                                     
                                               [A{'eval_loss': 0.48519283533096313, 'eval_runtime': 110.5812, 'eval_samples_per_second': 11.051, 'eval_steps_per_second': 0.696, 'eval_rewards/chosen': -0.6082709431648254, 'eval_rewards/rejected': -1.7355753183364868, 'eval_rewards/accuracies': 0.7857142686843872, 'eval_rewards/margins': 1.1273040771484375, 'eval_logps/rejected': -56.60889434814453, 'eval_logps/chosen': -44.59156036376953, 'eval_logits/rejected': -0.5193232893943787, 'eval_logits/chosen': -0.5181507468223572, 'epoch': 0.9}
 90%|█████████ | 2300/2552 [1:47:30<05:41,  1.35s/it]
100%|██████████| 77/77 [01:49<00:00,  1.52s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 90%|█████████ | 2301/2552 [1:47:58<2:57:36, 42.45s/it] 90%|█████████ | 2302/2552 [1:47:59<2:05:17, 30.07s/it] 90%|█████████ | 2303/2552 [1:48:00<1:28:52, 21.42s/it] 90%|█████████ | 2304/2552 [1:48:01<1:03:32, 15.37s/it] 90%|█████████ | 2305/2552 [1:48:03<46:09, 11.21s/it]   90%|█████████ | 2306/2552 [1:48:04<34:05,  8.32s/it] 90%|█████████ | 2307/2552 [1:48:06<25:24,  6.22s/it] 90%|█████████ | 2308/2552 [1:48:07<19:07,  4.70s/it] 90%|█████████ | 2309/2552 [1:48:08<15:04,  3.72s/it] 91%|█████████ | 2310/2552 [1:48:10<12:04,  2.99s/it]                                                     {'loss': 0.4974, 'grad_norm': 8.834720611572266, 'learning_rate': 4.741379310344828e-06, 'rewards/chosen': -1.1065151691436768, 'rewards/rejected': -1.5183651447296143, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 0.4118499755859375, 'logps/rejected': -54.089073181152344, 'logps/chosen': -66.14500427246094, 'logits/rejected': -0.6571242809295654, 'logits/chosen': -0.7052870988845825, 'epoch': 0.91}
 91%|█████████ | 2310/2552 [1:48:10<12:04,  2.99s/it] 91%|█████████ | 2311/2552 [1:48:11<10:14,  2.55s/it] 91%|█████████ | 2312/2552 [1:48:12<08:43,  2.18s/it] 91%|█████████ | 2313/2552 [1:48:14<07:34,  1.90s/it] 91%|█████████ | 2314/2552 [1:48:15<06:47,  1.71s/it] 91%|█████████ | 2315/2552 [1:48:16<06:06,  1.55s/it] 91%|█████████ | 2316/2552 [1:48:17<05:36,  1.43s/it] 91%|█████████ | 2317/2552 [1:48:19<05:37,  1.44s/it] 91%|█████████ | 2318/2552 [1:48:20<05:37,  1.44s/it] 91%|█████████ | 2319/2552 [1:48:21<05:18,  1.37s/it] 91%|█████████ | 2320/2552 [1:48:23<05:03,  1.31s/it]                                                     {'loss': 0.5193, 'grad_norm': 10.073713302612305, 'learning_rate': 4.5454545454545455e-06, 'rewards/chosen': -1.0189951658248901, 'rewards/rejected': -1.3705980777740479, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.35160306096076965, 'logps/rejected': -60.74662399291992, 'logps/chosen': -52.94451904296875, 'logits/rejected': -0.5821120738983154, 'logits/chosen': -0.565573513507843, 'epoch': 0.91}
 91%|█████████ | 2320/2552 [1:48:23<05:03,  1.31s/it] 91%|█████████ | 2321/2552 [1:48:24<04:59,  1.30s/it] 91%|█████████ | 2322/2552 [1:48:25<05:19,  1.39s/it] 91%|█████████ | 2323/2552 [1:48:27<05:03,  1.32s/it] 91%|█████████ | 2324/2552 [1:48:28<04:57,  1.30s/it] 91%|█████████ | 2325/2552 [1:48:29<04:55,  1.30s/it] 91%|█████████ | 2326/2552 [1:48:30<04:49,  1.28s/it] 91%|█████████ | 2327/2552 [1:48:32<05:04,  1.35s/it] 91%|█████████ | 2328/2552 [1:48:33<04:53,  1.31s/it] 91%|█████████▏| 2329/2552 [1:48:34<04:49,  1.30s/it] 91%|█████████▏| 2330/2552 [1:48:36<04:54,  1.32s/it]                                                     {'loss': 0.4122, 'grad_norm': 10.496516227722168, 'learning_rate': 4.349529780564263e-06, 'rewards/chosen': -1.1161816120147705, 'rewards/rejected': -2.725846529006958, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.6096646785736084, 'logps/rejected': -86.8085708618164, 'logps/chosen': -52.20771026611328, 'logits/rejected': -0.6891015768051147, 'logits/chosen': -0.6515630483627319, 'epoch': 0.91}
 91%|█████████▏| 2330/2552 [1:48:36<04:54,  1.32s/it] 91%|█████████▏| 2331/2552 [1:48:37<04:44,  1.29s/it] 91%|█████████▏| 2332/2552 [1:48:38<04:37,  1.26s/it] 91%|█████████▏| 2333/2552 [1:48:39<04:32,  1.24s/it] 91%|█████████▏| 2334/2552 [1:48:41<04:30,  1.24s/it] 91%|█████████▏| 2335/2552 [1:48:42<04:32,  1.26s/it] 92%|█████████▏| 2336/2552 [1:48:43<04:25,  1.23s/it] 92%|█████████▏| 2337/2552 [1:48:45<04:38,  1.30s/it] 92%|█████████▏| 2338/2552 [1:48:46<04:31,  1.27s/it] 92%|█████████▏| 2339/2552 [1:48:47<04:23,  1.24s/it] 92%|█████████▏| 2340/2552 [1:48:48<04:35,  1.30s/it]                                                     {'loss': 0.4425, 'grad_norm': 6.122354984283447, 'learning_rate': 4.153605015673981e-06, 'rewards/chosen': -0.5858055949211121, 'rewards/rejected': -1.9583282470703125, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.3725227117538452, 'logps/rejected': -59.97004318237305, 'logps/chosen': -40.47328186035156, 'logits/rejected': -0.6026617288589478, 'logits/chosen': -0.5934627652168274, 'epoch': 0.92}
 92%|█████████▏| 2340/2552 [1:48:48<04:35,  1.30s/it] 92%|█████████▏| 2341/2552 [1:48:50<04:29,  1.28s/it] 92%|█████████▏| 2342/2552 [1:48:51<04:23,  1.25s/it] 92%|█████████▏| 2343/2552 [1:48:52<04:23,  1.26s/it] 92%|█████████▏| 2344/2552 [1:48:53<04:30,  1.30s/it] 92%|█████████▏| 2345/2552 [1:48:55<04:37,  1.34s/it] 92%|█████████▏| 2346/2552 [1:48:56<04:39,  1.36s/it] 92%|█████████▏| 2347/2552 [1:48:58<04:32,  1.33s/it] 92%|█████████▏| 2348/2552 [1:48:59<04:38,  1.37s/it] 92%|█████████▏| 2349/2552 [1:49:00<04:25,  1.31s/it] 92%|█████████▏| 2350/2552 [1:49:02<04:39,  1.39s/it]                                                     {'loss': 0.5919, 'grad_norm': 16.165363311767578, 'learning_rate': 3.957680250783699e-06, 'rewards/chosen': -0.9863824844360352, 'rewards/rejected': -2.1293835639953613, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.1430014371871948, 'logps/rejected': -88.37832641601562, 'logps/chosen': -49.54359817504883, 'logits/rejected': -0.5873443484306335, 'logits/chosen': -0.5368022918701172, 'epoch': 0.92}
 92%|█████████▏| 2350/2552 [1:49:02<04:39,  1.39s/it] 92%|█████████▏| 2351/2552 [1:49:03<04:43,  1.41s/it] 92%|█████████▏| 2352/2552 [1:49:04<04:33,  1.37s/it] 92%|█████████▏| 2353/2552 [1:49:06<04:23,  1.33s/it] 92%|█████████▏| 2354/2552 [1:49:07<04:21,  1.32s/it] 92%|█████████▏| 2355/2552 [1:49:09<04:35,  1.40s/it] 92%|█████████▏| 2356/2552 [1:49:10<04:42,  1.44s/it] 92%|█████████▏| 2357/2552 [1:49:11<04:25,  1.36s/it] 92%|█████████▏| 2358/2552 [1:49:12<04:10,  1.29s/it] 92%|█████████▏| 2359/2552 [1:49:14<04:30,  1.40s/it] 92%|█████████▏| 2360/2552 [1:49:15<04:18,  1.34s/it]                                                     {'loss': 0.4756, 'grad_norm': 4.870386123657227, 'learning_rate': 3.7617554858934172e-06, 'rewards/chosen': -0.7860654592514038, 'rewards/rejected': -1.6528034210205078, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.8667380213737488, 'logps/rejected': -59.82660675048828, 'logps/chosen': -48.1730842590332, 'logits/rejected': -0.4653014540672302, 'logits/chosen': -0.4745505452156067, 'epoch': 0.92}
 92%|█████████▏| 2360/2552 [1:49:15<04:18,  1.34s/it] 93%|█████████▎| 2361/2552 [1:49:17<04:16,  1.34s/it] 93%|█████████▎| 2362/2552 [1:49:18<04:20,  1.37s/it] 93%|█████████▎| 2363/2552 [1:49:19<04:09,  1.32s/it] 93%|█████████▎| 2364/2552 [1:49:21<04:14,  1.35s/it] 93%|█████████▎| 2365/2552 [1:49:22<04:04,  1.31s/it] 93%|█████████▎| 2366/2552 [1:49:23<04:14,  1.37s/it] 93%|█████████▎| 2367/2552 [1:49:25<04:14,  1.38s/it] 93%|█████████▎| 2368/2552 [1:49:26<04:24,  1.44s/it] 93%|█████████▎| 2369/2552 [1:49:28<04:18,  1.41s/it] 93%|█████████▎| 2370/2552 [1:49:29<04:05,  1.35s/it]                                                     {'loss': 0.5927, 'grad_norm': 7.59411096572876, 'learning_rate': 3.5658307210031346e-06, 'rewards/chosen': -0.9002708196640015, 'rewards/rejected': -1.5806968212127686, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.6804261207580566, 'logps/rejected': -34.580501556396484, 'logps/chosen': -29.901519775390625, 'logits/rejected': -0.5613510012626648, 'logits/chosen': -0.5568161010742188, 'epoch': 0.93}
 93%|█████████▎| 2370/2552 [1:49:29<04:05,  1.35s/it] 93%|█████████▎| 2371/2552 [1:49:30<04:00,  1.33s/it] 93%|█████████▎| 2372/2552 [1:49:32<04:07,  1.38s/it] 93%|█████████▎| 2373/2552 [1:49:33<03:55,  1.32s/it] 93%|█████████▎| 2374/2552 [1:49:34<03:54,  1.32s/it] 93%|█████████▎| 2375/2552 [1:49:36<03:58,  1.35s/it] 93%|█████████▎| 2376/2552 [1:49:37<03:49,  1.30s/it] 93%|█████████▎| 2377/2552 [1:49:38<04:00,  1.38s/it] 93%|█████████▎| 2378/2552 [1:49:40<03:48,  1.31s/it] 93%|█████████▎| 2379/2552 [1:49:41<03:42,  1.28s/it] 93%|█████████▎| 2380/2552 [1:49:42<03:39,  1.28s/it]                                                     {'loss': 0.5295, 'grad_norm': 7.940950870513916, 'learning_rate': 3.369905956112853e-06, 'rewards/chosen': -0.6816851496696472, 'rewards/rejected': -0.8736296892166138, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.19194447994232178, 'logps/rejected': -61.42216873168945, 'logps/chosen': -37.82244110107422, 'logits/rejected': -0.5843702554702759, 'logits/chosen': -0.531775951385498, 'epoch': 0.93}
 93%|█████████▎| 2380/2552 [1:49:42<03:39,  1.28s/it] 93%|█████████▎| 2381/2552 [1:49:44<03:52,  1.36s/it] 93%|█████████▎| 2382/2552 [1:49:45<03:59,  1.41s/it] 93%|█████████▎| 2383/2552 [1:49:46<03:52,  1.38s/it] 93%|█████████▎| 2384/2552 [1:49:48<03:46,  1.35s/it] 93%|█████████▎| 2385/2552 [1:49:49<03:35,  1.29s/it] 93%|█████████▎| 2386/2552 [1:49:50<03:34,  1.29s/it] 94%|█████████▎| 2387/2552 [1:49:51<03:35,  1.30s/it] 94%|█████████▎| 2388/2552 [1:49:53<03:40,  1.35s/it] 94%|█████████▎| 2389/2552 [1:49:54<03:35,  1.32s/it] 94%|█████████▎| 2390/2552 [1:49:55<03:31,  1.31s/it]                                                     {'loss': 0.4235, 'grad_norm': 12.550623893737793, 'learning_rate': 3.1739811912225707e-06, 'rewards/chosen': -0.40090125799179077, 'rewards/rejected': -1.5718363523483276, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.1709351539611816, 'logps/rejected': -72.3702621459961, 'logps/chosen': -35.0509147644043, 'logits/rejected': -0.6394985914230347, 'logits/chosen': -0.6003687977790833, 'epoch': 0.94}
 94%|█████████▎| 2390/2552 [1:49:56<03:31,  1.31s/it] 94%|█████████▎| 2391/2552 [1:49:57<03:44,  1.40s/it] 94%|█████████▎| 2392/2552 [1:49:58<03:41,  1.39s/it] 94%|█████████▍| 2393/2552 [1:50:00<03:32,  1.33s/it] 94%|█████████▍| 2394/2552 [1:50:01<03:42,  1.41s/it] 94%|█████████▍| 2395/2552 [1:50:02<03:29,  1.33s/it] 94%|█████████▍| 2396/2552 [1:50:04<03:38,  1.40s/it] 94%|█████████▍| 2397/2552 [1:50:05<03:30,  1.36s/it] 94%|█████████▍| 2398/2552 [1:50:06<03:23,  1.32s/it] 94%|█████████▍| 2399/2552 [1:50:08<03:29,  1.37s/it] 94%|█████████▍| 2400/2552 [1:50:09<03:19,  1.31s/it]                                                     {'loss': 0.6257, 'grad_norm': 5.760645866394043, 'learning_rate': 2.9780564263322885e-06, 'rewards/chosen': -0.713144063949585, 'rewards/rejected': -1.2047779560089111, 'rewards/accuracies': 0.5, 'rewards/margins': 0.49163395166397095, 'logps/rejected': -51.4371223449707, 'logps/chosen': -57.900047302246094, 'logits/rejected': -0.6133655309677124, 'logits/chosen': -0.6112503409385681, 'epoch': 0.94}
 94%|█████████▍| 2400/2552 [1:50:09<03:19,  1.31s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:03,  1.17it/s][A
  4%|▍         | 3/77 [00:02<01:15,  1.02s/it][A
  5%|▌         | 4/77 [00:04<01:20,  1.10s/it][A
  6%|▋         | 5/77 [00:06<01:41,  1.42s/it][A
  8%|▊         | 6/77 [00:07<01:32,  1.30s/it][A
  9%|▉         | 7/77 [00:08<01:31,  1.31s/it][A
 10%|█         | 8/77 [00:10<01:33,  1.36s/it][A
 12%|█▏        | 9/77 [00:11<01:36,  1.43s/it][A
 13%|█▎        | 10/77 [00:12<01:27,  1.31s/it][A
 14%|█▍        | 11/77 [00:13<01:21,  1.24s/it][A
 16%|█▌        | 12/77 [00:15<01:34,  1.45s/it][A
 17%|█▋        | 13/77 [00:16<01:27,  1.37s/it][A
 18%|█▊        | 14/77 [00:18<01:22,  1.31s/it][A
 19%|█▉        | 15/77 [00:19<01:27,  1.41s/it][A
 21%|██        | 16/77 [00:20<01:15,  1.23s/it][A
 22%|██▏       | 17/77 [00:21<01:15,  1.25s/it][A
 23%|██▎       | 18/77 [00:23<01:16,  1.30s/it][A
 25%|██▍       | 19/77 [00:25<01:24,  1.47s/it][A
 26%|██▌       | 20/77 [00:25<01:12,  1.27s/it][A
 27%|██▋       | 21/77 [00:26<01:05,  1.18s/it][A
 29%|██▊       | 22/77 [00:28<01:11,  1.29s/it][A
 30%|██▉       | 23/77 [00:30<01:19,  1.47s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.43s/it][A
 32%|███▏      | 25/77 [00:32<01:12,  1.40s/it][A
 34%|███▍      | 26/77 [00:33<01:05,  1.29s/it][A
 35%|███▌      | 27/77 [00:35<01:06,  1.34s/it][A
 36%|███▋      | 28/77 [00:36<01:02,  1.27s/it][A
 38%|███▊      | 29/77 [00:38<01:08,  1.42s/it][A
 39%|███▉      | 30/77 [00:40<01:11,  1.51s/it][A
 40%|████      | 31/77 [00:41<01:11,  1.55s/it][A
 42%|████▏     | 32/77 [00:43<01:09,  1.54s/it][A
 43%|████▎     | 33/77 [00:44<01:07,  1.53s/it][A
 44%|████▍     | 34/77 [00:46<01:05,  1.53s/it][A
 45%|████▌     | 35/77 [00:47<01:03,  1.52s/it][A
 47%|████▋     | 36/77 [00:49<01:04,  1.57s/it][A
 48%|████▊     | 37/77 [00:50<00:58,  1.46s/it][A
 49%|████▉     | 38/77 [00:51<00:52,  1.35s/it][A
 51%|█████     | 39/77 [00:53<00:57,  1.51s/it][A
 52%|█████▏    | 40/77 [00:55<00:57,  1.55s/it][A
 53%|█████▎    | 41/77 [00:56<00:50,  1.39s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.42s/it][A
 56%|█████▌    | 43/77 [00:59<00:52,  1.54s/it][A
 57%|█████▋    | 44/77 [01:00<00:46,  1.40s/it][A
 58%|█████▊    | 45/77 [01:01<00:40,  1.28s/it][A
 60%|█████▉    | 46/77 [01:02<00:40,  1.30s/it][A
 61%|██████    | 47/77 [01:04<00:37,  1.25s/it][A
 62%|██████▏   | 48/77 [01:05<00:39,  1.37s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.40s/it][A
 65%|██████▍   | 50/77 [01:08<00:38,  1.42s/it][A
 66%|██████▌   | 51/77 [01:10<00:39,  1.52s/it][A
 68%|██████▊   | 52/77 [01:12<00:38,  1.53s/it][A
 69%|██████▉   | 53/77 [01:13<00:39,  1.63s/it][A
 70%|███████   | 54/77 [01:15<00:35,  1.53s/it][A
 71%|███████▏  | 55/77 [01:16<00:31,  1.42s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.68s/it][A
 74%|███████▍  | 57/77 [01:19<00:31,  1.57s/it][A
 75%|███████▌  | 58/77 [01:21<00:30,  1.60s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.59s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.43s/it][A
 79%|███████▉  | 61/77 [01:25<00:23,  1.49s/it][A
 81%|████████  | 62/77 [01:27<00:22,  1.47s/it][A
 82%|████████▏ | 63/77 [01:28<00:21,  1.54s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.42s/it][A
 84%|████████▍ | 65/77 [01:31<00:16,  1.41s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.56s/it][A
 87%|████████▋ | 67/77 [01:34<00:13,  1.30s/it][A
 88%|████████▊ | 68/77 [01:35<00:13,  1.46s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.45s/it][A
 91%|█████████ | 70/77 [01:38<00:09,  1.39s/it][A
 92%|█████████▏| 71/77 [01:39<00:07,  1.31s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.33s/it][A
 95%|█████████▍| 73/77 [01:42<00:05,  1.43s/it][A
 96%|█████████▌| 74/77 [01:44<00:04,  1.60s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.54s/it][A
 99%|█████████▊| 76/77 [01:47<00:01,  1.49s/it][A
100%|██████████| 77/77 [01:49<00:00,  1.53s/it][A                                                     
                                               [A{'eval_loss': 0.48138126730918884, 'eval_runtime': 110.5425, 'eval_samples_per_second': 11.055, 'eval_steps_per_second': 0.697, 'eval_rewards/chosen': -0.6249783635139465, 'eval_rewards/rejected': -1.7612582445144653, 'eval_rewards/accuracies': 0.7792207598686218, 'eval_rewards/margins': 1.1362799406051636, 'eval_logps/rejected': -56.86572265625, 'eval_logps/chosen': -44.75864028930664, 'eval_logits/rejected': -0.5187421441078186, 'eval_logits/chosen': -0.5174585580825806, 'epoch': 0.94}
 94%|█████████▍| 2400/2552 [1:52:00<03:19,  1.31s/it]
100%|██████████| 77/77 [01:49<00:00,  1.53s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 94%|█████████▍| 2401/2552 [1:52:28<1:46:58, 42.51s/it] 94%|█████████▍| 2402/2552 [1:52:29<1:15:19, 30.13s/it] 94%|█████████▍| 2403/2552 [1:52:30<53:17, 21.46s/it]   94%|█████████▍| 2404/2552 [1:52:32<38:12, 15.49s/it] 94%|█████████▍| 2405/2552 [1:52:33<27:30, 11.23s/it] 94%|█████████▍| 2406/2552 [1:52:34<19:57,  8.20s/it] 94%|█████████▍| 2407/2552 [1:52:35<14:45,  6.10s/it] 94%|█████████▍| 2408/2552 [1:52:37<11:11,  4.66s/it] 94%|█████████▍| 2409/2552 [1:52:38<08:47,  3.69s/it] 94%|█████████▍| 2410/2552 [1:52:39<06:57,  2.94s/it]                                                     {'loss': 0.518, 'grad_norm': 4.413004398345947, 'learning_rate': 2.7821316614420063e-06, 'rewards/chosen': -1.1113916635513306, 'rewards/rejected': -1.5756957530975342, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.4643041491508484, 'logps/rejected': -65.95631408691406, 'logps/chosen': -73.41796112060547, 'logits/rejected': -0.690799355506897, 'logits/chosen': -0.7001422643661499, 'epoch': 0.94}
 94%|█████████▍| 2410/2552 [1:52:39<06:57,  2.94s/it] 94%|█████████▍| 2411/2552 [1:52:40<05:42,  2.43s/it] 95%|█████████▍| 2412/2552 [1:52:42<05:00,  2.15s/it] 95%|█████████▍| 2413/2552 [1:52:44<04:33,  1.97s/it] 95%|█████████▍| 2414/2552 [1:52:45<04:13,  1.84s/it] 95%|█████████▍| 2415/2552 [1:52:46<03:45,  1.64s/it] 95%|█████████▍| 2416/2552 [1:52:47<03:26,  1.52s/it] 95%|█████████▍| 2417/2552 [1:52:49<03:20,  1.49s/it] 95%|█████████▍| 2418/2552 [1:52:50<03:04,  1.38s/it] 95%|█████████▍| 2419/2552 [1:52:51<02:53,  1.30s/it] 95%|█████████▍| 2420/2552 [1:52:53<02:57,  1.34s/it]                                                     {'loss': 0.4292, 'grad_norm': 10.534101486206055, 'learning_rate': 2.586206896551724e-06, 'rewards/chosen': -0.4072372317314148, 'rewards/rejected': -1.8619438409805298, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.4547065496444702, 'logps/rejected': -44.93102264404297, 'logps/chosen': -38.680667877197266, 'logits/rejected': -0.6689079999923706, 'logits/chosen': -0.6574819087982178, 'epoch': 0.95}
 95%|█████████▍| 2420/2552 [1:52:53<02:57,  1.34s/it] 95%|█████████▍| 2421/2552 [1:52:54<02:52,  1.31s/it] 95%|█████████▍| 2422/2552 [1:52:55<03:01,  1.40s/it] 95%|█████████▍| 2423/2552 [1:52:57<03:05,  1.44s/it] 95%|█████████▍| 2424/2552 [1:52:59<03:09,  1.48s/it] 95%|█████████▌| 2425/2552 [1:53:00<03:09,  1.49s/it] 95%|█████████▌| 2426/2552 [1:53:01<03:02,  1.44s/it] 95%|█████████▌| 2427/2552 [1:53:03<02:52,  1.38s/it] 95%|█████████▌| 2428/2552 [1:53:04<02:42,  1.31s/it] 95%|█████████▌| 2429/2552 [1:53:05<02:44,  1.34s/it] 95%|█████████▌| 2430/2552 [1:53:06<02:39,  1.31s/it]                                                     {'loss': 0.5419, 'grad_norm': 8.539154052734375, 'learning_rate': 2.390282131661442e-06, 'rewards/chosen': -0.5134462118148804, 'rewards/rejected': -2.255998373031616, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.7425521612167358, 'logps/rejected': -46.041473388671875, 'logps/chosen': -24.83708953857422, 'logits/rejected': -0.68446946144104, 'logits/chosen': -0.6756769418716431, 'epoch': 0.95}
 95%|█████████▌| 2430/2552 [1:53:06<02:39,  1.31s/it] 95%|█████████▌| 2431/2552 [1:53:08<02:54,  1.45s/it] 95%|█████████▌| 2432/2552 [1:53:09<02:47,  1.40s/it] 95%|█████████▌| 2433/2552 [1:53:11<02:41,  1.36s/it] 95%|█████████▌| 2434/2552 [1:53:12<02:34,  1.31s/it] 95%|█████████▌| 2435/2552 [1:53:13<02:36,  1.34s/it] 95%|█████████▌| 2436/2552 [1:53:15<02:40,  1.39s/it] 95%|█████████▌| 2437/2552 [1:53:16<02:31,  1.32s/it] 96%|█████████▌| 2438/2552 [1:53:17<02:29,  1.32s/it] 96%|█████████▌| 2439/2552 [1:53:19<02:33,  1.36s/it] 96%|█████████▌| 2440/2552 [1:53:20<02:26,  1.31s/it]                                                     {'loss': 0.5233, 'grad_norm': 12.090641021728516, 'learning_rate': 2.19435736677116e-06, 'rewards/chosen': -0.5305169224739075, 'rewards/rejected': -1.850046157836914, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.3195291757583618, 'logps/rejected': -58.1038703918457, 'logps/chosen': -44.316749572753906, 'logits/rejected': -0.6517228484153748, 'logits/chosen': -0.625176727771759, 'epoch': 0.96}
 96%|█████████▌| 2440/2552 [1:53:20<02:26,  1.31s/it] 96%|█████████▌| 2441/2552 [1:53:21<02:28,  1.34s/it] 96%|█████████▌| 2442/2552 [1:53:23<02:31,  1.38s/it] 96%|█████████▌| 2443/2552 [1:53:24<02:29,  1.37s/it] 96%|█████████▌| 2444/2552 [1:53:26<02:34,  1.43s/it] 96%|█████████▌| 2445/2552 [1:53:27<02:37,  1.48s/it] 96%|█████████▌| 2446/2552 [1:53:28<02:26,  1.39s/it] 96%|█████████▌| 2447/2552 [1:53:30<02:22,  1.36s/it] 96%|█████████▌| 2448/2552 [1:53:31<02:26,  1.41s/it] 96%|█████████▌| 2449/2552 [1:53:33<02:28,  1.44s/it] 96%|█████████▌| 2450/2552 [1:53:34<02:17,  1.35s/it]                                                     {'loss': 0.5394, 'grad_norm': 9.13179874420166, 'learning_rate': 1.998432601880878e-06, 'rewards/chosen': -0.9971045255661011, 'rewards/rejected': -2.0128743648529053, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 1.0157699584960938, 'logps/rejected': -61.4904670715332, 'logps/chosen': -42.21497344970703, 'logits/rejected': -0.6977038979530334, 'logits/chosen': -0.6722946763038635, 'epoch': 0.96}
 96%|█████████▌| 2450/2552 [1:53:34<02:17,  1.35s/it] 96%|█████████▌| 2451/2552 [1:53:35<02:12,  1.32s/it] 96%|█████████▌| 2452/2552 [1:53:37<02:15,  1.35s/it] 96%|█████████▌| 2453/2552 [1:53:38<02:18,  1.39s/it] 96%|█████████▌| 2454/2552 [1:53:39<02:10,  1.33s/it] 96%|█████████▌| 2455/2552 [1:53:41<02:06,  1.30s/it] 96%|█████████▌| 2456/2552 [1:53:42<02:11,  1.37s/it] 96%|█████████▋| 2457/2552 [1:53:43<02:03,  1.30s/it] 96%|█████████▋| 2458/2552 [1:53:45<02:01,  1.29s/it] 96%|█████████▋| 2459/2552 [1:53:46<02:07,  1.37s/it] 96%|█████████▋| 2460/2552 [1:53:47<02:01,  1.33s/it]                                                     {'loss': 0.6631, 'grad_norm': 9.72490406036377, 'learning_rate': 1.8025078369905957e-06, 'rewards/chosen': -0.9365180730819702, 'rewards/rejected': -1.9155299663543701, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.9790118932723999, 'logps/rejected': -87.17665100097656, 'logps/chosen': -70.08052825927734, 'logits/rejected': -0.6166713833808899, 'logits/chosen': -0.6229710578918457, 'epoch': 0.96}
 96%|█████████▋| 2460/2552 [1:53:47<02:01,  1.33s/it] 96%|█████████▋| 2461/2552 [1:53:49<01:58,  1.30s/it] 96%|█████████▋| 2462/2552 [1:53:50<01:57,  1.31s/it] 97%|█████████▋| 2463/2552 [1:53:51<01:55,  1.30s/it] 97%|█████████▋| 2464/2552 [1:53:52<01:55,  1.31s/it] 97%|█████████▋| 2465/2552 [1:53:54<02:00,  1.39s/it] 97%|█████████▋| 2466/2552 [1:53:56<02:04,  1.45s/it] 97%|█████████▋| 2467/2552 [1:53:57<02:02,  1.44s/it] 97%|█████████▋| 2468/2552 [1:53:58<01:58,  1.41s/it] 97%|█████████▋| 2469/2552 [1:54:00<01:56,  1.41s/it] 97%|█████████▋| 2470/2552 [1:54:01<01:57,  1.43s/it]                                                     {'loss': 0.4334, 'grad_norm': 6.150924205780029, 'learning_rate': 1.6065830721003137e-06, 'rewards/chosen': -1.022505521774292, 'rewards/rejected': -2.24165678024292, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.219151258468628, 'logps/rejected': -58.50404739379883, 'logps/chosen': -37.12981414794922, 'logits/rejected': -0.6950627565383911, 'logits/chosen': -0.6904928684234619, 'epoch': 0.97}
 97%|█████████▋| 2470/2552 [1:54:01<01:57,  1.43s/it] 97%|█████████▋| 2471/2552 [1:54:03<01:59,  1.48s/it] 97%|█████████▋| 2472/2552 [1:54:04<01:51,  1.39s/it] 97%|█████████▋| 2473/2552 [1:54:06<01:54,  1.45s/it] 97%|█████████▋| 2474/2552 [1:54:07<01:45,  1.35s/it] 97%|█████████▋| 2475/2552 [1:54:08<01:43,  1.35s/it] 97%|█████████▋| 2476/2552 [1:54:09<01:40,  1.33s/it] 97%|█████████▋| 2477/2552 [1:54:11<01:40,  1.34s/it] 97%|█████████▋| 2478/2552 [1:54:12<01:42,  1.39s/it] 97%|█████████▋| 2479/2552 [1:54:13<01:37,  1.34s/it] 97%|█████████▋| 2480/2552 [1:54:15<01:33,  1.30s/it]                                                     {'loss': 0.5701, 'grad_norm': 9.964649200439453, 'learning_rate': 1.4106583072100315e-06, 'rewards/chosen': -1.2226612567901611, 'rewards/rejected': -1.1189759969711304, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': -0.10368506610393524, 'logps/rejected': -47.137535095214844, 'logps/chosen': -46.1494026184082, 'logits/rejected': -0.7089000344276428, 'logits/chosen': -0.7196997404098511, 'epoch': 0.97}
 97%|█████████▋| 2480/2552 [1:54:15<01:33,  1.30s/it] 97%|█████████▋| 2481/2552 [1:54:16<01:30,  1.27s/it] 97%|█████████▋| 2482/2552 [1:54:17<01:26,  1.23s/it] 97%|█████████▋| 2483/2552 [1:54:18<01:24,  1.22s/it] 97%|█████████▋| 2484/2552 [1:54:19<01:22,  1.22s/it] 97%|█████████▋| 2485/2552 [1:54:21<01:24,  1.26s/it] 97%|█████████▋| 2486/2552 [1:54:22<01:26,  1.30s/it] 97%|█████████▋| 2487/2552 [1:54:24<01:27,  1.35s/it] 97%|█████████▋| 2488/2552 [1:54:25<01:29,  1.40s/it] 98%|█████████▊| 2489/2552 [1:54:27<01:27,  1.39s/it] 98%|█████████▊| 2490/2552 [1:54:28<01:24,  1.37s/it]                                                     {'loss': 0.5019, 'grad_norm': 14.765115737915039, 'learning_rate': 1.2147335423197491e-06, 'rewards/chosen': -0.5444985032081604, 'rewards/rejected': -2.013303518295288, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.4688050746917725, 'logps/rejected': -65.33384704589844, 'logps/chosen': -54.45507049560547, 'logits/rejected': -0.5747908353805542, 'logits/chosen': -0.5835393667221069, 'epoch': 0.98}
 98%|█████████▊| 2490/2552 [1:54:28<01:24,  1.37s/it] 98%|█████████▊| 2491/2552 [1:54:29<01:21,  1.33s/it] 98%|█████████▊| 2492/2552 [1:54:31<01:21,  1.36s/it] 98%|█████████▊| 2493/2552 [1:54:32<01:16,  1.29s/it] 98%|█████████▊| 2494/2552 [1:54:33<01:14,  1.28s/it] 98%|█████████▊| 2495/2552 [1:54:34<01:13,  1.30s/it] 98%|█████████▊| 2496/2552 [1:54:35<01:10,  1.26s/it] 98%|█████████▊| 2497/2552 [1:54:37<01:15,  1.38s/it] 98%|█████████▊| 2498/2552 [1:54:38<01:13,  1.36s/it] 98%|█████████▊| 2499/2552 [1:54:40<01:12,  1.37s/it] 98%|█████████▊| 2500/2552 [1:54:41<01:12,  1.40s/it]                                                     {'loss': 0.4744, 'grad_norm': 6.184419631958008, 'learning_rate': 1.0188087774294672e-06, 'rewards/chosen': -0.6278035640716553, 'rewards/rejected': -1.832585096359253, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 1.2047815322875977, 'logps/rejected': -53.32224655151367, 'logps/chosen': -39.68146514892578, 'logits/rejected': -0.6353685855865479, 'logits/chosen': -0.6254858374595642, 'epoch': 0.98}
 98%|█████████▊| 2500/2552 [1:54:41<01:12,  1.40s/it]
  0%|          | 0/77 [00:00<?, ?it/s][A
  3%|▎         | 2/77 [00:01<01:03,  1.18it/s][A
  4%|▍         | 3/77 [00:02<01:15,  1.02s/it][A
  5%|▌         | 4/77 [00:04<01:21,  1.11s/it][A
  6%|▋         | 5/77 [00:06<01:41,  1.40s/it][A
  8%|▊         | 6/77 [00:07<01:32,  1.30s/it][A
  9%|▉         | 7/77 [00:08<01:31,  1.31s/it][A
 10%|█         | 8/77 [00:10<01:34,  1.37s/it][A
 12%|█▏        | 9/77 [00:11<01:37,  1.43s/it][A
 13%|█▎        | 10/77 [00:12<01:28,  1.32s/it][A
 14%|█▍        | 11/77 [00:13<01:21,  1.23s/it][A
 16%|█▌        | 12/77 [00:15<01:34,  1.46s/it][A
 17%|█▋        | 13/77 [00:16<01:27,  1.37s/it][A
 18%|█▊        | 14/77 [00:18<01:22,  1.31s/it][A
 19%|█▉        | 15/77 [00:19<01:28,  1.42s/it][A
 21%|██        | 16/77 [00:20<01:16,  1.25s/it][A
 22%|██▏       | 17/77 [00:21<01:15,  1.26s/it][A
 23%|██▎       | 18/77 [00:23<01:17,  1.31s/it][A
 25%|██▍       | 19/77 [00:25<01:24,  1.45s/it][A
 26%|██▌       | 20/77 [00:25<01:11,  1.26s/it][A
 27%|██▋       | 21/77 [00:26<01:05,  1.17s/it][A
 29%|██▊       | 22/77 [00:28<01:10,  1.29s/it][A
 30%|██▉       | 23/77 [00:30<01:19,  1.47s/it][A
 31%|███       | 24/77 [00:31<01:15,  1.43s/it][A
 32%|███▏      | 25/77 [00:32<01:12,  1.40s/it][A
 34%|███▍      | 26/77 [00:34<01:05,  1.28s/it][A
 35%|███▌      | 27/77 [00:35<01:06,  1.33s/it][A
 36%|███▋      | 28/77 [00:36<01:01,  1.26s/it][A
 38%|███▊      | 29/77 [00:38<01:06,  1.39s/it][A
 39%|███▉      | 30/77 [00:40<01:11,  1.51s/it][A
 40%|████      | 31/77 [00:41<01:10,  1.54s/it][A
 42%|████▏     | 32/77 [00:43<01:09,  1.55s/it][A
 43%|████▎     | 33/77 [00:44<01:06,  1.52s/it][A
 44%|████▍     | 34/77 [00:46<01:05,  1.53s/it][A
 45%|████▌     | 35/77 [00:47<01:02,  1.49s/it][A
 47%|████▋     | 36/77 [00:49<01:03,  1.55s/it][A
 48%|████▊     | 37/77 [00:50<00:57,  1.43s/it][A
 49%|████▉     | 38/77 [00:51<00:51,  1.33s/it][A
 51%|█████     | 39/77 [00:53<00:56,  1.50s/it][A
 52%|█████▏    | 40/77 [00:55<00:57,  1.55s/it][A
 53%|█████▎    | 41/77 [00:56<00:50,  1.40s/it][A
 55%|█████▍    | 42/77 [00:57<00:49,  1.42s/it][A
 56%|█████▌    | 43/77 [00:59<00:52,  1.53s/it][A
 57%|█████▋    | 44/77 [01:00<00:46,  1.41s/it][A
 58%|█████▊    | 45/77 [01:01<00:40,  1.28s/it][A
 60%|█████▉    | 46/77 [01:02<00:40,  1.30s/it][A
 61%|██████    | 47/77 [01:04<00:38,  1.27s/it][A
 62%|██████▏   | 48/77 [01:05<00:40,  1.38s/it][A
 64%|██████▎   | 49/77 [01:07<00:39,  1.42s/it][A
 65%|██████▍   | 50/77 [01:08<00:38,  1.43s/it][A
 66%|██████▌   | 51/77 [01:10<00:40,  1.55s/it][A
 68%|██████▊   | 52/77 [01:11<00:38,  1.53s/it][A
 69%|██████▉   | 53/77 [01:13<00:39,  1.64s/it][A
 70%|███████   | 54/77 [01:15<00:35,  1.53s/it][A
 71%|███████▏  | 55/77 [01:16<00:31,  1.43s/it][A
 73%|███████▎  | 56/77 [01:18<00:35,  1.68s/it][A
 74%|███████▍  | 57/77 [01:19<00:31,  1.57s/it][A
 75%|███████▌  | 58/77 [01:21<00:30,  1.59s/it][A
 77%|███████▋  | 59/77 [01:23<00:28,  1.58s/it][A
 78%|███████▊  | 60/77 [01:24<00:24,  1.42s/it][A
 79%|███████▉  | 61/77 [01:25<00:23,  1.50s/it][A
 81%|████████  | 62/77 [01:27<00:21,  1.46s/it][A
 82%|████████▏ | 63/77 [01:28<00:21,  1.54s/it][A
 83%|████████▎ | 64/77 [01:30<00:18,  1.42s/it][A
 84%|████████▍ | 65/77 [01:31<00:17,  1.42s/it][A
 86%|████████▌ | 66/77 [01:33<00:17,  1.56s/it][A
 87%|████████▋ | 67/77 [01:34<00:12,  1.29s/it][A
 88%|████████▊ | 68/77 [01:35<00:13,  1.47s/it][A
 90%|████████▉ | 69/77 [01:37<00:11,  1.44s/it][A
 91%|█████████ | 70/77 [01:38<00:09,  1.38s/it][A
 92%|█████████▏| 71/77 [01:39<00:07,  1.31s/it][A
 94%|█████████▎| 72/77 [01:41<00:06,  1.32s/it][A
 95%|█████████▍| 73/77 [01:42<00:05,  1.42s/it][A
 96%|█████████▌| 74/77 [01:44<00:04,  1.59s/it][A
 97%|█████████▋| 75/77 [01:46<00:03,  1.53s/it][A
 99%|█████████▊| 76/77 [01:47<00:01,  1.48s/it][A
100%|██████████| 77/77 [01:49<00:00,  1.54s/it][A                                                     
                                               [A{'eval_loss': 0.482078492641449, 'eval_runtime': 110.4408, 'eval_samples_per_second': 11.065, 'eval_steps_per_second': 0.697, 'eval_rewards/chosen': -0.6243205666542053, 'eval_rewards/rejected': -1.7526946067810059, 'eval_rewards/accuracies': 0.7857142686843872, 'eval_rewards/margins': 1.1283742189407349, 'eval_logps/rejected': -56.78009033203125, 'eval_logps/chosen': -44.75205993652344, 'eval_logits/rejected': -0.518622100353241, 'eval_logits/chosen': -0.5174095034599304, 'epoch': 0.98}
 98%|█████████▊| 2500/2552 [1:56:32<01:12,  1.40s/it]
100%|██████████| 77/77 [01:49<00:00,  1.54s/it][A
                                               [A/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
 98%|█████████▊| 2501/2552 [1:57:00<36:08, 42.51s/it] 98%|█████████▊| 2502/2552 [1:57:01<25:06, 30.12s/it] 98%|█████████▊| 2503/2552 [1:57:02<17:34, 21.52s/it] 98%|█████████▊| 2504/2552 [1:57:04<12:20, 15.43s/it] 98%|█████████▊| 2505/2552 [1:57:05<08:44, 11.16s/it] 98%|█████████▊| 2506/2552 [1:57:06<06:16,  8.18s/it] 98%|█████████▊| 2507/2552 [1:57:08<04:39,  6.20s/it] 98%|█████████▊| 2508/2552 [1:57:09<03:26,  4.69s/it] 98%|█████████▊| 2509/2552 [1:57:10<02:36,  3.65s/it] 98%|█████████▊| 2510/2552 [1:57:11<02:03,  2.94s/it]                                                     {'loss': 0.5407, 'grad_norm': 10.809975624084473, 'learning_rate': 8.22884012539185e-07, 'rewards/chosen': -0.48297983407974243, 'rewards/rejected': -1.9853423833847046, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 1.5023624897003174, 'logps/rejected': -84.8636703491211, 'logps/chosen': -46.062862396240234, 'logits/rejected': -0.5898299813270569, 'logits/chosen': -0.5476792454719543, 'epoch': 0.98}
 98%|█████████▊| 2510/2552 [1:57:11<02:03,  2.94s/it] 98%|█████████▊| 2511/2552 [1:57:13<01:41,  2.47s/it] 98%|█████████▊| 2512/2552 [1:57:14<01:28,  2.20s/it] 98%|█████████▊| 2513/2552 [1:57:15<01:13,  1.89s/it] 99%|█████████▊| 2514/2552 [1:57:16<01:02,  1.66s/it] 99%|█████████▊| 2515/2552 [1:57:18<01:00,  1.63s/it] 99%|█████████▊| 2516/2552 [1:57:19<00:55,  1.55s/it] 99%|█████████▊| 2517/2552 [1:57:21<00:54,  1.55s/it] 99%|█████████▊| 2518/2552 [1:57:22<00:50,  1.47s/it] 99%|█████████▊| 2519/2552 [1:57:24<00:47,  1.45s/it] 99%|█████████▊| 2520/2552 [1:57:25<00:44,  1.38s/it]                                                     {'loss': 0.6118, 'grad_norm': 11.07568359375, 'learning_rate': 6.269592476489028e-07, 'rewards/chosen': -0.7432078123092651, 'rewards/rejected': -1.6875417232513428, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.9443340301513672, 'logps/rejected': -75.19792175292969, 'logps/chosen': -69.77262115478516, 'logits/rejected': -0.7506150007247925, 'logits/chosen': -0.7688112258911133, 'epoch': 0.99}
 99%|█████████▊| 2520/2552 [1:57:25<00:44,  1.38s/it] 99%|█████████▉| 2521/2552 [1:57:26<00:41,  1.35s/it] 99%|█████████▉| 2522/2552 [1:57:27<00:38,  1.28s/it] 99%|█████████▉| 2523/2552 [1:57:28<00:36,  1.27s/it] 99%|█████████▉| 2524/2552 [1:57:30<00:37,  1.34s/it] 99%|█████████▉| 2525/2552 [1:57:32<00:38,  1.43s/it] 99%|█████████▉| 2526/2552 [1:57:33<00:38,  1.47s/it] 99%|█████████▉| 2527/2552 [1:57:34<00:34,  1.38s/it] 99%|█████████▉| 2528/2552 [1:57:36<00:33,  1.38s/it] 99%|█████████▉| 2529/2552 [1:57:37<00:32,  1.43s/it] 99%|█████████▉| 2530/2552 [1:57:38<00:29,  1.35s/it]                                                     {'loss': 0.4826, 'grad_norm': 9.048046112060547, 'learning_rate': 4.3103448275862073e-07, 'rewards/chosen': -0.10579876601696014, 'rewards/rejected': -2.2709717750549316, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 2.165173292160034, 'logps/rejected': -59.66432571411133, 'logps/chosen': -41.369789123535156, 'logits/rejected': -0.5669642686843872, 'logits/chosen': -0.5541180968284607, 'epoch': 0.99}
 99%|█████████▉| 2530/2552 [1:57:39<00:29,  1.35s/it] 99%|█████████▉| 2531/2552 [1:57:40<00:27,  1.32s/it] 99%|█████████▉| 2532/2552 [1:57:41<00:27,  1.40s/it] 99%|█████████▉| 2533/2552 [1:57:43<00:25,  1.37s/it] 99%|█████████▉| 2534/2552 [1:57:44<00:23,  1.30s/it] 99%|█████████▉| 2535/2552 [1:57:45<00:21,  1.26s/it] 99%|█████████▉| 2536/2552 [1:57:46<00:19,  1.25s/it] 99%|█████████▉| 2537/2552 [1:57:47<00:18,  1.24s/it] 99%|█████████▉| 2538/2552 [1:57:49<00:17,  1.27s/it] 99%|█████████▉| 2539/2552 [1:57:50<00:16,  1.23s/it]100%|█████████▉| 2540/2552 [1:57:51<00:14,  1.24s/it]                                                     {'loss': 0.4174, 'grad_norm': 7.791567325592041, 'learning_rate': 2.3510971786833858e-07, 'rewards/chosen': -0.36274152994155884, 'rewards/rejected': -1.447925090789795, 'rewards/accuracies': 0.8999999761581421, 'rewards/margins': 1.0851835012435913, 'logps/rejected': -39.58892822265625, 'logps/chosen': -39.48640823364258, 'logits/rejected': -0.6420382857322693, 'logits/chosen': -0.6558608412742615, 'epoch': 1.0}
100%|█████████▉| 2540/2552 [1:57:51<00:14,  1.24s/it]100%|█████████▉| 2541/2552 [1:57:53<00:14,  1.34s/it]100%|█████████▉| 2542/2552 [1:57:54<00:13,  1.33s/it]100%|█████████▉| 2543/2552 [1:57:55<00:11,  1.29s/it]100%|█████████▉| 2544/2552 [1:57:57<00:10,  1.35s/it]100%|█████████▉| 2545/2552 [1:57:58<00:09,  1.29s/it]100%|█████████▉| 2546/2552 [1:57:59<00:07,  1.24s/it]100%|█████████▉| 2547/2552 [1:58:00<00:06,  1.21s/it]100%|█████████▉| 2548/2552 [1:58:01<00:04,  1.20s/it]100%|█████████▉| 2549/2552 [1:58:03<00:03,  1.29s/it]100%|█████████▉| 2550/2552 [1:58:04<00:02,  1.29s/it]                                                     {'loss': 0.5259, 'grad_norm': 11.74380874633789, 'learning_rate': 3.9184952978056425e-08, 'rewards/chosen': -0.8247340321540833, 'rewards/rejected': -1.6331040859222412, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.8083702325820923, 'logps/rejected': -48.66252136230469, 'logps/chosen': -58.84619140625, 'logits/rejected': -0.7329729795455933, 'logits/chosen': -0.7237005233764648, 'epoch': 1.0}
100%|█████████▉| 2550/2552 [1:58:04<00:02,  1.29s/it]100%|█████████▉| 2551/2552 [1:58:05<00:01,  1.32s/it]100%|██████████| 2552/2552 [1:58:07<00:00,  1.34s/it]                                                     {'train_runtime': 7087.3477, 'train_samples_per_second': 2.88, 'train_steps_per_second': 0.36, 'train_loss': 0.5404161191005318, 'epoch': 1.0}
100%|██████████| 2552/2552 [1:58:07<00:00,  1.34s/it]100%|██████████| 2552/2552 [1:58:07<00:00,  2.78s/it]
/home/lixz23/miniconda3/envs/ragsft/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /home/lixz23/pretrain-model/Llama3-8b-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
[2024-10-20 16:46:55,342] [INFO] [launch.py:351:main] Process 2050902 exits successfully.
[2024-10-20 16:46:55,344] [INFO] [launch.py:351:main] Process 2050903 exits successfully.
[2024-10-20 16:46:55,344] [INFO] [launch.py:351:main] Process 2050901 exits successfully.
[2024-10-20 16:46:55,344] [INFO] [launch.py:351:main] Process 2050908 exits successfully.
[2024-10-20 16:46:55,344] [INFO] [launch.py:351:main] Process 2050904 exits successfully.
[2024-10-20 16:46:56,345] [INFO] [launch.py:351:main] Process 2050906 exits successfully.
[2024-10-20 16:46:56,346] [INFO] [launch.py:351:main] Process 2050907 exits successfully.
[2024-10-20 16:46:56,346] [INFO] [launch.py:351:main] Process 2050905 exits successfully.
